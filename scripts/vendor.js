if(function(n,t){(function(i){typeof define=="function"&&define.amd?define(["jquery"],i):n.sammy=t.Sammy=i(n)})(function(n){var i,w="([^/]+)",h=/:([\w\d]+)/g,l=/\?([^#]*)?$/,u=function(n){return Array.prototype.slice.call(n)},r=function(n){return Object.prototype.toString.call(n)==="[object Function]"},f=function(n){return Object.prototype.toString.call(n)==="[object Array]"},a=function(n){return Object.prototype.toString.call(n)==="[object RegExp]"},o=function(n){return decodeURIComponent((n||"").replace(/\+/g," "))},v=encodeURIComponent,y=function(n){return String(n).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},e=function(n){return function(){return this.route.apply(this,[n].concat(Array.prototype.slice.call(arguments)))}},c={},s=!!t.history&&!!history.pushState,p=[];return i=function(){var t=u(arguments),f,e;return(i.apps=i.apps||{},t.length===0||t[0]&&r(t[0]))?i.apply(i,["body"].concat(t)):typeof(e=t.shift())=="string"?(f=i.apps[e]||new i.Application,f.element_selector=e,t.length>0&&n.each(t,function(n,t){f.use(t)}),f.element_selector!=e&&delete i.apps[e],i.apps[f.element_selector]=f,f):void 0},i.VERSION="0.7.4",i.addLogger=function(n){p.push(n)},i.log=function(){var t=u(arguments);t.unshift("["+Date()+"]"),n.each(p,function(n,r){r.apply(i,t)})},typeof t.console!="undefined"?r(t.console.log.apply)?i.addLogger(function(){t.console.log.apply(t.console,arguments)}):i.addLogger(function(){t.console.log(arguments)}):typeof console!="undefined"&&i.addLogger(function(){console.log.apply(console,arguments)}),n.extend(i,{makeArray:u,isFunction:r,isArray:f}),i.Object=function(t){return n.extend(this,t||{})},n.extend(i.Object.prototype,{escapeHTML:y,h:y,toHash:function(){var t={};return n.each(this,function(n,i){r(i)||(t[n]=i)}),t},toHTML:function(){var t="";return n.each(this,function(n,i){r(i)||(t+="<strong>"+n+"<\/strong> "+i+"<br />")}),t},keys:function(n){var i=[],t;for(t in this)r(this[t])&&n||i.push(t);return i},has:function(t){return this[t]&&n.trim(this[t].toString())!==""},join:function(){var n=u(arguments),t=n.shift();return n.join(t)},log:function(){i.log.apply(i,arguments)},toString:function(t){var i=[];return n.each(this,function(n,u){(!r(u)||t)&&i.push('"'+n+'": '+u.toString())}),"Sammy.Object: {"+i.join(",")+"}"}}),i.targetIsThisWindow=function(i){var r=n(i.target).attr("target");return!r||r===t.name||r==="_self"?!0:r==="_blank"?!1:r==="top"&&t===t.top?!0:!1},i.DefaultLocationProxy=function(n,t){this.app=n,this.is_native=!1,this.has_history=s,this._startPolling(t)},i.DefaultLocationProxy.fullPath=function(n){var t=n.toString().match(/^[^#]*(#.+)$/),i=t?t[1]:"";return[n.pathname,n.search,i].join("")},n.extend(i.DefaultLocationProxy.prototype,{bind:function(){var f=this,u=this.app,r=i.DefaultLocationProxy;n(t).bind("hashchange."+this.app.eventNamespace(),function(n,i){f.is_native!==!1||i||(f.is_native=!0,t.clearInterval(r._interval),r._interval=null),u.trigger("location-changed")}),s&&!u.disable_push_state&&(n(t).bind("popstate."+this.app.eventNamespace(),function(){u.trigger("location-changed")}),n(document).delegate("a","click.history-"+this.app.eventNamespace(),function(n){if(!n.isDefaultPrevented()&&!n.metaKey&&!n.ctrlKey){var e=r.fullPath(this);if(this.hostname==t.location.hostname&&u.lookupRoute("get",e)&&i.targetIsThisWindow(n))return n.preventDefault(),f.setLocation(e),!1}})),r._bindings||(r._bindings=0),r._bindings++},unbind:function(){n(t).unbind("hashchange."+this.app.eventNamespace()),n(t).unbind("popstate."+this.app.eventNamespace()),n(document).undelegate("a","click.history-"+this.app.eventNamespace()),i.DefaultLocationProxy._bindings--,i.DefaultLocationProxy._bindings<=0&&(t.clearInterval(i.DefaultLocationProxy._interval),i.DefaultLocationProxy._interval=null)},getLocation:function(){return i.DefaultLocationProxy.fullPath(t.location)},setLocation:function(n){if(/^([^#\/]|$)/.test(n)&&(n=s&&!this.app.disable_push_state?"/"+n:"#!/"+n),n!=this.getLocation()){if(!(s&&!this.app.disable_push_state&&/^\//.test(n)))return t.location=n;history.pushState({path:n},t.title,n),this.app.trigger("location-changed")}},_startPolling:function(r){var f=this,u;i.DefaultLocationProxy._interval||(r||(r=10),u=function(){var r=f.getLocation();(typeof i.DefaultLocationProxy._last_location=="undefined"||r!=i.DefaultLocationProxy._last_location)&&t.setTimeout(function(){n(t).trigger("hashchange",[!0])},0),i.DefaultLocationProxy._last_location=r},u(),i.DefaultLocationProxy._interval=t.setInterval(u,r))}}),i.Application=function(n){var t=this;this.routes={},this.listeners=new i.Object({}),this.arounds=[],this.befores=[],this.namespace=+new Date+"-"+parseInt(Math.random()*1e3,10),this.context_prototype=function(){i.EventContext.apply(this,arguments)},this.context_prototype.prototype=new i.EventContext,r(n)&&n.apply(this,[this]),this._location_proxy||this.setLocationProxy(new i.DefaultLocationProxy(this,this.run_interval_every)),this.debug&&this.bindToAllEvents(function(n,i){t.log(t.toString(),n.cleaned_type,i||{})})},i.Application.prototype=n.extend({},i.Object.prototype,{ROUTE_VERBS:["get","post","put","delete"],APP_EVENTS:["run","unload","lookup-route","run-route","route-found","event-context-before","event-context-after","changed","error","check-form-submission","redirect","location-changed"],_last_route:null,_location_proxy:null,_running:!1,element_selector:"body",debug:!1,raise_errors:!1,run_interval_every:50,disable_push_state:!1,template_engine:null,toString:function(){return"Sammy.Application:"+this.element_selector},$element:function(t){return t?n(this.element_selector).find(t):n(this.element_selector)},use:function(){var t=u(arguments),n=t.shift(),f=n||"";try{t.unshift(this),typeof n=="string"&&(f="Sammy."+n,n=i[n]),n.apply(this,t)}catch(e){typeof n=="undefined"?this.error("Plugin Error: called use() but plugin ("+f.toString()+") is not defined",e):r(n)?this.error("Plugin Error",e):this.error("Plugin Error: called use() but '"+f.toString()+"' is not a function",e)}return this},setLocationProxy:function(n){var t=this._location_proxy;this._location_proxy=n,this.isRunning()&&(t&&t.unbind(),this._location_proxy.bind())},log:function(){i.log.apply(i,Array.prototype.concat.apply([this.element_selector],arguments))},route:function(t,i){var f=this,o=[],e,s,u=Array.prototype.slice.call(arguments,2);if(u.length===0&&r(i)&&(i=t,u=[i],t="any"),t=t.toLowerCase(),i.constructor==String){for(h.lastIndex=0;(s=h.exec(i))!==null;)o.push(s[1]);i=new RegExp(i.replace(h,w)+"$")}return n.each(u,function(n,t){typeof t=="string"&&(u[n]=f[t])}),e=function(n){var t={verb:n,path:i,callback:u,param_names:o};f.routes[n]=f.routes[n]||[],f.routes[n].push(t)},t==="any"?n.each(this.ROUTE_VERBS,function(n,t){e(t)}):e(t),this},get:e("get"),post:e("post"),put:e("put"),del:e("delete"),any:e("any"),mapRoutes:function(t){var i=this;return n.each(t,function(n,t){i.route.apply(i,t)}),this},eventNamespace:function(){return["sammy-app",this.namespace].join("-")},bind:function(n,t,i){var r=this,u;return typeof i=="undefined"&&(i=t),u=function(){var t,u,n;t=arguments[0],n=arguments[1],n&&n.context?(u=n.context,delete n.context):u=new r.context_prototype(r,"bind",t.type,n,t.target),t.cleaned_type=t.type.replace(r.eventNamespace(),""),i.apply(u,[t,n])},this.listeners[n]||(this.listeners[n]=[]),this.listeners[n].push(u),this.isRunning()&&this._listen(n,u),this},trigger:function(n,t){return this.$element().trigger([n,this.eventNamespace()].join("."),[t]),this},refresh:function(){return this.last_location=null,this.trigger("location-changed"),this},before:function(n,t){return r(n)&&(t=n,n={}),this.befores.push([n,t]),this},after:function(n){return this.bind("event-context-after",n)},around:function(n){return this.arounds.push(n),this},onComplete:function(n){return this._onComplete=n,this},isRunning:function(){return this._running},helpers:function(t){return n.extend(this.context_prototype.prototype,t),this},helper:function(n,t){return this.context_prototype.prototype[n]=t,this},run:function(r){if(this.isRunning())return!1;var u=this;return n.each(this.listeners.toHash(),function(t,i){n.each(i,function(n,i){u._listen(t,i)})}),this.trigger("run",{start_url:r}),this._running=!0,this.last_location=null,!/\#(.+)/.test(this.getLocation())&&typeof r!="undefined"&&this.setLocation(r),this._checkLocation(),this._location_proxy.bind(),this.bind("location-changed",function(){u._checkLocation()}),this.bind("submit",function(t){if(!i.targetIsThisWindow(t))return!0;var r=u._checkFormSubmission(n(t.target).closest("form"));return r===!1?t.preventDefault():!1}),n(t).bind("unload",function(){u.unload()}),this.trigger("changed")},unload:function(){if(!this.isRunning())return!1;var t=this;return this.trigger("unload"),this._location_proxy.unbind(),this.$element().unbind("submit").removeClass(t.eventNamespace()),n.each(this.listeners.toHash(),function(i,r){n.each(r,function(n,r){t._unlisten(i,r)})}),this._running=!1,this},destroy:function(){return this.unload(),delete i.apps[this.element_selector],this},bindToAllEvents:function(t){var i=this;return n.each(this.APP_EVENTS,function(n,r){i.bind(r,t)}),n.each(this.listeners.keys(!0),function(r,u){n.inArray(u,i.APP_EVENTS)==-1&&i.bind(u,t)}),this},routablePath:function(n){return n.replace(l,"")},lookupRoute:function(n,t){var e=this,u=!1,i=0,f,r;if(typeof this.routes[n]!="undefined")for(f=this.routes[n].length;i<f;i++)if(r=this.routes[n][i],e.routablePath(t).match(r.path)){u=r;break}return u},runRoute:function(t,i,r,u){var s=this,f=this.lookupRoute(t,i),e,c,y,w,l,a,h,v,p;if(this.debug&&this.log("runRoute",[t,i].join(" ")),this.trigger("run-route",{verb:t,path:i,params:r}),typeof r=="undefined"&&(r={}),n.extend(r,this._parseQueryString(i)),f){this.trigger("route-found",{route:f}),(v=f.path.exec(this.routablePath(i)))!==null&&(v.shift(),n.each(v,function(n,t){f.param_names[n]?r[f.param_names[n]]=o(t):(r.splat||(r.splat=[]),r.splat.push(o(t)))})),e=new this.context_prototype(this,t,i,r,u),y=this.arounds.slice(0),l=this.befores.slice(0),h=[e],r.splat&&(h=h.concat(r.splat)),c=function(){for(var n,t,i;l.length>0;)if(a=l.shift(),s.contextMatchesOptions(e,a[0])&&(n=a[1].apply(e,[e]),n===!1))return!1;return s.last_route=f,e.trigger("event-context-before",{context:e}),typeof f.callback=="function"&&(f.callback=[f.callback]),f.callback&&f.callback.length&&(t=-1,i=function(){t++,f.callback[t]?n=f.callback[t].apply(e,h):s._onComplete&&typeof(s._onComplete==="function")&&s._onComplete(e)},h.push(i),i()),e.trigger("event-context-after",{context:e}),n},n.each(y.reverse(),function(n,t){var i=c;c=function(){return t.apply(e,[i])}});try{p=c()}catch(b){this.error(["500 Error",t,i].join(" "),b)}return p}return this.notFound(t,i)},contextMatchesOptions:function(t,i,r){var u=i,h,o,l,v,c,s,e;if((typeof u=="string"||a(u))&&(u={path:u}),typeof r=="undefined"&&(r=!0),n.isEmptyObject(u))return!0;if(f(u.path)){for(h=[],o=0,v=u.path.length;o<v;o+=1)l=n.extend({},u,{path:u.path[o]}),h.push(this.contextMatchesOptions(t,l));return c=n.inArray(!0,h)>-1?!0:!1,r?c:!c}return u.only?this.contextMatchesOptions(t,u.only,!0):u.except?this.contextMatchesOptions(t,u.except,!1):(s=!0,e=!0,u.path&&(a(u.path)||(u.path=new RegExp(u.path.toString()+"$")),s=u.path.test(t.path)),u.verb&&(e=typeof u.verb=="string"?u.verb===t.verb:u.verb.indexOf(t.verb)>-1),r?e&&s:!e||!s)},getLocation:function(){return this._location_proxy.getLocation()},setLocation:function(n){return this._location_proxy.setLocation(n)},swap:function(n,t){var i=this.$element().html(n);return r(t)&&t(n),i},templateCache:function(n,t){return typeof t!="undefined"?c[n]=t:c[n]},clearTemplateCache:function(){return c={}},notFound:function(n,t){var i=this.error(["404 Not Found",n,t].join(" "));return n==="get"?i:!0},error:function(n,t){if(t||(t=new Error),t.message=[n,t.message].join(" "),this.trigger("error",{message:t.message,error:t}),this.raise_errors)throw t;this.log(t.message,t)},_checkLocation:function(){var n,t;return n=this.getLocation(),this.last_location&&this.last_location[0]=="get"&&this.last_location[1]==n||(this.last_location=["get",n],t=this.runRoute("get",n)),t},_getFormVerb:function(t){var u=n(t),i,r;return r=u.find('input[name="_method"]'),r.length>0&&(i=r.val()),i||(i=u[0].getAttribute("method")),i&&i!==""||(i="get"),n.trim(i.toString().toLowerCase())},_checkFormSubmission:function(t){var i,r,f,u,e;return this.trigger("check-form-submission",{form:t}),i=n(t),r=i.attr("action")||"",f=this._getFormVerb(i),this.debug&&this.log("_checkFormSubmission",i,r,f),f==="get"?(u=this._serializeFormParams(i),u!==""&&(r+="?"+u),this.setLocation(r),e=!1):(u=n.extend({},this._parseFormParams(i)),e=this.runRoute(f,r,u,t.get(0))),typeof e=="undefined"?!1:e},_serializeFormParams:function(n){var r="",t=n.serializeArray(),i;if(t.length>0)for(r=this._encodeFormPair(t[0].name,t[0].value),i=1;i<t.length;i++)r=r+"&"+this._encodeFormPair(t[i].name,t[i].value);return r},_encodeFormPair:function(n,t){return v(n)+"="+v(t)},_parseFormParams:function(n){for(var i={},r=n.serializeArray(),t=0;t<r.length;t++)i=this._parseParamPair(i,r[t].name,r[t].value);return i},_parseQueryString:function(n){var r={},t,u,f,i;if(t=n.match(l),t&&t[1])for(u=t[1].split("&"),i=0;i<u.length;i++)f=u[i].split("="),r=this._parseParamPair(r,o(f[0]),o(f[1]||""));return r},_parseParamPair:function(n,t,i){return typeof n[t]!="undefined"?f(n[t])?n[t].push(i):n[t]=[n[t],i]:n[t]=i,n},_listen:function(n,t){return this.$element().bind([n,this.eventNamespace()].join("."),t)},_unlisten:function(n,t){return this.$element().unbind([n,this.eventNamespace()].join("."),t)}}),i.RenderContext=function(n){this.event_context=n,this.callbacks=[],this.previous_content=null,this.content=null,this.next_engine=!1,this.waiting=!1},i.RenderContext.prototype=n.extend({},i.Object.prototype,{then:function(n){var u,i;if(!r(n)){if(!(typeof n=="string"&&n in this.event_context))return this;u=this.event_context[n],n=function(n){return u.apply(this.event_context,[n])}}return i=this,this.waiting?this.callbacks.push(n):(this.wait(),t.setTimeout(function(){var t=n.apply(i,[i.content,i.previous_content]);t!==!1&&i.next(t)},0)),this},wait:function(){this.waiting=!0},next:function(n){this.waiting=!1,typeof n!="undefined"&&(this.previous_content=this.content,this.content=n),this.callbacks.length>0&&this.then(this.callbacks.shift())},load:function(t,i,u){var f=this;return this.then(function(){var e,s,o,h;return(r(i)?(u=i,i={}):i=n.extend({},i),u&&this.then(u),typeof t=="string")?(o=t.match(/\.json$/)||i.json,e=o?i.cache===!0:i.cache!==!1,f.next_engine=f.event_context.engineFor(t),delete i.cache,delete i.json,i.engine&&(f.next_engine=i.engine,delete i.engine),e&&(s=this.event_context.app.templateCache(t))?s:(this.wait(),n.ajax(n.extend({url:t,data:{},dataType:o?"json":"text",type:"get",success:function(n){e&&f.event_context.app.templateCache(t,n),f.next(n)}},i)),!1)):t.nodeType?t.innerHTML:t.selector?(f.next_engine=t.attr("data-engine"),i.clone===!1?t.remove()[0].innerHTML.toString():t[0].innerHTML.toString()):void 0})},loadPartials:function(n){var t;if(n){this.partials=this.partials||{};for(t in n)(function(t,i){t.load(n[i]).then(function(n){this.partials[i]=n})})(this,t)}return this},render:function(n,t,i,u){return r(n)&&!t?this.then(n):(r(t)?(u=i,i=t,t=null):i&&!r(i)&&(u=i,i=null),this.loadPartials(u).load(n).interpolate(t,n).then(i))},partial:function(n,t,i,u){return r(i)?this.render(n,t,u).swap(i):r(t)?this.render(n,{},i).swap(t):this.render(n,t,i).swap()},send:function(){var t=this,n=u(arguments),i=n.shift();return f(n[0])&&(n=n[0]),this.then(function(){return n.push(function(n){t.next(n)}),t.wait(),i.apply(i,n),!1})},collect:function(t,i,u){var e=this,f=function(){r(t)&&(i=t,t=this.content);var u=[],f=!1;return n.each(t,function(n,t){var r=i.apply(e,[n,t]);return r.jquery&&r.length==1&&(r=r[0],f=!0),u.push(r),r}),f?u:u.join("")};return u?f():this.then(f)},renderEach:function(t,i,r,u){return f(i)&&(u=r,r=i,i=null),this.load(t).then(function(e){var o=this;if(r||(r=f(this.previous_content)?this.previous_content:[]),!u)return this.collect(r,function(n,r){var u={},f=this.next_engine||t;return i?u[i]=r:u=r,this.event_context.interpolate(e,u,f)},!0);n.each(r,function(n,r){var f={},s=this.next_engine||t;i?f[i]=r:f=r,u(r,o.event_context.interpolate(e,f,s))})})},interpolate:function(n,t,i){var r=this;return this.then(function(u,f){!n&&f&&(n=f),this.next_engine&&(t=this.next_engine,this.next_engine=!1);var e=r.event_context.interpolate(u,n,t,this.partials);return i?f+e:e})},swap:function(n){return this.then(function(t){return this.event_context.swap(t,n),t}).trigger("changed",{})},appendTo:function(t){return this.then(function(i){n(t).append(i)}).trigger("changed",{})},prependTo:function(t){return this.then(function(i){n(t).prepend(i)}).trigger("changed",{})},replace:function(t){return this.then(function(i){n(t).html(i)}).trigger("changed",{})},trigger:function(n,t){return this.then(function(i){return typeof t=="undefined"&&(t={content:i}),this.event_context.trigger(n,t),i})}}),i.EventContext=function(n,t,r,u,f){this.app=n,this.verb=t,this.path=r,this.params=new i.Object(u),this.target=f},i.EventContext.prototype=n.extend({},i.Object.prototype,{$element:function(){return this.app.$element(u(arguments).shift())},engineFor:function(n){var t=this,i;return r(n)?n:(n=(n||t.app.template_engine).toString(),(i=n.match(/\.([^\.\?\#]+)$/))&&(n=i[1]),n&&r(t[n])?t[n]:t.app.template_engine?this.engineFor(t.app.template_engine):function(n){return n})},interpolate:function(n,t,i,r){return this.engineFor(i).apply(this,[n,t,r])},render:function(n,t,r,u){return new i.RenderContext(this).render(n,t,r,u)},renderEach:function(n,t,r,u){return new i.RenderContext(this).renderEach(n,t,r,u)},load:function(n,t,r){return new i.RenderContext(this).load(n,t,r)},loadPartials:function(n){return new i.RenderContext(this).loadPartials(n)},partial:function(n,t,r,u){return new i.RenderContext(this).partial(n,t,r,u)},send:function(){var n=new i.RenderContext(this);return n.send.apply(n,arguments)},redirect:function(){var t,i=u(arguments),l=this.app.getLocation(),o=i.length,e;if(o>1){for(var r=0,s=[],h=[],f={},c=!1;r<o;r++)typeof i[r]=="string"?s.push(i[r]):(n.extend(f,i[r]),c=!0);if(t=s.join("/"),c){for(e in f)h.push(this.app._encodeFormPair(e,f[e]));t+="?"+h.join("&")}}else t=i[0];this.trigger("redirect",{to:t}),this.app.last_location=[this.verb,this.path],this.app.setLocation(t),new RegExp(t).test(l)&&this.app.trigger("location-changed")},trigger:function(n,t){return typeof t=="undefined"&&(t={}),t.context||(t.context=this),this.app.trigger(n,t)},eventNamespace:function(){return this.app.eventNamespace()},swap:function(n,t){return this.app.swap(n,t)},notFound:function(){return this.app.notFound(this.verb,this.path)},json:function(t){return n.parseJSON(t)},toString:function(){return"Sammy.EventContext: "+[this.verb,this.path,this.params].join(" ")}}),i})}(jQuery,window),function(){var n=!0;(function(t,i,r,u,f){!function(n){if(typeof require=="function"&&typeof exports=="object"&&typeof module=="object"){var i=module.exports||exports;n(i)}else typeof define=="function"&&define.amd?define(["exports"],n):n(t.ko={})}(function(e){function k(n){var t=this,i,r;if(n)for(i in n)r=o.extenders[i],typeof r=="function"&&(t=r(t,n[i]));return t}function d(n){o.bindingHandlers[n]={init:function(t,i,r,u){var f=function(){var t={};return t[n]=i(),t};return o.bindingHandlers.event.init.call(this,t,f,r,u)}}}function p(n,t,i,r){o.bindingHandlers[n]={init:function(n){return o.utils.domData.set(n,y,{}),{controlsDescendantBindings:!0}},update:function(n,u,f,e,s){var h=o.utils.domData.get(n,y),a=o.utils.unwrapObservable(u()),c=!i!=!a,l=!h.savedNodes,v=l||t||c!==h.didDisplayOnLastUpdate;v&&(l&&(h.savedNodes=o.utils.cloneNodes(o.virtualElements.childNodes(n),!0)),c?(l||o.virtualElements.setDomNodeChildren(n,o.utils.cloneNodes(h.savedNodes)),o.applyBindingsToDescendants(r?r(s,a):s,n)):o.virtualElements.emptyNode(n),h.didDisplayOnLastUpdate=c)}},o.expressionRewriting.bindingRewriteValidators[n]=!1,o.virtualElements.allowedBindings[n]=!0}function b(n,t,i){i&&t!==o.selectExtensions.readValue(n)&&o.selectExtensions.writeValue(n,t),t!==o.selectExtensions.readValue(n)&&o.dependencyDetection.ignore(o.utils.triggerEvent,null,[n,"change"])}var o=typeof e!="undefined"?e:{},c,w,s,l,a,v,h,y;o.exportSymbol=function(n,t){for(var i=n.split("."),u=o,r=0;r<i.length-1;r++)u=u[i[r]];u[i[i.length-1]]=t},o.exportProperty=function(n,t,i){n[t]=i},o.version="2.2.1",o.exportSymbol("version",o.version),o.utils=new function(){function l(n,t){if(o.utils.tagNameLower(n)!=="input"||!n.type||t.toLowerCase()!="click")return!1;var i=n.type;return i=="checkbox"||i=="radio"}var y=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,e={},a={},p=/Firefox\/2/i.test(r.userAgent)?"KeyboardEvent":"UIEvents",c,s,h,v;e[p]=["keyup","keydown","keypress"],e.MouseEvents=["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave"];for(c in e)if(s=e[c],s.length)for(h=0,v=s.length;h<v;h++)a[s[h]]=c;var w={propertychange:!0},n=function(){for(var n=3,t=i.createElement("div"),r=t.getElementsByTagName("i");t.innerHTML="<!--[if gt IE "+ ++n+"]><i><\/i><![endif]-->",r[0];);return n>4?n:f}(),b=n===6,k=n===7;return{fieldsIncludedWithJsonPost:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],arrayForEach:function(n,t){for(var i=0,r=n.length;i<r;i++)t(n[i])},arrayIndexOf:function(n,t){if(typeof Array.prototype.indexOf=="function")return Array.prototype.indexOf.call(n,t);for(var i=0,r=n.length;i<r;i++)if(n[i]===t)return i;return-1},arrayFirst:function(n,t,i){for(var r=0,u=n.length;r<u;r++)if(t.call(i,n[r]))return n[r];return null},arrayRemoveItem:function(n,t){var i=o.utils.arrayIndexOf(n,t);i>=0&&n.splice(i,1)},arrayGetDistinctValues:function(n){var i,t,r;for(n=n||[],i=[],t=0,r=n.length;t<r;t++)o.utils.arrayIndexOf(i,n[t])<0&&i.push(n[t]);return i},arrayMap:function(n,t){var r,i,u;for(n=n||[],r=[],i=0,u=n.length;i<u;i++)r.push(t(n[i]));return r},arrayFilter:function(n,t){var r,i,u;for(n=n||[],r=[],i=0,u=n.length;i<u;i++)t(n[i])&&r.push(n[i]);return r},arrayPushAll:function(n,t){if(t instanceof Array)n.push.apply(n,t);else for(var i=0,r=t.length;i<r;i++)n.push(t[i]);return n},extend:function(n,t){if(t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},emptyDomNode:function(n){while(n.firstChild)o.removeNode(n.firstChild)},moveCleanedNodesToContainerElement:function(n){for(var r=o.utils.makeArray(n),u=i.createElement("div"),t=0,f=r.length;t<f;t++)u.appendChild(o.cleanNode(r[t]));return u},cloneNodes:function(n,t){for(var r,i=0,f=n.length,u=[];i<f;i++)r=n[i].cloneNode(!0),u.push(t?o.cleanNode(r):r);return u},setDomNodeChildren:function(n,t){if(o.utils.emptyDomNode(n),t)for(var i=0,r=t.length;i<r;i++)n.appendChild(t[i])},replaceDomNodes:function(n,t){var r=n.nodeType?[n]:n,f,e,i,u;if(r.length>0){for(f=r[0],e=f.parentNode,i=0,u=t.length;i<u;i++)e.insertBefore(t[i],f);for(i=0,u=r.length;i<u;i++)o.removeNode(r[i])}},setOptionNodeSelectionState:function(t,i){n<7?t.setAttribute("selected",i):t.selected=i},stringTrim:function(n){return(n||"").replace(y,"")},stringTokenize:function(n,t){for(var u=[],f=(n||"").split(t),r,i=0,e=f.length;i<e;i++)r=o.utils.stringTrim(f[i]),r!==""&&u.push(r);return u},stringStartsWith:function(n,t){return(n=n||"",t.length>n.length)?!1:n.substring(0,t.length)===t},domNodeIsContainedBy:function(n,t){if(t.compareDocumentPosition)return(t.compareDocumentPosition(n)&16)==16;while(n!=null){if(n==t)return!0;n=n.parentNode}return!1},domNodeIsAttachedToDocument:function(n){return o.utils.domNodeIsContainedBy(n,n.ownerDocument)},tagNameLower:function(n){return n&&n.tagName&&n.tagName.toLowerCase()},registerEventHandler:function(t,i,r){var f=n&&w[i],e;if(f||typeof u=="undefined")if(f||typeof t.addEventListener!="function")if(typeof t.attachEvent!="undefined")t.attachEvent("on"+i,function(n){r.call(t,n)});else throw new Error("Browser doesn't support addEventListener or attachEvent");else t.addEventListener(i,r,!1);else l(t,i)&&(e=r,r=function(n,t){var i=this.checked;t&&(this.checked=t.checkedStateBeforeEvent!==!0),e.call(this,n),this.checked=i}),u(t).bind(i,r)},triggerEvent:function(n,r){var f,o,e;if(!(n&&n.nodeType))throw new Error("element must be a DOM node when calling triggerEvent");if(typeof u!="undefined")f=[],l(n,r)&&f.push({checkedStateBeforeEvent:n.checked}),u(n).trigger(r,f);else if(typeof i.createEvent=="function")if(typeof n.dispatchEvent=="function")o=a[r]||"HTMLEvents",e=i.createEvent(o),e.initEvent(r,!0,!0,t,0,0,0,0,0,!1,!1,!1,!1,0,n),n.dispatchEvent(e);else throw new Error("The supplied element doesn't support dispatchEvent");else if(typeof n.fireEvent!="undefined")l(n,r)&&(n.checked=n.checked!==!0),n.fireEvent("on"+r);else throw new Error("Browser doesn't support triggering events");},unwrapObservable:function(n){return o.isObservable(n)?n():n},peekObservable:function(n){return o.isObservable(n)?n.peek():n},toggleDomNodeCssClass:function(n,t,i){if(t){var u=/[\w-]+/g,r=n.className.match(u)||[];o.utils.arrayForEach(t.match(u),function(n){var t=o.utils.arrayIndexOf(r,n);t>=0?i||r.splice(t,1):i&&r.push(n)}),n.className=r.join(" ")}},setTextContent:function(n,t){var r=o.utils.unwrapObservable(t),u;(r===null||r===f)&&(r=""),n.nodeType===3?n.data=r:(u=o.virtualElements.firstChild(n),!u||u.nodeType!=3||o.virtualElements.nextSibling(u)?o.virtualElements.setDomNodeChildren(n,[i.createTextNode(r)]):u.data=r,o.utils.forceRefresh(n))},setElementName:function(t,r){if(t.name=r,n<=7)try{t.mergeAttributes(i.createElement("<input name='"+t.name+"'/>"),!1)}catch(u){}},forceRefresh:function(t){if(n>=9){var i=t.nodeType==1?t:t.parentNode;i.style&&(i.style.zoom=i.style.zoom)}},ensureSelectElementIsRenderedCorrectly:function(t){if(n>=9){var i=t.style.width;t.style.width=0,t.style.width=i}},range:function(n,t){var r,i;for(n=o.utils.unwrapObservable(n),t=o.utils.unwrapObservable(t),r=[],i=n;i<=t;i++)r.push(i);return r},makeArray:function(n){for(var i=[],t=0,r=n.length;t<r;t++)i.push(n[t]);return i},isIe6:b,isIe7:k,ieVersion:n,getFormFields:function(n,t){for(var r=o.utils.makeArray(n.getElementsByTagName("input")).concat(o.utils.makeArray(n.getElementsByTagName("textarea"))),f=typeof t=="string"?function(n){return n.name===t}:function(n){return t.test(n.name)},u=[],i=r.length-1;i>=0;i--)f(r[i])&&u.push(r[i]);return u},parseJson:function(n){return typeof n=="string"&&(n=o.utils.stringTrim(n),n)?t.JSON&&t.JSON.parse?t.JSON.parse(n):new Function("return "+n)():null},stringifyJson:function(n,t,i){if(typeof JSON=="undefined"||typeof JSON.stringify=="undefined")throw new Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return JSON.stringify(o.utils.unwrapObservable(n),t,i)},postJson:function(n,t,r){var a,h,c,s,u,e,f;r=r||{};var l=r.params||{},v=r.includeFields||this.fieldsIncludedWithJsonPost,y=n;if(typeof n=="object"&&o.utils.tagNameLower(n)==="form")for(a=n,y=a.action,h=v.length-1;h>=0;h--)for(c=o.utils.getFormFields(a,v[h]),s=c.length-1;s>=0;s--)l[c[s].name]=c[s].value;t=o.utils.unwrapObservable(t),u=i.createElement("form"),u.style.display="none",u.action=y,u.method="post";for(e in t)f=i.createElement("input"),f.name=e,f.value=o.utils.stringifyJson(o.utils.unwrapObservable(t[e])),u.appendChild(f);for(e in l)f=i.createElement("input"),f.name=e,f.value=l[e],u.appendChild(f);i.body.appendChild(u),r.submitter?r.submitter(u):u.submit(),setTimeout(function(){u.parentNode.removeChild(u)},0)}}},o.exportSymbol("utils",o.utils),o.exportSymbol("utils.arrayForEach",o.utils.arrayForEach),o.exportSymbol("utils.arrayFirst",o.utils.arrayFirst),o.exportSymbol("utils.arrayFilter",o.utils.arrayFilter),o.exportSymbol("utils.arrayGetDistinctValues",o.utils.arrayGetDistinctValues),o.exportSymbol("utils.arrayIndexOf",o.utils.arrayIndexOf),o.exportSymbol("utils.arrayMap",o.utils.arrayMap),o.exportSymbol("utils.arrayPushAll",o.utils.arrayPushAll),o.exportSymbol("utils.arrayRemoveItem",o.utils.arrayRemoveItem),o.exportSymbol("utils.extend",o.utils.extend),o.exportSymbol("utils.fieldsIncludedWithJsonPost",o.utils.fieldsIncludedWithJsonPost),o.exportSymbol("utils.getFormFields",o.utils.getFormFields),o.exportSymbol("utils.peekObservable",o.utils.peekObservable),o.exportSymbol("utils.postJson",o.utils.postJson),o.exportSymbol("utils.parseJson",o.utils.parseJson),o.exportSymbol("utils.registerEventHandler",o.utils.registerEventHandler),o.exportSymbol("utils.stringifyJson",o.utils.stringifyJson),o.exportSymbol("utils.range",o.utils.range),o.exportSymbol("utils.toggleDomNodeCssClass",o.utils.toggleDomNodeCssClass),o.exportSymbol("utils.triggerEvent",o.utils.triggerEvent),o.exportSymbol("utils.unwrapObservable",o.utils.unwrapObservable),Function.prototype.bind||(Function.prototype.bind=function(n){var i=this,t=Array.prototype.slice.call(arguments),n=t.shift();return function(){return i.apply(n,t.concat(Array.prototype.slice.call(arguments)))}}),o.utils.domData=new function(){var i=0,n="__ko__"+ +new Date,t={};return{get:function(n,t){var i=o.utils.domData.getAll(n,!1);return i===f?f:i[t]},set:function(n,t,i){if(i!==f||o.utils.domData.getAll(n,!1)!==f){var r=o.utils.domData.getAll(n,!0);r[t]=i}},getAll:function(r,u){var e=r[n],o=e&&e!=="null"&&t[e];if(!o){if(!u)return f;e=r[n]="ko"+i++,t[e]={}}return t[e]},clear:function(i){var r=i[n];return r?(delete t[r],i[n]=null,!0):!1}}},o.exportSymbol("utils.domData",o.utils.domData),o.exportSymbol("utils.domData.clear",o.utils.domData.clear),o.utils.domNodeDisposal=new function(){function t(t,i){var r=o.utils.domData.get(t,n);return r===f&&i&&(r=[],o.utils.domData.set(t,n,r)),r}function s(t){o.utils.domData.set(t,n,f)}function i(n){var i=t(n,!1),f;if(i)for(i=i.slice(0),f=0;f<i.length;f++)i[f](n);o.utils.domData.clear(n),typeof u=="function"&&typeof u.cleanData=="function"&&u.cleanData([n]),r[n.nodeType]&&h(n)}function h(n){for(var t,r=n.firstChild;t=r;)r=t.nextSibling,t.nodeType===8&&i(t)}var n="__ko_domNodeDisposal__"+ +new Date,e={1:!0,8:!0,9:!0},r={1:!0,9:!0};return{addDisposeCallback:function(n,i){if(typeof i!="function")throw new Error("Callback must be a function");t(n,!0).push(i)},removeDisposeCallback:function(n,i){var r=t(n,!1);r&&(o.utils.arrayRemoveItem(r,i),r.length==0&&s(n))},cleanNode:function(n){var t,u,f;if(e[n.nodeType]&&(i(n),r[n.nodeType]))for(t=[],o.utils.arrayPushAll(t,n.getElementsByTagName("*")),u=0,f=t.length;u<f;u++)i(t[u]);return n},removeNode:function(n){o.cleanNode(n),n.parentNode&&n.parentNode.removeChild(n)}}},o.cleanNode=o.utils.domNodeDisposal.cleanNode,o.removeNode=o.utils.domNodeDisposal.removeNode,o.exportSymbol("cleanNode",o.cleanNode),o.exportSymbol("removeNode",o.removeNode),o.exportSymbol("utils.domNodeDisposal",o.utils.domNodeDisposal),o.exportSymbol("utils.domNodeDisposal.addDisposeCallback",o.utils.domNodeDisposal.addDisposeCallback),o.exportSymbol("utils.domNodeDisposal.removeDisposeCallback",o.utils.domNodeDisposal.removeDisposeCallback),function(){function n(n){var u=o.utils.stringTrim(n).toLowerCase(),r=i.createElement("div"),f=u.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","<\/table>"]||!u.indexOf("<tr")&&[2,"<table><tbody>","<\/tbody><\/table>"]||(!u.indexOf("<td")||!u.indexOf("<th"))&&[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"]||[0,"",""],e="ignored<div>"+f[1]+n+f[2]+"<\/div>";for(typeof t.innerShiv=="function"?r.appendChild(t.innerShiv(e)):r.innerHTML=e;f[0]--;)r=r.lastChild;return o.utils.makeArray(r.lastChild.childNodes)}function r(n){var i,t;if(u.parseHTML)return u.parseHTML(n);if(i=u.clean([n]),i&&i[0]){for(t=i[0];t.parentNode&&t.parentNode.nodeType!==11;)t=t.parentNode;t.parentNode&&t.parentNode.removeChild(t)}return i}var e=/^(\s*)<!--(.*?)-->/;o.utils.parseHtmlFragment=function(t){return typeof u!="undefined"?r(t):n(t)},o.utils.setHtml=function(n,t){var r,i;if(o.utils.emptyDomNode(n),t=o.utils.unwrapObservable(t),t!==null&&t!==f)if(typeof t!="string"&&(t=t.toString()),typeof u!="undefined")u(n).html(t);else for(r=o.utils.parseHtmlFragment(t),i=0;i<r.length;i++)n.appendChild(r[i])}}(),o.exportSymbol("utils.parseHtmlFragment",o.utils.parseHtmlFragment),o.exportSymbol("utils.setHtml",o.utils.setHtml),o.memoization=function(){function t(){return((1+Math.random())*4294967296|0).toString(16).substring(1)}function r(){return t()+t()}function i(n,t){var r;if(n)if(n.nodeType==8)r=o.memoization.parseMemoText(n.nodeValue),r!=null&&t.push({domNode:n,memoId:r});else if(n.nodeType==1)for(var u=0,f=n.childNodes,e=f.length;u<e;u++)i(f[u],t)}var n={};return{memoize:function(t){if(typeof t!="function")throw new Error("You can only pass a function to ko.memoization.memoize()");var i=r();return n[i]=t,"<!--[ko_memo:"+i+"]-->"},unmemoize:function(t,i){var r=n[t];if(r===f)throw new Error("Couldn't find any memo with ID "+t+". Perhaps it's already been unmemoized.");try{return r.apply(null,i||[]),!0}finally{delete n[t]}},unmemoizeDomNodeAndDescendants:function(n,t){var f=[],u,s,r,e;for(i(n,f),u=0,s=f.length;u<s;u++)r=f[u].domNode,e=[r],t&&o.utils.arrayPushAll(e,t),o.memoization.unmemoize(f[u].memoId,e),r.nodeValue="",r.parentNode&&r.parentNode.removeChild(r)},parseMemoText:function(n){var t=n.match(/^\[ko_memo\:(.*?)\]$/);return t?t[1]:null}}}(),o.exportSymbol("memoization",o.memoization),o.exportSymbol("memoization.memoize",o.memoization.memoize),o.exportSymbol("memoization.unmemoize",o.memoization.unmemoize),o.exportSymbol("memoization.parseMemoText",o.memoization.parseMemoText),o.exportSymbol("memoization.unmemoizeDomNodeAndDescendants",o.memoization.unmemoizeDomNodeAndDescendants),o.extenders={throttle:function(n,t){n.throttleEvaluation=t;var i=null;return o.dependentObservable({read:n,write:function(r){clearTimeout(i),i=setTimeout(function(){n(r)},t)}})},notify:function(n,t){return n.equalityComparer=t=="always"?function(){return!1}:o.observable.fn.equalityComparer,n}},o.exportSymbol("extenders",o.extenders),o.subscription=function(n,t,i){this.target=n,this.callback=t,this.disposeCallback=i,o.exportProperty(this,"dispose",this.dispose)},o.subscription.prototype.dispose=function(){this.isDisposed=!0,this.disposeCallback()},o.subscribable=function(){this._subscriptions={},o.utils.extend(this,o.subscribable.fn),o.exportProperty(this,"subscribe",this.subscribe),o.exportProperty(this,"extend",this.extend),o.exportProperty(this,"getSubscriptionsCount",this.getSubscriptionsCount)},c="change",o.subscribable.fn={subscribe:function(n,t,i){i=i||c;var u=t?n.bind(t):n,r=new o.subscription(this,u,function(){o.utils.arrayRemoveItem(this._subscriptions[i],r)}.bind(this));return this._subscriptions[i]||(this._subscriptions[i]=[]),this._subscriptions[i].push(r),r},notifySubscribers:function(n,t){t=t||c,this._subscriptions[t]&&o.dependencyDetection.ignore(function(){o.utils.arrayForEach(this._subscriptions[t].slice(0),function(t){t&&t.isDisposed!==!0&&t.callback(n)})},this)},getSubscriptionsCount:function(){var t=0,n;for(n in this._subscriptions)this._subscriptions.hasOwnProperty(n)&&(t+=this._subscriptions[n].length);return t},extend:k},o.isSubscribable=function(n){return typeof n.subscribe=="function"&&typeof n.notifySubscribers=="function"},o.exportSymbol("subscribable",o.subscribable),o.exportSymbol("isSubscribable",o.isSubscribable),o.dependencyDetection=function(){var n=[];return{begin:function(t){n.push({callback:t,distinctDependencies:[]})},end:function(){n.pop()},registerDependency:function(t){if(!o.isSubscribable(t))throw new Error("Only subscribable things can act as dependencies");if(n.length>0){var i=n[n.length-1];if(!i||o.utils.arrayIndexOf(i.distinctDependencies,t)>=0)return;i.distinctDependencies.push(t),i.callback(t)}},ignore:function(t,i,r){try{return n.push(null),t.apply(i,r||[])}finally{n.pop()}}}}(),w={undefined:!0,boolean:!0,number:!0,string:!0},o.observable=function(t){function i(){return arguments.length>0?(i.equalityComparer&&i.equalityComparer(r,arguments[0])||(i.valueWillMutate(),r=arguments[0],n&&(i._latestValue=r),i.valueHasMutated()),this):(o.dependencyDetection.registerDependency(i),r)}var r=t;return n&&(i._latestValue=r),o.subscribable.call(i),i.peek=function(){return r},i.valueHasMutated=function(){i.notifySubscribers(r)},i.valueWillMutate=function(){i.notifySubscribers(r,"beforeChange")},o.utils.extend(i,o.observable.fn),o.exportProperty(i,"peek",i.peek),o.exportProperty(i,"valueHasMutated",i.valueHasMutated),o.exportProperty(i,"valueWillMutate",i.valueWillMutate),i},o.observable.fn={equalityComparer:function(n,t){var i=n===null||typeof n in w;return i?n===t:!1}},s=o.observable.protoProperty="__ko_proto__",o.observable.fn[s]=o.observable,o.hasPrototype=function(n,t){return n===null||n===f||n[s]===f?!1:n[s]===t?!0:o.hasPrototype(n[s],t)},o.isObservable=function(n){return o.hasPrototype(n,o.observable)},o.isWriteableObservable=function(n){return typeof n=="function"&&n[s]===o.observable?!0:typeof n=="function"&&n[s]===o.dependentObservable&&n.hasWriteFunction?!0:!1},o.exportSymbol("observable",o.observable),o.exportSymbol("isObservable",o.isObservable),o.exportSymbol("isWriteableObservable",o.isWriteableObservable),o.observableArray=function(n){if(arguments.length==0&&(n=[]),n!==null&&n!==f&&!("length"in n))throw new Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");var t=o.observable(n);return o.utils.extend(t,o.observableArray.fn),t},o.observableArray.fn={remove:function(n){for(var r=this.peek(),i=[],f=typeof n=="function"?n:function(t){return t===n},u,t=0;t<r.length;t++)u=r[t],f(u)&&(i.length===0&&this.valueWillMutate(),i.push(u),r.splice(t,1),t--);return i.length&&this.valueHasMutated(),i},removeAll:function(n){if(n===f){var t=this.peek(),i=t.slice(0);return this.valueWillMutate(),t.splice(0,t.length),this.valueHasMutated(),i}return n?this.remove(function(t){return o.utils.arrayIndexOf(n,t)>=0}):[]},destroy:function(n){var i=this.peek(),u=typeof n=="function"?n:function(t){return t===n},t,r;for(this.valueWillMutate(),t=i.length-1;t>=0;t--)r=i[t],u(r)&&(i[t]._destroy=!0);this.valueHasMutated()},destroyAll:function(n){return n===f?this.destroy(function(){return!0}):n?this.destroy(function(t){return o.utils.arrayIndexOf(n,t)>=0}):[]},indexOf:function(n){var t=this();return o.utils.arrayIndexOf(t,n)},replace:function(n,t){var i=this.indexOf(n);i>=0&&(this.valueWillMutate(),this.peek()[i]=t,this.valueHasMutated())}},o.utils.arrayForEach(["pop","push","reverse","shift","sort","splice","unshift"],function(n){o.observableArray.fn[n]=function(){var t=this.peek(),i;return this.valueWillMutate(),i=t[n].apply(t,arguments),this.valueHasMutated(),i}}),o.utils.arrayForEach(["slice"],function(n){o.observableArray.fn[n]=function(){var t=this();return t[n].apply(t,arguments)}}),o.exportSymbol("observableArray",o.observableArray),o.dependentObservable=function(t,i,r){function nt(n){s.push(n.subscribe(tt))}function w(){o.utils.arrayForEach(s,function(n){n.dispose()}),s=[]}function tt(){var n=u.throttleEvaluation;n&&n>=0?(clearTimeout(d),d=setTimeout(l,n)):l()}function l(){var t,l,r;if(!y){if(c&&p()){a();return}y=!0;try{for(t=o.utils.arrayMap(s,function(n){return n.target}),o.dependencyDetection.begin(function(n){var i;(i=o.utils.arrayIndexOf(t,n))>=0?t[i]=f:nt(n)}),l=e.call(i),r=t.length-1;r>=0;r--)t[r]&&s.splice(r,1)[0].dispose();c=!0,u.notifySubscribers(h,"beforeChange"),h=l,n&&(u._latestValue=h)}finally{o.dependencyDetection.end()}u.notifySubscribers(h),y=!1,s.length||a()}}function u(){if(arguments.length>0){if(typeof k=="function")k.apply(i,arguments);else throw new Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return this}return c||l(),o.dependencyDetection.registerDependency(u),h}function it(){return c||l(),h}function b(){return!c||s.length>0}var h,c=!1,y=!1,e=t,g;if(e&&typeof e=="object"?(r=e,e=r.read):(r=r||{},e||(e=r.read)),typeof e!="function")throw new Error("Pass a function that returns the value of the ko.computed");var k=r.write,v=r.disposeWhenNodeIsRemoved||r.disposeWhenNodeIsRemoved||null,p=r.disposeWhen||r.disposeWhen||function(){return!1},a=w,s=[],d=null;return i||(i=r.owner),u.peek=it,u.getDependenciesCount=function(){return s.length},u.hasWriteFunction=typeof r.write=="function",u.dispose=function(){a()},u.isActive=b,o.subscribable.call(u),o.utils.extend(u,o.dependentObservable.fn),o.exportProperty(u,"peek",u.peek),o.exportProperty(u,"dispose",u.dispose),o.exportProperty(u,"isActive",u.isActive),o.exportProperty(u,"getDependenciesCount",u.getDependenciesCount),r.deferEvaluation!==!0&&l(),v&&b()&&(a=function(){o.utils.domNodeDisposal.removeDisposeCallback(v,arguments.callee),w()},o.utils.domNodeDisposal.addDisposeCallback(v,a),g=p,p=function(){return!o.utils.domNodeIsAttachedToDocument(v)||g()}),u},o.isComputed=function(n){return o.hasPrototype(n,o.dependentObservable)},l=o.observable.protoProperty,o.dependentObservable[l]=o.observable,o.dependentObservable.fn={},o.dependentObservable.fn[l]=o.dependentObservable,o.exportSymbol("dependentObservable",o.dependentObservable),o.exportSymbol("computed",o.dependentObservable),o.exportSymbol("isComputed",o.isComputed),function(){function n(t,u,e){var s,o;return(e=e||new r,t=u(t),s=typeof t=="object"&&t!==null&&t!==f&&!(t instanceof Date),!s)?t:(o=t instanceof Array?[]:{},e.save(t,o),i(t,function(i){var r=u(t[i]),s;switch(typeof r){case"boolean":case"number":case"string":case"function":o[i]=r;break;case"object":case"undefined":s=e.get(r),o[i]=s!==f?s:n(r,u,e)}}),o)}function i(n,t){var i,r;if(n instanceof Array){for(i=0;i<n.length;i++)t(i);typeof n.toJSON=="function"&&t("toJSON")}else for(r in n)t(r)}function r(){var n=[],t=[];this.save=function(i,r){var u=o.utils.arrayIndexOf(n,i);u>=0?t[u]=r:(n.push(i),t.push(r))},this.get=function(i){var r=o.utils.arrayIndexOf(n,i);return r>=0?t[r]:f}}var t=10;o.toJS=function(i){if(arguments.length==0)throw new Error("When calling ko.toJS, pass the object you want to convert.");return n(i,function(n){for(var i=0;o.isObservable(n)&&i<t;i++)n=n();return n})},o.toJSON=function(n,t,i){var r=o.toJS(n);return o.utils.stringifyJson(r,t,i)}}(),o.exportSymbol("toJS",o.toJS),o.exportSymbol("toJSON",o.toJSON),function(){var n="__ko__hasDomDataOptionValue__";o.selectExtensions={readValue:function(t){switch(o.utils.tagNameLower(t)){case"option":return t[n]===!0?o.utils.domData.get(t,o.bindingHandlers.options.optionValueDomDataKey):o.utils.ieVersion<=7?t.getAttributeNode("value").specified?t.value:t.text:t.value;case"select":return t.selectedIndex>=0?o.selectExtensions.readValue(t.options[t.selectedIndex]):f;default:return t.value}},writeValue:function(t,i){switch(o.utils.tagNameLower(t)){case"option":switch(typeof i){case"string":o.utils.domData.set(t,o.bindingHandlers.options.optionValueDomDataKey,f),n in t&&delete t[n],t.value=i;break;default:o.utils.domData.set(t,o.bindingHandlers.options.optionValueDomDataKey,i),t[n]=!0,t.value=typeof i=="number"?i:""}break;case"select":for(var r=t.options.length-1;r>=0;r--)if(o.selectExtensions.readValue(t.options[r])==i){t.selectedIndex=r;break}break;default:(i===null||i===f)&&(i=""),t.value=i}}}}(),o.exportSymbol("selectExtensions",o.selectExtensions),o.exportSymbol("selectExtensions.readValue",o.selectExtensions.readValue),o.exportSymbol("selectExtensions.writeValue",o.selectExtensions.writeValue),o.expressionRewriting=function(){function n(n,i){for(var r=null;n!=r;)r=n,n=n.replace(t,function(n,t){return i[t]});return n}function u(n){if(o.utils.arrayIndexOf(i,o.utils.stringTrim(n).toLowerCase())>=0)return!1;var t=n.match(r);return t===null?!1:t[1]?"Object("+t[1]+")"+t[2]:n}function f(n){var t=o.utils.stringTrim(n);switch(t.length&&t.charAt(0)){case"'":case'"':return n;default:return"'"+t+"'"}}var t=/\@ko_token_(\d+)\@/g,i=["true","false"],r=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i;return{bindingRewriteValidators:[],parseObjectLiteral:function(t){var i=o.utils.stringTrim(t),e,u,s,y,a,r,f,h,c,p,b,w,k,l,v,d,g;if(i.length<3)return[];for(i.charAt(0)==="{"&&(i=i.substring(1,i.length-1)),e=[],u=null,r=0;r<i.length;r++)if(f=i.charAt(r),u===null)switch(f){case'"':case"'":case"/":u=r,s=f}else f==s&&i.charAt(r-1)!=="\\"&&(h=i.substring(u,r+1),e.push(h),c="@ko_token_"+(e.length-1)+"@",i=i.substring(0,u)+c+i.substring(r+1),r-=h.length-c.length,u=null);for(u=null,s=null,y=0,a=null,r=0;r<i.length;r++){if(f=i.charAt(r),u===null)switch(f){case"{":u=r,a=f,s="}";break;case"(":u=r,a=f,s=")";break;case"[":u=r,a=f,s="]"}f===a?y++:f===s&&(y--,y===0&&(h=i.substring(u,r+1),e.push(h),c="@ko_token_"+(e.length-1)+"@",i=i.substring(0,u)+c+i.substring(r+1),r-=h.length-c.length,u=null))}for(p=[],b=i.split(","),w=0,k=b.length;w<k;w++)l=b[w],v=l.indexOf(":"),v>0&&v<l.length-1?(d=l.substring(0,v),g=l.substring(v+1),p.push({key:n(d,e),value:n(g,e)})):p.push({unknown:n(l,e)});return p},preProcessBindings:function(n){for(var a=typeof n=="string"?o.expressionRewriting.parseObjectLiteral(n):n,t=[],r=[],i,c,e,s,l,h=0;i=a[h];h++)t.length>0&&t.push(","),i.key?(c=f(i.key),e=i.value,t.push(c),t.push(":"),t.push(e),(e=u(o.utils.stringTrim(e)))&&(r.length>0&&r.push(", "),r.push(c+" : function(__ko_value) { "+e+" = __ko_value; }"))):i.unknown&&t.push(i.unknown);return s=t.join(""),r.length>0&&(l=r.join(""),s=s+", '_ko_property_writers' : { "+l+" } "),s},keyValueArrayContainsKey:function(n,t){for(var i=0;i<n.length;i++)if(o.utils.stringTrim(n[i].key)==t)return!0;return!1},writeValueToProperty:function(n,t,i,r,u){if(n&&o.isWriteableObservable(n))u&&n.peek()===r||n(r);else{var f=t()._ko_property_writers;f&&f[i]&&f[i](r)}}}}(),o.exportSymbol("expressionRewriting",o.expressionRewriting),o.exportSymbol("expressionRewriting.bindingRewriteValidators",o.expressionRewriting.bindingRewriteValidators),o.exportSymbol("expressionRewriting.parseObjectLiteral",o.expressionRewriting.parseObjectLiteral),o.exportSymbol("expressionRewriting.preProcessBindings",o.expressionRewriting.preProcessBindings),o.exportSymbol("jsonExpressionRewriting",o.expressionRewriting),o.exportSymbol("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",o.expressionRewriting.preProcessBindings),function(){function n(n){return n.nodeType==8&&(t?n.text:n.nodeValue).match(e)}function r(n){return n.nodeType==8&&(t?n.text:n.nodeValue).match(s)}function u(t,i){for(var u=t,f=1,e=[];u=u.nextSibling;){if(r(u)&&(f--,f===0))return e;e.push(u),n(u)&&f++}if(!i)throw new Error("Cannot find closing comment tag to match: "+t.nodeValue);return null}function f(n,t){var i=u(n,t);return i?i.length>0?i[i.length-1].nextSibling:n.nextSibling:null}function c(t){var i=t.firstChild,u=null,e;if(i)do u?u.push(i):n(i)?(e=f(i,!0),e?i=e:u=[i]):r(i)&&(u=[i]);while(i=i.nextSibling);return u}var t=i.createComment("test").text==="<!--test-->",e=t?/^<!--\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*-->$/:/^\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*$/,s=t?/^<!--\s*\/ko\s*-->$/:/^\s*\/ko\s*$/,h={ul:!0,ol:!0};o.virtualElements={allowedBindings:{},childNodes:function(t){return n(t)?u(t):t.childNodes},emptyNode:function(t){var r,i,u;if(n(t))for(r=o.virtualElements.childNodes(t),i=0,u=r.length;i<u;i++)o.removeNode(r[i]);else o.utils.emptyDomNode(t)},setDomNodeChildren:function(t,i){var u,r,f;if(n(t))for(o.virtualElements.emptyNode(t),u=t.nextSibling,r=0,f=i.length;r<f;r++)u.parentNode.insertBefore(i[r],u);else o.utils.setDomNodeChildren(t,i)},prepend:function(t,i){n(t)?t.parentNode.insertBefore(i,t.nextSibling):t.firstChild?t.insertBefore(i,t.firstChild):t.appendChild(i)},insertAfter:function(t,i,r){r?n(t)?t.parentNode.insertBefore(i,r.nextSibling):r.nextSibling?t.insertBefore(i,r.nextSibling):t.appendChild(i):o.virtualElements.prepend(t,i)},firstChild:function(t){return n(t)?!t.nextSibling||r(t.nextSibling)?null:t.nextSibling:t.firstChild},nextSibling:function(t){return(n(t)&&(t=f(t)),t.nextSibling&&r(t.nextSibling))?null:t.nextSibling},virtualNodeBindingValue:function(t){var i=n(t);return i?i[1]:null},normaliseVirtualElementDomStructure:function(n){var t,i,u,r;if(h[o.utils.tagNameLower(n)]&&(t=n.firstChild,t))do if(t.nodeType===1&&(i=c(t),i))for(u=t.nextSibling,r=0;r<i.length;r++)u?n.insertBefore(i[r],u):n.appendChild(i[r]);while(t=t.nextSibling)}}}(),o.exportSymbol("virtualElements",o.virtualElements),o.exportSymbol("virtualElements.allowedBindings",o.virtualElements.allowedBindings),o.exportSymbol("virtualElements.emptyNode",o.virtualElements.emptyNode),o.exportSymbol("virtualElements.insertAfter",o.virtualElements.insertAfter),o.exportSymbol("virtualElements.prepend",o.virtualElements.prepend),o.exportSymbol("virtualElements.setDomNodeChildren",o.virtualElements.setDomNodeChildren),function(){function t(n,t){var r=n;return t[r]||(t[r]=i(n))}function i(n){var t=o.expressionRewriting.preProcessBindings(n),i="with($context){with($data||{}){return{"+t+"}}}";return new Function("$context","$element",i)}var n="data-bind";o.bindingProvider=function(){this.bindingCache={}},o.utils.extend(o.bindingProvider.prototype,{nodeHasBindings:function(t){switch(t.nodeType){case 1:return t.getAttribute(n)!=null;case 8:return o.virtualElements.virtualNodeBindingValue(t)!=null;default:return!1}},getBindings:function(n,t){var i=this.getBindingsString(n,t);return i?this.parseBindingsString(i,t,n):null},getBindingsString:function(t){switch(t.nodeType){case 1:return t.getAttribute(n);case 8:return o.virtualElements.virtualNodeBindingValue(t);default:return null}},parseBindingsString:function(n,i,r){try{var u=t(n,this.bindingCache);return u(i,r)}catch(f){throw new Error("Unable to parse bindings.\nMessage: "+f+";\nBindings value: "+n);}}}),o.bindingProvider.instance=new o.bindingProvider}(),o.exportSymbol("bindingProvider",o.bindingProvider),function(){function e(n){var t=o.virtualElements.allowedBindings[n];if(!t)throw new Error("The binding '"+n+"' cannot be used with virtual elements");}function n(n,t,r){for(var u,f=o.virtualElements.firstChild(t);u=f;)f=o.virtualElements.nextSibling(u),i(n,u,r)}function i(t,i,u){var e=!0,f=i.nodeType===1,s;f&&o.virtualElements.normaliseVirtualElementDomStructure(i),s=f&&u||o.bindingProvider.instance.nodeHasBindings(i),s&&(e=r(i,null,t,u).shouldBindDescendants),e&&n(t,i,!f)}function r(n,t,i,r){function c(n){return function(){return u[n]}}function l(){return u}var s=0,u,h;return o.dependentObservable(function(){var y=i&&i instanceof o.bindingContext?i:new o.bindingContext(o.utils.unwrapObservable(i)),w=y.$data,b,k,p,a,v,d;if(r&&o.storedBindingContextForNode(n,y),b=typeof t=="function"?t(y,n):t,u=b||o.bindingProvider.instance.getBindings(n,y),u){if(s===0){s=1;for(a in u)if(v=o.bindingHandlers[a],v&&n.nodeType===8&&e(a),v&&typeof v.init=="function"&&(k=v.init,p=k(n,c(a),l,w,y),p&&p.controlsDescendantBindings)){if(h!==f)throw new Error("Multiple bindings ("+h+" and "+a+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");h=a}s=2}if(s===2)for(a in u)v=o.bindingHandlers[a],v&&typeof v.update=="function"&&(d=v.update,d(n,c(a),l,w,y))}},null,{disposeWhenNodeIsRemoved:n}),{shouldBindDescendants:h===f}}o.bindingHandlers={},o.bindingContext=function(n,t,i){t?(o.utils.extend(this,t),this.$parentContext=t,this.$parent=t.$data,this.$parents=(t.$parents||[]).slice(0),this.$parents.unshift(this.$parent)):(this.$parents=[],this.$root=n,this.ko=o),this.$data=n,i&&(this[i]=n)},o.bindingContext.prototype.createChildContext=function(n,t){return new o.bindingContext(n,this,t)},o.bindingContext.prototype.extend=function(n){var t=o.utils.extend(new o.bindingContext,this);return o.utils.extend(t,n)};var u="__ko_bindingContext__";o.storedBindingContextForNode=function(n,t){if(arguments.length==2)o.utils.domData.set(n,u,t);else return o.utils.domData.get(n,u)},o.applyBindingsToNode=function(n,t,i){return n.nodeType===1&&o.virtualElements.normaliseVirtualElementDomStructure(n),r(n,t,i,!0)},o.applyBindingsToDescendants=function(t,i){(i.nodeType===1||i.nodeType===8)&&n(t,i,!0)},o.applyBindings=function(n,r){if(r&&r.nodeType!==1&&r.nodeType!==8)throw new Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");r=r||t.document.body,i(n,r,!0)},o.contextFor=function(n){switch(n.nodeType){case 1:case 8:var t=o.storedBindingContextForNode(n);if(t)return t;if(n.parentNode)return o.contextFor(n.parentNode)}return f},o.dataFor=function(n){var t=o.contextFor(n);return t?t.$data:f},o.exportSymbol("bindingHandlers",o.bindingHandlers),o.exportSymbol("applyBindings",o.applyBindings),o.exportSymbol("applyBindingsToDescendants",o.applyBindingsToDescendants),o.exportSymbol("applyBindingsToNode",o.applyBindingsToNode),o.exportSymbol("contextFor",o.contextFor),o.exportSymbol("dataFor",o.dataFor)}(),a={"class":"className","for":"htmlFor"},o.bindingHandlers.attr={update:function(n,t){var s=o.utils.unwrapObservable(t())||{},r,u,e;for(r in s)typeof r=="string"&&(u=o.utils.unwrapObservable(s[r]),e=u===!1||u===null||u===f,e&&n.removeAttribute(r),o.utils.ieVersion<=8&&r in a?(r=a[r],e?n.removeAttribute(r):n[r]=u):e||n.setAttribute(r,u.toString()),r==="name"&&o.utils.setElementName(n,e?"":u.toString()))}},o.bindingHandlers.checked={init:function(n,t,i){var r=function(){var f,r,e,u;if(n.type=="checkbox")f=n.checked;else if(n.type=="radio"&&n.checked)f=n.value;else return;r=t(),e=o.utils.unwrapObservable(r),n.type=="checkbox"&&e instanceof Array?(u=o.utils.arrayIndexOf(e,n.value),n.checked&&u<0?r.push(n.value):!n.checked&&u>=0&&r.splice(u,1)):o.expressionRewriting.writeValueToProperty(r,i,"checked",f,!0)};o.utils.registerEventHandler(n,"click",r),n.type!="radio"||n.name||o.bindingHandlers.uniqueName.init(n,function(){return!0})},update:function(n,t){var i=o.utils.unwrapObservable(t());n.type=="checkbox"?n.checked=i instanceof Array?o.utils.arrayIndexOf(i,n.value)>=0:i:n.type=="radio"&&(n.checked=n.value==i)}},v="__ko__cssValue",o.bindingHandlers.css={update:function(n,t){var i=o.utils.unwrapObservable(t()),r,u;if(typeof i=="object")for(r in i)u=o.utils.unwrapObservable(i[r]),o.utils.toggleDomNodeCssClass(n,r,u);else i=String(i||""),o.utils.toggleDomNodeCssClass(n,n[v],!1),n[v]=i,o.utils.toggleDomNodeCssClass(n,i,!0)}},o.bindingHandlers.enable={update:function(n,t){var i=o.utils.unwrapObservable(t());i&&n.disabled?n.removeAttribute("disabled"):i||n.disabled||(n.disabled=!0)}},o.bindingHandlers.disable={update:function(n,t){o.bindingHandlers.enable.update(n,function(){return!o.utils.unwrapObservable(t())})}},o.bindingHandlers.event={init:function(n,t,i,r){var f=t()||{},u;for(u in f)(function(){var f=u;typeof f=="string"&&o.utils.registerEventHandler(n,f,function(n){var e,s=t()[f],h,u,c;if(s){h=i();try{u=o.utils.makeArray(arguments),u.unshift(r),e=s.apply(r,u)}finally{e!==!0&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}c=h[f+"Bubble"]!==!1,c||(n.cancelBubble=!0,n.stopPropagation&&n.stopPropagation())}})})()}},o.bindingHandlers.foreach={makeTemplateValueAccessor:function(n){return function(){var i=n(),t=o.utils.peekObservable(i);return!t||typeof t.length=="number"?{foreach:i,templateEngine:o.nativeTemplateEngine.instance}:(o.utils.unwrapObservable(i),{foreach:t.data,as:t.as,includeDestroyed:t.includeDestroyed,afterAdd:t.afterAdd,beforeRemove:t.beforeRemove,afterRender:t.afterRender,beforeMove:t.beforeMove,afterMove:t.afterMove,templateEngine:o.nativeTemplateEngine.instance})}},init:function(n,t){return o.bindingHandlers.template.init(n,o.bindingHandlers.foreach.makeTemplateValueAccessor(t))},update:function(n,t,i,r,u){return o.bindingHandlers.template.update(n,o.bindingHandlers.foreach.makeTemplateValueAccessor(t),i,r,u)}},o.expressionRewriting.bindingRewriteValidators.foreach=!1,o.virtualElements.allowedBindings.foreach=!0,h="__ko_hasfocusUpdating",o.bindingHandlers.hasfocus={init:function(n,t,i){var r=function(r){var u,f;n[h]=!0,u=n.ownerDocument,"activeElement"in u&&(r=u.activeElement===n),f=t(),o.expressionRewriting.writeValueToProperty(f,i,"hasfocus",r,!0),n[h]=!1},u=r.bind(null,!0),f=r.bind(null,!1);o.utils.registerEventHandler(n,"focus",u),o.utils.registerEventHandler(n,"focusin",u),o.utils.registerEventHandler(n,"blur",f),o.utils.registerEventHandler(n,"focusout",f)},update:function(n,t){var i=o.utils.unwrapObservable(t());n[h]||(i?n.focus():n.blur(),o.dependencyDetection.ignore(o.utils.triggerEvent,null,[n,i?"focusin":"focusout"]))}},o.bindingHandlers.html={init:function(){return{controlsDescendantBindings:!0}},update:function(n,t){o.utils.setHtml(n,t())}},y="__ko_withIfBindingData",p("if"),p("ifnot",!1,!0),p("with",!0,!1,function(n,t){return n.createChildContext(t)}),o.bindingHandlers.options={update:function(n,t,r){var e,y,c,s,v,w,l,k,u,a;if(o.utils.tagNameLower(n)!=="select")throw new Error("options binding applies only to SELECT elements");for(var d=n.length==0,g=o.utils.arrayMap(o.utils.arrayFilter(n.childNodes,function(n){return n.tagName&&o.utils.tagNameLower(n)==="option"&&n.selected}),function(n){return o.selectExtensions.readValue(n)||n.innerText||n.textContent}),nt=n.scrollTop,h=o.utils.unwrapObservable(t()),tt=n.value;n.length>0;)o.cleanNode(n.options[0]),n.remove(0);if(h){for(e=r(),y=e.optionsIncludeDestroyed,typeof h.length!="number"&&(h=[h]),e.optionsCaption&&(s=i.createElement("option"),o.utils.setHtml(s,e.optionsCaption),o.selectExtensions.writeValue(s,f),n.appendChild(s)),u=0,a=h.length;u<a;u++)if(c=h[u],!c||!c._destroy||y){s=i.createElement("option");function p(n,t,i){var r=typeof t;return r=="function"?t(n):r=="string"?n[t]:i}v=p(c,e.optionsValue,c),o.selectExtensions.writeValue(s,o.utils.unwrapObservable(v)),w=p(c,e.optionsText,v),o.utils.setTextContent(s,w),n.appendChild(s)}for(l=n.getElementsByTagName("option"),k=0,u=0,a=l.length;u<a;u++)o.utils.arrayIndexOf(g,o.selectExtensions.readValue(l[u]))>=0&&(o.utils.setOptionNodeSelectionState(l[u],!0),k++);n.scrollTop=nt,d&&"value"in e&&b(n,o.utils.peekObservable(e.value),!0),o.utils.ensureSelectElementIsRenderedCorrectly(n)}}},o.bindingHandlers.options.optionValueDomDataKey="__ko.optionValueDomData__",o.bindingHandlers.selectedOptions={init:function(n,t,i){o.utils.registerEventHandler(n,"change",function(){var u=t(),r=[];o.utils.arrayForEach(n.getElementsByTagName("option"),function(n){n.selected&&r.push(o.selectExtensions.readValue(n))}),o.expressionRewriting.writeValueToProperty(u,i,"value",r)})},update:function(n,t){if(o.utils.tagNameLower(n)!="select")throw new Error("values binding applies only to SELECT elements");var i=o.utils.unwrapObservable(t());i&&typeof i.length=="number"&&o.utils.arrayForEach(n.getElementsByTagName("option"),function(n){var t=o.utils.arrayIndexOf(i,o.selectExtensions.readValue(n))>=0;o.utils.setOptionNodeSelectionState(n,t)})}},o.bindingHandlers.style={update:function(n,t){var r=o.utils.unwrapObservable(t()||{}),i,u;for(i in r)typeof i=="string"&&(u=o.utils.unwrapObservable(r[i]),n.style[i]=u||"")}},o.bindingHandlers.submit={init:function(n,t,i,r){if(typeof t()!="function")throw new Error("The value for a submit binding must be a function");o.utils.registerEventHandler(n,"submit",function(i){var u,f=t();try{u=f.call(r,n)}finally{u!==!0&&(i.preventDefault?i.preventDefault():i.returnValue=!1)}})}},o.bindingHandlers.text={update:function(n,t){o.utils.setTextContent(n,t())}},o.virtualElements.allowedBindings.text=!0,o.bindingHandlers.uniqueName={init:function(n,t){if(t()){var i="ko_unique_"+ ++o.bindingHandlers.uniqueName.currentIndex;o.utils.setElementName(n,i)}}},o.bindingHandlers.uniqueName.currentIndex=0,o.bindingHandlers.value={init:function(n,t,i){var r=["change"],u=i().valueUpdate,e=!1,f,s;u&&(typeof u=="string"&&(u=[u]),o.utils.arrayPushAll(r,u),r=o.utils.arrayGetDistinctValues(r)),f=function(){e=!1;var r=t(),u=o.selectExtensions.readValue(n);o.expressionRewriting.writeValueToProperty(r,i,"value",u)},s=o.utils.ieVersion&&n.tagName.toLowerCase()=="input"&&n.type=="text"&&n.autocomplete!="off"&&(!n.form||n.form.autocomplete!="off"),s&&o.utils.arrayIndexOf(r,"propertychange")==-1&&(o.utils.registerEventHandler(n,"propertychange",function(){e=!0}),o.utils.registerEventHandler(n,"blur",function(){e&&f()})),o.utils.arrayForEach(r,function(t){var i=f;o.utils.stringStartsWith(t,"after")&&(i=function(){setTimeout(f,0)},t=t.substring("after".length)),o.utils.registerEventHandler(n,t,i)})},update:function(n,t){var f=o.utils.tagNameLower(n)==="select",i=o.utils.unwrapObservable(t()),r=o.selectExtensions.readValue(n),e=i!=r,u,s;i===0&&r!==0&&r!=="0"&&(e=!0),e&&(u=function(){o.selectExtensions.writeValue(n,i)},u(),s=f,s&&setTimeout(u,0)),f&&n.length>0&&b(n,i,!1)}},o.bindingHandlers.visible={update:function(n,t){var i=o.utils.unwrapObservable(t()),r=!(n.style.display=="none");i&&!r?n.style.display="":!i&&r&&(n.style.display="none")}},d("click"),o.templateEngine=function(){},o.templateEngine.prototype.renderTemplateSource=function(){throw new Error("Override renderTemplateSource");},o.templateEngine.prototype.createJavaScriptEvaluatorBlock=function(){throw new Error("Override createJavaScriptEvaluatorBlock");},o.templateEngine.prototype.makeTemplateSource=function(n,t){if(typeof n=="string"){t=t||i;var r=t.getElementById(n);if(!r)throw new Error("Cannot find template with ID "+n);return new o.templateSources.domElement(r)}if(n.nodeType==1||n.nodeType==8)return new o.templateSources.anonymousTemplate(n);throw new Error("Unknown template type: "+n);},o.templateEngine.prototype.renderTemplate=function(n,t,i,r){var u=this.makeTemplateSource(n,r);return this.renderTemplateSource(u,t,i)},o.templateEngine.prototype.isTemplateRewritten=function(n,t){return this.allowTemplateRewriting===!1?!0:this.makeTemplateSource(n,t).data("isRewritten")},o.templateEngine.prototype.rewriteTemplate=function(n,t,i){var r=this.makeTemplateSource(n,i),u=t(r.text());r.text(u),r.data("isRewritten",!0)},o.exportSymbol("templateEngine",o.templateEngine),o.templateRewriting=function(){function r(n){for(var f=o.expressionRewriting.bindingRewriteValidators,i,r,u,t=0;t<n.length;t++)if(i=n[t].key,f.hasOwnProperty(i))if(r=f[i],typeof r=="function"){if(u=r(n[t].value),u)throw new Error(u);}else if(!r)throw new Error("This template engine does not support the '"+i+"' binding within its templates");}function n(n,t,i){var u=o.expressionRewriting.parseObjectLiteral(n),f,e;return r(u),f=o.expressionRewriting.preProcessBindings(u),e="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+f+" } })()})",i.createJavaScriptEvaluatorBlock(e)+t}var t=/(<[a-z]+\d*(\s+(?!data-bind=)[a-z0-9\-]+(=(\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind=(["'])([\s\S]*?)\5/gi,i=/<!--\s*ko\b\s*([\s\S]*?)\s*-->/g;return{ensureTemplateIsRewritten:function(n,t,i){t.isTemplateRewritten(n,i)||t.rewriteTemplate(n,function(n){return o.templateRewriting.memoizeBindingAttributeSyntax(n,t)},i)},memoizeBindingAttributeSyntax:function(r,u){return r.replace(t,function(){return n(arguments[6],arguments[1],u)}).replace(i,function(){return n(arguments[1],"<!-- ko -->",u)})},applyMemoizedBindingsToNextSibling:function(n){return o.memoization.memoize(function(t,i){t.nextSibling&&o.applyBindingsToNode(t.nextSibling,n,i)})}}}(),o.exportSymbol("__tr_ambtns",o.templateRewriting.applyMemoizedBindingsToNextSibling),function(){o.templateSources={},o.templateSources.domElement=function(n){this.domElement=n},o.templateSources.domElement.prototype.text=function(){var i=o.utils.tagNameLower(this.domElement),n=i==="script"?"text":i==="textarea"?"value":"innerHTML",t;if(arguments.length==0)return this.domElement[n];t=arguments[0],n==="innerHTML"?o.utils.setHtml(this.domElement,t):this.domElement[n]=t},o.templateSources.domElement.prototype.data=function(n){if(arguments.length===1)return o.utils.domData.get(this.domElement,"templateSourceData_"+n);o.utils.domData.set(this.domElement,"templateSourceData_"+n,arguments[1])};var n="__ko_anon_template__";o.templateSources.anonymousTemplate=function(n){this.domElement=n},o.templateSources.anonymousTemplate.prototype=new o.templateSources.domElement,o.templateSources.anonymousTemplate.prototype.text=function(){var t,i;if(arguments.length==0)return t=o.utils.domData.get(this.domElement,n)||{},t.textData===f&&t.containerData&&(t.textData=t.containerData.innerHTML),t.textData;i=arguments[0],o.utils.domData.set(this.domElement,n,{textData:i})},o.templateSources.domElement.prototype.nodes=function(){var t,i;if(arguments.length==0)return t=o.utils.domData.get(this.domElement,n)||{},t.containerData;i=arguments[0],o.utils.domData.set(this.domElement,n,{containerData:i})},o.exportSymbol("templateSources",o.templateSources),o.exportSymbol("templateSources.domElement",o.templateSources.domElement),o.exportSymbol("templateSources.anonymousTemplate",o.templateSources.anonymousTemplate)}(),function(){function r(n,t,i){for(var r,u=n,f=o.virtualElements.nextSibling(t);u&&(r=u)!==f;)u=o.virtualElements.nextSibling(r),(r.nodeType===1||r.nodeType===8)&&i(r)}function u(n,t){if(n.length){var i=n[0],u=n[n.length-1];r(i,u,function(n){o.applyBindings(t,n)}),r(i,u,function(n){o.memoization.unmemoizeDomNodeAndDescendants(n,[t])})}}function t(n){return n.nodeType?n:n.length>0?n[0]:null}function e(i,r,f,e,s){var h,c;s=s||{};var l=i&&t(i),a=l&&l.ownerDocument,v=s.templateEngine||n;if(o.templateRewriting.ensureTemplateIsRewritten(f,v,a),h=v.renderTemplate(f,e,s,a),typeof h.length!="number"||h.length>0&&typeof h[0].nodeType!="number")throw new Error("Template engine must return an array of DOM nodes");c=!1;switch(r){case"replaceChildren":o.virtualElements.setDomNodeChildren(i,h),c=!0;break;case"replaceNode":o.utils.replaceDomNodes(i,h),c=!0;break;case"ignoreTargetNode":break;default:throw new Error("Unknown renderMode: "+r);}return c&&(u(h,e),s.afterRender&&o.dependencyDetection.ignore(s.afterRender,null,[h,e.$data])),h}function s(n,t){var r=o.utils.domData.get(n,i);r&&typeof r.dispose=="function"&&r.dispose(),o.utils.domData.set(n,i,t&&t.isActive()?t:f)}var n,i;o.setTemplateEngine=function(t){if(t!=f&&!(t instanceof o.templateEngine))throw new Error("templateEngine must inherit from ko.templateEngine");n=t},o.renderTemplate=function(i,r,u,s,h){if(u=u||{},(u.templateEngine||n)==f)throw new Error("Set a template engine before calling renderTemplate");if(h=h||"replaceChildren",s){var c=t(s),l=function(){return!c||!o.utils.domNodeIsAttachedToDocument(c)},a=c&&h=="replaceNode"?c.parentNode:c;return o.dependentObservable(function(){var n=r&&r instanceof o.bindingContext?r:new o.bindingContext(o.utils.unwrapObservable(r)),f=typeof i=="function"?i(n.$data,n):i,l=e(s,h,f,n,u);h=="replaceNode"&&(s=l,c=t(s))},null,{disposeWhen:l,disposeWhenNodeIsRemoved:a})}return o.memoization.memoize(function(n){o.renderTemplate(i,r,u,n,"replaceNode")})},o.renderTemplateForEach=function(n,t,i,r,s){var h,c=function(t,r){h=s.createChildContext(o.utils.unwrapObservable(t),i.as),h.$index=r;var u=typeof n=="function"?n(t,h):n;return e(null,"ignoreTargetNode",u,h,i)},l=function(n,t){u(t,h),i.afterRender&&i.afterRender(t,n)};return o.dependentObservable(function(){var n=o.utils.unwrapObservable(t)||[],u;typeof n.length=="undefined"&&(n=[n]),u=o.utils.arrayFilter(n,function(n){return i.includeDestroyed||n===f||n===null||!o.utils.unwrapObservable(n._destroy)}),o.dependencyDetection.ignore(o.utils.setDomNodeChildrenFromArrayMapping,null,[r,u,c,i,l])},null,{disposeWhenNodeIsRemoved:r})},i="__ko__templateComputedDomDataKey__",o.bindingHandlers.template={init:function(n,t){var i=o.utils.unwrapObservable(t()),r,u;return typeof i=="string"||i.name||n.nodeType!=1&&n.nodeType!=8||(r=n.nodeType==1?n.childNodes:o.virtualElements.childNodes(n),u=o.utils.moveCleanedNodesToContainerElement(r),new o.templateSources.anonymousTemplate(n).nodes(u)),{controlsDescendantBindings:!0}},update:function(n,t,i,r,u){var e=o.utils.unwrapObservable(t()),f={},h=!0,l,c=null,a,v;typeof e!="string"&&(f=e,e=f.name,"if"in f&&(h=o.utils.unwrapObservable(f["if"])),h&&"ifnot"in f&&(h=!o.utils.unwrapObservable(f.ifnot)),l=o.utils.unwrapObservable(f.data)),"foreach"in f?(a=h&&f.foreach||[],c=o.renderTemplateForEach(e||n,a,f,n,u)):h?(v="data"in f?u.createChildContext(l,f.as):u,c=o.renderTemplate(e||n,v,f,n)):o.virtualElements.emptyNode(n),s(n,c)}},o.expressionRewriting.bindingRewriteValidators.template=function(n){var t=o.expressionRewriting.parseObjectLiteral(n);return t.length==1&&t[0].unknown?null:o.expressionRewriting.keyValueArrayContainsKey(t,"name")?null:"This template engine does not support anonymous templates nested within its templates"},o.virtualElements.allowedBindings.template=!0}(),o.exportSymbol("setTemplateEngine",o.setTemplateEngine),o.exportSymbol("renderTemplate",o.renderTemplate),o.utils.compareArrays=function(){function r(r,u,f){return r=r||[],u=u||[],r.length<=u.length?i(r,u,n,t,f):i(u,r,t,n,f)}function i(n,t,i,r,u){for(var nt=Math.min,ot=Math.max,l=[],c=n.length,f,a=t.length,st=a-c||1,tt=c+a+1,o,b,it,rt,ut,ft,et,y,g,h,p,w,e=0;e<=c;e++)for(b=o,l.push(o=[]),it=nt(a,e+st),rt=ot(0,e-1),f=rt;f<=it;f++)f?e?n[e-1]===t[f-1]?o[f]=b[f-1]:(ut=b[f]||tt,ft=o[f-1]||tt,o[f]=nt(ut,ft)+1):o[f]=f+1:o[f]=e+1;var s=[],k,d=[],v=[];for(e=c,f=a;e||f;)k=l[e][f]-1,f&&k===l[e][f-1]?d.push(s[s.length]={status:i,value:t[--f],index:f}):e&&k===l[e-1][f]?v.push(s[s.length]={status:r,value:n[--e],index:e}):(s.push({status:"retained",value:t[--f]}),--e);if(d.length&&v.length)for(et=c*10,y=g=0;(u||y<et)&&(p=d[g]);g++){for(h=0;w=v[h];h++)if(p.value===w.value){p.moved=w.index,w.moved=p.index,v.splice(h,1),y=h=0;break}y+=h}return s.reverse()}var n="added",t="deleted";return r}(),o.exportSymbol("utils.compareArrays",o.utils.compareArrays),function(){function n(n){while(n.length&&!o.utils.domNodeIsAttachedToDocument(n[0]))n.splice(0,1);if(n.length>1){for(var t=n[0],r=n[n.length-1],i=[t];t!==r;){if(t=t.nextSibling,!t)return;i.push(t)}Array.prototype.splice.apply(n,[0,n.length].concat(i))}return n}function i(t,i,r,u,e){var s=[],h=o.dependentObservable(function(){var t=i(r,e)||[];s.length>0&&(o.utils.replaceDomNodes(n(s),t),u&&o.dependencyDetection.ignore(u,null,[r,t,e])),s.splice(0,s.length),o.utils.arrayPushAll(s,t)},null,{disposeWhenNodeIsRemoved:t,disposeWhen:function(){return s.length==0||!o.utils.domNodeIsAttachedToDocument(s[0])}});return{mappedNodes:s,dependentObservable:h.isActive()?h:f}}var t="setDomNodeChildrenFromArrayMapping_lastMappingResult";o.utils.setDomNodeChildrenFromArrayMapping=function(r,u,e,s,h){function et(t,i){c=b[i],g!==i&&(tt[t]=c),c.indexObservable(g++),n(c.mappedNodes),k.push(c),v.push(c)}function y(n,t){if(n)for(var i=0,r=t.length;i<r;i++)t[i]&&o.utils.arrayForEach(t[i].mappedNodes,function(r){n(r,i,t[i].arrayEntry)})}var p,w,l,it,ot,a,rt;u=u||[],s=s||{};var st=o.utils.domData.get(r,t)===f,b=o.utils.domData.get(r,t)||[],ht=o.utils.arrayMap(b,function(n){return n.arrayEntry}),ct=o.utils.compareArrays(ht,u),k=[],d=0,g=0,nt=[],v=[],ut=[],tt=[],ft=[],c;for(l=0;p=ct[l];l++){w=p.moved;switch(p.status){case"deleted":w===f&&(c=b[d],c.dependentObservable&&c.dependentObservable.dispose(),nt.push.apply(nt,n(c.mappedNodes)),s.beforeRemove&&(ut[l]=c,v.push(c))),d++;break;case"retained":et(l,d++);break;case"added":w!==f?et(l,w):(c={arrayEntry:p.value,indexObservable:o.observable(g++)},k.push(c),v.push(c),st||(ft[l]=c))}}for(y(s.beforeMove,tt),o.utils.arrayForEach(nt,s.beforeRemove?o.cleanNode:o.removeNode),l=0,it=o.virtualElements.firstChild(r);c=v[l];l++){for(c.mappedNodes||o.utils.extend(c,i(r,e,c.arrayEntry,h,c.indexObservable)),rt=0;a=c.mappedNodes[rt];it=a.nextSibling,ot=a,rt++)a!==it&&o.virtualElements.insertAfter(r,a,ot);!c.initialized&&h&&(h(c.arrayEntry,c.mappedNodes,c.indexObservable),c.initialized=!0)}y(s.beforeRemove,ut),y(s.afterMove,tt),y(s.afterAdd,ft),o.utils.domData.set(r,t,k)}}(),o.exportSymbol("utils.setDomNodeChildrenFromArrayMapping",o.utils.setDomNodeChildrenFromArrayMapping),o.nativeTemplateEngine=function(){this.allowTemplateRewriting=!1},o.nativeTemplateEngine.prototype=new o.templateEngine,o.nativeTemplateEngine.prototype.renderTemplateSource=function(n){var f=!(o.utils.ieVersion<9),e=f?n.nodes:null,r=e?n.nodes():null,u;return r?o.utils.makeArray(r.cloneNode(!0).childNodes):(u=n.text(),o.utils.parseHtmlFragment(u))},o.nativeTemplateEngine.instance=new o.nativeTemplateEngine,o.setTemplateEngine(o.nativeTemplateEngine.instance),o.exportSymbol("nativeTemplateEngine",o.nativeTemplateEngine),function(){o.jqueryTmplTemplateEngine=function(){function t(){if(n<2)throw new Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");}function r(n,t,i){return u.tmpl(n,t,i)}var n=this.jQueryTmplVersion=function(){if(typeof u=="undefined"||!u.tmpl)return 0;try{if(u.tmpl.tag.tmpl.open.toString().indexOf("__")>=0)return 2}catch(n){}return 1}();this.renderTemplateSource=function(n,f,e){var o,s;e=e||{},t(),o=n.data("precompiled"),o||(s=n.text()||"",s="{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}",o=u.template(null,s),n.data("precompiled",o));var c=[f.$data],l=u.extend({koBindingContext:f},e.templateOptions),h=r(o,c,l);return h.appendTo(i.createElement("div")),u.fragments={},h},this.createJavaScriptEvaluatorBlock=function(n){return"{{ko_code ((function() { return "+n+" })()) }}"},this.addTemplate=function(n,t){i.write("<script type='text/html' id='"+n+"'>"+t+"<\/script>")},n>0&&(u.tmpl.tag.ko_code={open:"__.push($1 || '');"},u.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},o.jqueryTmplTemplateEngine.prototype=new o.templateEngine;var n=new o.jqueryTmplTemplateEngine;n.jQueryTmplVersion>0&&o.setTemplateEngine(n),o.exportSymbol("jqueryTmplTemplateEngine",o.jqueryTmplTemplateEngine)}()})})(window,document,navigator,window.jQuery)}(),function(){var n=!0;(function(t){var u=this||eval("this"),r=u.document,e=u.navigator,i=u.jQuery,f=u.JSON;(function(n){if(typeof require=="function"&&typeof exports=="object"&&typeof module=="object"){var t=module.exports||exports;n(t)}else typeof define=="function"&&define.amd?define(["exports"],n):n(u.ko={})})(function(o){function g(n){var t=this;return n&&s.utils.objectForEach(n,function(n,i){var r=s.extenders[n];typeof r=="function"&&(t=r(t,i))}),t}function nt(n){s.bindingHandlers[n]={init:function(t,i,r,u){var f=function(){var t={};return t[n]=i(),t};return s.bindingHandlers.event.init.call(this,t,f,r,u)}}}function b(n,t,i,r){s.bindingHandlers[n]={init:function(n){return s.utils.domData.set(n,w,{}),{controlsDescendantBindings:!0}},update:function(n,u,f,e,o){var h=s.utils.domData.get(n,w),a=s.utils.unwrapObservable(u()),c=!i!=!a,l=!h.savedNodes,v=l||t||c!==h.didDisplayOnLastUpdate;v&&(l&&(h.savedNodes=s.utils.cloneNodes(s.virtualElements.childNodes(n),!0)),c?(l||s.virtualElements.setDomNodeChildren(n,s.utils.cloneNodes(h.savedNodes)),s.applyBindingsToDescendants(r?r(o,a):o,n)):s.virtualElements.emptyNode(n),h.didDisplayOnLastUpdate=c)}},s.expressionRewriting.bindingRewriteValidators[n]=!1,s.virtualElements.allowedBindings[n]=!0}function d(n,t,i){i&&t!==s.selectExtensions.readValue(n)&&s.selectExtensions.writeValue(n,t),t!==s.selectExtensions.readValue(n)&&s.dependencyDetection.ignore(s.utils.triggerEvent,null,[n,"change"])}var s=typeof o!="undefined"?o:{},l,k,h,a,v,y,c,p,w;s.exportSymbol=function(n,t){for(var i=n.split("."),u=s,r=0;r<i.length-1;r++)u=u[i[r]];u[i[i.length-1]]=t},s.exportProperty=function(n,t,i){n[t]=i},s.version="2.3.0",s.exportSymbol("version",s.version),s.utils=function(){function c(n,t){if(s.utils.tagNameLower(n)!=="input"||!n.type||t.toLowerCase()!="click")return!1;var i=n.type;return i=="checkbox"||i=="radio"}var o=function(n,t){for(var i in n)n.hasOwnProperty(i)&&t(i,n[i])},h={},l={},a=e&&/Firefox\/2/i.test(e.userAgent)?"KeyboardEvent":"UIEvents";h[a]=["keyup","keydown","keypress"],h.MouseEvents=["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave"],o(h,function(n,t){if(t.length)for(var i=0,r=t.length;i<r;i++)l[t[i]]=n});var v={propertychange:!0},n=r&&function(){for(var n=3,i=r.createElement("div"),u=i.getElementsByTagName("i");i.innerHTML="<!--[if gt IE "+ ++n+"]><i><\/i><![endif]-->",u[0];);return n>4?n:t}(),y=n===6,p=n===7;return{fieldsIncludedWithJsonPost:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],arrayForEach:function(n,t){for(var i=0,r=n.length;i<r;i++)t(n[i])},arrayIndexOf:function(n,t){if(typeof Array.prototype.indexOf=="function")return Array.prototype.indexOf.call(n,t);for(var i=0,r=n.length;i<r;i++)if(n[i]===t)return i;return-1},arrayFirst:function(n,t,i){for(var r=0,u=n.length;r<u;r++)if(t.call(i,n[r]))return n[r];return null},arrayRemoveItem:function(n,t){var i=s.utils.arrayIndexOf(n,t);i>=0&&n.splice(i,1)},arrayGetDistinctValues:function(n){var i,t,r;for(n=n||[],i=[],t=0,r=n.length;t<r;t++)s.utils.arrayIndexOf(i,n[t])<0&&i.push(n[t]);return i},arrayMap:function(n,t){var r,i,u;for(n=n||[],r=[],i=0,u=n.length;i<u;i++)r.push(t(n[i]));return r},arrayFilter:function(n,t){var r,i,u;for(n=n||[],r=[],i=0,u=n.length;i<u;i++)t(n[i])&&r.push(n[i]);return r},arrayPushAll:function(n,t){if(t instanceof Array)n.push.apply(n,t);else for(var i=0,r=t.length;i<r;i++)n.push(t[i]);return n},addOrRemoveItem:function(n,t,i){var r=n.indexOf?n.indexOf(t):s.utils.arrayIndexOf(n,t);r<0?i&&n.push(t):i||n.splice(r,1)},extend:function(n,t){if(t)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},objectForEach:o,emptyDomNode:function(n){while(n.firstChild)s.removeNode(n.firstChild)},moveCleanedNodesToContainerElement:function(n){for(var i=s.utils.makeArray(n),u=r.createElement("div"),t=0,f=i.length;t<f;t++)u.appendChild(s.cleanNode(i[t]));return u},cloneNodes:function(n,t){for(var r,i=0,f=n.length,u=[];i<f;i++)r=n[i].cloneNode(!0),u.push(t?s.cleanNode(r):r);return u},setDomNodeChildren:function(n,t){if(s.utils.emptyDomNode(n),t)for(var i=0,r=t.length;i<r;i++)n.appendChild(t[i])},replaceDomNodes:function(n,t){var r=n.nodeType?[n]:n,f,e,i,u;if(r.length>0){for(f=r[0],e=f.parentNode,i=0,u=t.length;i<u;i++)e.insertBefore(t[i],f);for(i=0,u=r.length;i<u;i++)s.removeNode(r[i])}},setOptionNodeSelectionState:function(t,i){n<7?t.setAttribute("selected",i):t.selected=i},stringTrim:function(n){return n===null||n===t?"":n.trim?n.trim():n.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},stringTokenize:function(n,t){for(var u=[],f=(n||"").split(t),r,i=0,e=f.length;i<e;i++)r=s.utils.stringTrim(f[i]),r!==""&&u.push(r);return u},stringStartsWith:function(n,t){return(n=n||"",t.length>n.length)?!1:n.substring(0,t.length)===t},domNodeIsContainedBy:function(n,t){if(t.compareDocumentPosition)return(t.compareDocumentPosition(n)&16)==16;while(n!=null){if(n==t)return!0;n=n.parentNode}return!1},domNodeIsAttachedToDocument:function(n){return s.utils.domNodeIsContainedBy(n,n.ownerDocument)},anyDomNodeIsAttachedToDocument:function(n){return!!s.utils.arrayFirst(n,s.utils.domNodeIsAttachedToDocument)},tagNameLower:function(n){return n&&n.tagName&&n.tagName.toLowerCase()},registerEventHandler:function(t,r,u){var o=n&&v[r],h,f,e;if(o||typeof i=="undefined")if(o||typeof t.addEventListener!="function")if(typeof t.attachEvent!="undefined")f=function(n){u.call(t,n)},e="on"+r,t.attachEvent(e,f),s.utils.domNodeDisposal.addDisposeCallback(t,function(){t.detachEvent(e,f)});else throw new Error("Browser doesn't support addEventListener or attachEvent");else t.addEventListener(r,u,!1);else c(t,r)&&(h=u,u=function(n,t){var i=this.checked;t&&(this.checked=t.checkedStateBeforeEvent!==!0),h.call(this,n),this.checked=i}),i(t).bind(r,u)},triggerEvent:function(n,t){var f,o,e;if(!(n&&n.nodeType))throw new Error("element must be a DOM node when calling triggerEvent");if(typeof i!="undefined")f=[],c(n,t)&&f.push({checkedStateBeforeEvent:n.checked}),i(n).trigger(t,f);else if(typeof r.createEvent=="function")if(typeof n.dispatchEvent=="function")o=l[t]||"HTMLEvents",e=r.createEvent(o),e.initEvent(t,!0,!0,u,0,0,0,0,0,!1,!1,!1,!1,0,n),n.dispatchEvent(e);else throw new Error("The supplied element doesn't support dispatchEvent");else if(typeof n.fireEvent!="undefined")c(n,t)&&(n.checked=n.checked!==!0),n.fireEvent("on"+t);else throw new Error("Browser doesn't support triggering events");},unwrapObservable:function(n){return s.isObservable(n)?n():n},peekObservable:function(n){return s.isObservable(n)?n.peek():n},toggleDomNodeCssClass:function(n,t,i){if(t){var r=/\S+/g,u=n.className.match(r)||[];s.utils.arrayForEach(t.match(r),function(n){s.utils.addOrRemoveItem(u,n,i)}),n.className=u.join(" ")}},setTextContent:function(n,i){var u=s.utils.unwrapObservable(i),f;(u===null||u===t)&&(u=""),f=s.virtualElements.firstChild(n),!f||f.nodeType!=3||s.virtualElements.nextSibling(f)?s.virtualElements.setDomNodeChildren(n,[r.createTextNode(u)]):f.data=u,s.utils.forceRefresh(n)},setElementName:function(t,i){if(t.name=i,n<=7)try{t.mergeAttributes(r.createElement("<input name='"+t.name+"'/>"),!1)}catch(u){}},forceRefresh:function(t){if(n>=9){var i=t.nodeType==1?t:t.parentNode;i.style&&(i.style.zoom=i.style.zoom)}},ensureSelectElementIsRenderedCorrectly:function(t){if(n){var i=t.style.width;t.style.width=0,t.style.width=i}},range:function(n,t){var r,i;for(n=s.utils.unwrapObservable(n),t=s.utils.unwrapObservable(t),r=[],i=n;i<=t;i++)r.push(i);return r},makeArray:function(n){for(var i=[],t=0,r=n.length;t<r;t++)i.push(n[t]);return i},isIe6:y,isIe7:p,ieVersion:n,getFormFields:function(n,t){for(var r=s.utils.makeArray(n.getElementsByTagName("input")).concat(s.utils.makeArray(n.getElementsByTagName("textarea"))),f=typeof t=="string"?function(n){return n.name===t}:function(n){return t.test(n.name)},u=[],i=r.length-1;i>=0;i--)f(r[i])&&u.push(r[i]);return u},parseJson:function(n){return typeof n=="string"&&(n=s.utils.stringTrim(n),n)?f&&f.parse?f.parse(n):new Function("return "+n)():null},stringifyJson:function(n,t,i){if(!f||!f.stringify)throw new Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return f.stringify(s.utils.unwrapObservable(n),t,i)},postJson:function(n,t,i){var l,e,h,f,u,a,c;i=i||{};var v=i.params||{},y=i.includeFields||this.fieldsIncludedWithJsonPost,p=n;if(typeof n=="object"&&s.utils.tagNameLower(n)==="form")for(l=n,p=l.action,e=y.length-1;e>=0;e--)for(h=s.utils.getFormFields(l,y[e]),f=h.length-1;f>=0;f--)v[h[f].name]=h[f].value;t=s.utils.unwrapObservable(t),u=r.createElement("form"),u.style.display="none",u.action=p,u.method="post";for(a in t)c=r.createElement("input"),c.name=a,c.value=s.utils.stringifyJson(s.utils.unwrapObservable(t[a])),u.appendChild(c);o(v,function(n,t){var i=r.createElement("input");i.name=n,i.value=t,u.appendChild(i)}),r.body.appendChild(u),i.submitter?i.submitter(u):u.submit(),setTimeout(function(){u.parentNode.removeChild(u)},0)}}}(),s.exportSymbol("utils",s.utils),s.exportSymbol("utils.arrayForEach",s.utils.arrayForEach),s.exportSymbol("utils.arrayFirst",s.utils.arrayFirst),s.exportSymbol("utils.arrayFilter",s.utils.arrayFilter),s.exportSymbol("utils.arrayGetDistinctValues",s.utils.arrayGetDistinctValues),s.exportSymbol("utils.arrayIndexOf",s.utils.arrayIndexOf),s.exportSymbol("utils.arrayMap",s.utils.arrayMap),s.exportSymbol("utils.arrayPushAll",s.utils.arrayPushAll),s.exportSymbol("utils.arrayRemoveItem",s.utils.arrayRemoveItem),s.exportSymbol("utils.extend",s.utils.extend),s.exportSymbol("utils.fieldsIncludedWithJsonPost",s.utils.fieldsIncludedWithJsonPost),s.exportSymbol("utils.getFormFields",s.utils.getFormFields),s.exportSymbol("utils.peekObservable",s.utils.peekObservable),s.exportSymbol("utils.postJson",s.utils.postJson),s.exportSymbol("utils.parseJson",s.utils.parseJson),s.exportSymbol("utils.registerEventHandler",s.utils.registerEventHandler),s.exportSymbol("utils.stringifyJson",s.utils.stringifyJson),s.exportSymbol("utils.range",s.utils.range),s.exportSymbol("utils.toggleDomNodeCssClass",s.utils.toggleDomNodeCssClass),s.exportSymbol("utils.triggerEvent",s.utils.triggerEvent),s.exportSymbol("utils.unwrapObservable",s.utils.unwrapObservable),s.exportSymbol("utils.objectForEach",s.utils.objectForEach),s.exportSymbol("utils.addOrRemoveItem",s.utils.addOrRemoveItem),s.exportSymbol("unwrap",s.utils.unwrapObservable),Function.prototype.bind||(Function.prototype.bind=function(n){var i=this,t=Array.prototype.slice.call(arguments),n=t.shift();return function(){return i.apply(n,t.concat(Array.prototype.slice.call(arguments)))}}),s.utils.domData=new function(){var r=0,n="__ko__"+ +new Date,i={};return{get:function(n,i){var r=s.utils.domData.getAll(n,!1);return r===t?t:r[i]},set:function(n,i,r){if(r!==t||s.utils.domData.getAll(n,!1)!==t){var u=s.utils.domData.getAll(n,!0);u[i]=r}},getAll:function(u,f){var e=u[n],o=e&&e!=="null"&&i[e];if(!o){if(!f)return t;e=u[n]="ko"+r++,i[e]={}}return i[e]},clear:function(t){var r=t[n];return r?(delete i[r],t[n]=null,!0):!1}}},s.exportSymbol("utils.domData",s.utils.domData),s.exportSymbol("utils.domData.clear",s.utils.domData.clear),s.utils.domNodeDisposal=new function(){function r(i,r){var u=s.utils.domData.get(i,n);return u===t&&r&&(u=[],s.utils.domData.set(i,n,u)),u}function o(i){s.utils.domData.set(i,n,t)}function u(n){var t=r(n,!1),u;if(t)for(t=t.slice(0),u=0;u<t.length;u++)t[u](n);s.utils.domData.clear(n),typeof i=="function"&&typeof i.cleanData=="function"&&i.cleanData([n]),f[n.nodeType]&&h(n)}function h(n){for(var t,i=n.firstChild;t=i;)i=t.nextSibling,t.nodeType===8&&u(t)}var n="__ko_domNodeDisposal__"+ +new Date,e={1:!0,8:!0,9:!0},f={1:!0,9:!0};return{addDisposeCallback:function(n,t){if(typeof t!="function")throw new Error("Callback must be a function");r(n,!0).push(t)},removeDisposeCallback:function(n,t){var i=r(n,!1);i&&(s.utils.arrayRemoveItem(i,t),i.length==0&&o(n))},cleanNode:function(n){var t,i,r;if(e[n.nodeType]&&(u(n),f[n.nodeType]))for(t=[],s.utils.arrayPushAll(t,n.getElementsByTagName("*")),i=0,r=t.length;i<r;i++)u(t[i]);return n},removeNode:function(n){s.cleanNode(n),n.parentNode&&n.parentNode.removeChild(n)}}},s.cleanNode=s.utils.domNodeDisposal.cleanNode,s.removeNode=s.utils.domNodeDisposal.removeNode,s.exportSymbol("cleanNode",s.cleanNode),s.exportSymbol("removeNode",s.removeNode),s.exportSymbol("utils.domNodeDisposal",s.utils.domNodeDisposal),s.exportSymbol("utils.domNodeDisposal.addDisposeCallback",s.utils.domNodeDisposal.addDisposeCallback),s.exportSymbol("utils.domNodeDisposal.removeDisposeCallback",s.utils.domNodeDisposal.removeDisposeCallback),function(){function n(n){var i=s.utils.stringTrim(n).toLowerCase(),t=r.createElement("div"),f=i.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","<\/table>"]||!i.indexOf("<tr")&&[2,"<table><tbody>","<\/tbody><\/table>"]||(!i.indexOf("<td")||!i.indexOf("<th"))&&[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"]||[0,"",""],e="ignored<div>"+f[1]+n+f[2]+"<\/div>";for(typeof u.innerShiv=="function"?t.appendChild(u.innerShiv(e)):t.innerHTML=e;f[0]--;)t=t.lastChild;return s.utils.makeArray(t.lastChild.childNodes)}function f(n){var r,t;if(i.parseHTML)return i.parseHTML(n)||[];if(r=i.clean([n]),r&&r[0]){for(t=r[0];t.parentNode&&t.parentNode.nodeType!==11;)t=t.parentNode;t.parentNode&&t.parentNode.removeChild(t)}return r}var e=/^(\s*)<!--(.*?)-->/;s.utils.parseHtmlFragment=function(t){return typeof i!="undefined"?f(t):n(t)},s.utils.setHtml=function(n,r){var f,u;if(s.utils.emptyDomNode(n),r=s.utils.unwrapObservable(r),r!==null&&r!==t)if(typeof r!="string"&&(r=r.toString()),typeof i!="undefined")i(n).html(r);else for(f=s.utils.parseHtmlFragment(r),u=0;u<f.length;u++)n.appendChild(f[u])}}(),s.exportSymbol("utils.parseHtmlFragment",s.utils.parseHtmlFragment),s.exportSymbol("utils.setHtml",s.utils.setHtml),s.memoization=function(){function i(){return((1+Math.random())*4294967296|0).toString(16).substring(1)}function u(){return i()+i()}function r(n,t){var i;if(n)if(n.nodeType==8)i=s.memoization.parseMemoText(n.nodeValue),i!=null&&t.push({domNode:n,memoId:i});else if(n.nodeType==1)for(var u=0,f=n.childNodes,e=f.length;u<e;u++)r(f[u],t)}var n={};return{memoize:function(t){if(typeof t!="function")throw new Error("You can only pass a function to ko.memoization.memoize()");var i=u();return n[i]=t,"<!--[ko_memo:"+i+"]-->"},unmemoize:function(i,r){var u=n[i];if(u===t)throw new Error("Couldn't find any memo with ID "+i+". Perhaps it's already been unmemoized.");try{return u.apply(null,r||[]),!0}finally{delete n[i]}},unmemoizeDomNodeAndDescendants:function(n,t){var f=[],u,o,i,e;for(r(n,f),u=0,o=f.length;u<o;u++)i=f[u].domNode,e=[i],t&&s.utils.arrayPushAll(e,t),s.memoization.unmemoize(f[u].memoId,e),i.nodeValue="",i.parentNode&&i.parentNode.removeChild(i)},parseMemoText:function(n){var t=n.match(/^\[ko_memo\:(.*?)\]$/);return t?t[1]:null}}}(),s.exportSymbol("memoization",s.memoization),s.exportSymbol("memoization.memoize",s.memoization.memoize),s.exportSymbol("memoization.unmemoize",s.memoization.unmemoize),s.exportSymbol("memoization.parseMemoText",s.memoization.parseMemoText),s.exportSymbol("memoization.unmemoizeDomNodeAndDescendants",s.memoization.unmemoizeDomNodeAndDescendants),s.extenders={throttle:function(n,t){n.throttleEvaluation=t;var i=null;return s.dependentObservable({read:n,write:function(r){clearTimeout(i),i=setTimeout(function(){n(r)},t)}})},notify:function(n,t){return n.equalityComparer=t=="always"?function(){return!1}:s.observable.fn.equalityComparer,n}},s.exportSymbol("extenders",s.extenders),s.subscription=function(n,t,i){this.target=n,this.callback=t,this.disposeCallback=i,s.exportProperty(this,"dispose",this.dispose)},s.subscription.prototype.dispose=function(){this.isDisposed=!0,this.disposeCallback()},s.subscribable=function(){this._subscriptions={},s.utils.extend(this,s.subscribable.fn),s.exportProperty(this,"subscribe",this.subscribe),s.exportProperty(this,"extend",this.extend),s.exportProperty(this,"getSubscriptionsCount",this.getSubscriptionsCount)},l="change",s.subscribable.fn={subscribe:function(n,t,i){i=i||l;var u=t?n.bind(t):n,r=new s.subscription(this,u,function(){s.utils.arrayRemoveItem(this._subscriptions[i],r)}.bind(this));return this._subscriptions[i]||(this._subscriptions[i]=[]),this._subscriptions[i].push(r),r},notifySubscribers:function(n,t){t=t||l,this._subscriptions[t]&&s.dependencyDetection.ignore(function(){s.utils.arrayForEach(this._subscriptions[t].slice(0),function(t){t&&t.isDisposed!==!0&&t.callback(n)})},this)},getSubscriptionsCount:function(){var n=0;return s.utils.objectForEach(this._subscriptions,function(t,i){n+=i.length}),n},extend:g},s.isSubscribable=function(n){return n!=null&&typeof n.subscribe=="function"&&typeof n.notifySubscribers=="function"},s.exportSymbol("subscribable",s.subscribable),s.exportSymbol("isSubscribable",s.isSubscribable),s.dependencyDetection=function(){var n=[];return{begin:function(t){n.push({callback:t,distinctDependencies:[]})},end:function(){n.pop()},registerDependency:function(t){if(!s.isSubscribable(t))throw new Error("Only subscribable things can act as dependencies");if(n.length>0){var i=n[n.length-1];if(!i||s.utils.arrayIndexOf(i.distinctDependencies,t)>=0)return;i.distinctDependencies.push(t),i.callback(t)}},ignore:function(t,i,r){try{return n.push(null),t.apply(i,r||[])}finally{n.pop()}}}}(),k={undefined:!0,boolean:!0,number:!0,string:!0},s.observable=function(t){function i(){return arguments.length>0?(i.equalityComparer&&i.equalityComparer(r,arguments[0])||(i.valueWillMutate(),r=arguments[0],n&&(i._latestValue=r),i.valueHasMutated()),this):(s.dependencyDetection.registerDependency(i),r)}var r=t;return n&&(i._latestValue=r),s.subscribable.call(i),i.peek=function(){return r},i.valueHasMutated=function(){i.notifySubscribers(r)},i.valueWillMutate=function(){i.notifySubscribers(r,"beforeChange")},s.utils.extend(i,s.observable.fn),s.exportProperty(i,"peek",i.peek),s.exportProperty(i,"valueHasMutated",i.valueHasMutated),s.exportProperty(i,"valueWillMutate",i.valueWillMutate),i},s.observable.fn={equalityComparer:function(n,t){var i=n===null||typeof n in k;return i?n===t:!1}},h=s.observable.protoProperty="__ko_proto__",s.observable.fn[h]=s.observable,s.hasPrototype=function(n,i){return n===null||n===t||n[h]===t?!1:n[h]===i?!0:s.hasPrototype(n[h],i)},s.isObservable=function(n){return s.hasPrototype(n,s.observable)},s.isWriteableObservable=function(n){return typeof n=="function"&&n[h]===s.observable?!0:typeof n=="function"&&n[h]===s.dependentObservable&&n.hasWriteFunction?!0:!1},s.exportSymbol("observable",s.observable),s.exportSymbol("isObservable",s.isObservable),s.exportSymbol("isWriteableObservable",s.isWriteableObservable),s.observableArray=function(n){if(n=n||[],typeof n!="object"||!("length"in n))throw new Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");var t=s.observable(n);return s.utils.extend(t,s.observableArray.fn),t},s.observableArray.fn={remove:function(n){for(var r=this.peek(),i=[],f=typeof n=="function"?n:function(t){return t===n},u,t=0;t<r.length;t++)u=r[t],f(u)&&(i.length===0&&this.valueWillMutate(),i.push(u),r.splice(t,1),t--);return i.length&&this.valueHasMutated(),i},removeAll:function(n){if(n===t){var i=this.peek(),r=i.slice(0);return this.valueWillMutate(),i.splice(0,i.length),this.valueHasMutated(),r}return n?this.remove(function(t){return s.utils.arrayIndexOf(n,t)>=0}):[]},destroy:function(n){var i=this.peek(),u=typeof n=="function"?n:function(t){return t===n},t,r;for(this.valueWillMutate(),t=i.length-1;t>=0;t--)r=i[t],u(r)&&(i[t]._destroy=!0);this.valueHasMutated()},destroyAll:function(n){return n===t?this.destroy(function(){return!0}):n?this.destroy(function(t){return s.utils.arrayIndexOf(n,t)>=0}):[]},indexOf:function(n){var t=this();return s.utils.arrayIndexOf(t,n)},replace:function(n,t){var i=this.indexOf(n);i>=0&&(this.valueWillMutate(),this.peek()[i]=t,this.valueHasMutated())}},s.utils.arrayForEach(["pop","push","reverse","shift","sort","splice","unshift"],function(n){s.observableArray.fn[n]=function(){var t=this.peek(),i;return this.valueWillMutate(),i=t[n].apply(t,arguments),this.valueHasMutated(),i}}),s.utils.arrayForEach(["slice"],function(n){s.observableArray.fn[n]=function(){var t=this();return t[n].apply(t,arguments)}}),s.exportSymbol("observableArray",s.observableArray),s.dependentObservable=function(i,r,u){function nt(n){o.push(n.subscribe(tt))}function w(){s.utils.arrayForEach(o,function(n){n.dispose()}),o=[]}function tt(){var n=f.throttleEvaluation;n&&n>=0?(clearTimeout(d),d=setTimeout(a,n)):a()}function a(){var i,a,u;if(!y){if(l&&p()){c();return}y=!0;try{for(i=s.utils.arrayMap(o,function(n){return n.target}),s.dependencyDetection.begin(function(n){var r;(r=s.utils.arrayIndexOf(i,n))>=0?i[r]=t:nt(n)}),a=e.call(r),u=i.length-1;u>=0;u--)i[u]&&o.splice(u,1)[0].dispose();l=!0,f.notifySubscribers(h,"beforeChange"),h=a,n&&(f._latestValue=h),f.notifySubscribers(h)}finally{s.dependencyDetection.end(),y=!1}o.length||c()}}function f(){if(arguments.length>0){if(typeof k=="function")k.apply(r,arguments);else throw new Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return this}return l||a(),s.dependencyDetection.registerDependency(f),h}function it(){return l||a(),h}function b(){return!l||o.length>0}var h,l=!1,y=!1,e=i,g;if(e&&typeof e=="object"?(u=e,e=u.read):(u=u||{},e||(e=u.read)),typeof e!="function")throw new Error("Pass a function that returns the value of the ko.computed");var k=u.write,v=u.disposeWhenNodeIsRemoved||u.disposeWhenNodeIsRemoved||null,p=u.disposeWhen||u.disposeWhen||function(){return!1},c=w,o=[],d=null;return r||(r=u.owner),f.peek=it,f.getDependenciesCount=function(){return o.length},f.hasWriteFunction=typeof u.write=="function",f.dispose=function(){c()},f.isActive=b,s.subscribable.call(f),s.utils.extend(f,s.dependentObservable.fn),s.exportProperty(f,"peek",f.peek),s.exportProperty(f,"dispose",f.dispose),s.exportProperty(f,"isActive",f.isActive),s.exportProperty(f,"getDependenciesCount",f.getDependenciesCount),u.deferEvaluation!==!0&&a(),v&&b()&&(c=function(){s.utils.domNodeDisposal.removeDisposeCallback(v,c),w()},s.utils.domNodeDisposal.addDisposeCallback(v,c),g=p,p=function(){return!s.utils.domNodeIsAttachedToDocument(v)||g()}),f},s.isComputed=function(n){return s.hasPrototype(n,s.dependentObservable)},a=s.observable.protoProperty,s.dependentObservable[a]=s.observable,s.dependentObservable.fn={},s.dependentObservable.fn[a]=s.dependentObservable,s.exportSymbol("dependentObservable",s.dependentObservable),s.exportSymbol("computed",s.dependentObservable),s.exportSymbol("isComputed",s.isComputed),function(){function i(r,f,e){var s,o;return(e=e||new n,r=f(r),s=typeof r=="object"&&r!==null&&r!==t&&!(r instanceof Date)&&!(r instanceof String)&&!(r instanceof Number)&&!(r instanceof Boolean),!s)?r:(o=r instanceof Array?[]:{},e.save(r,o),u(r,function(n){var u=f(r[n]),s;switch(typeof u){case"boolean":case"number":case"string":case"function":o[n]=u;break;case"object":case"undefined":s=e.get(u),o[n]=s!==t?s:i(u,f,e)}}),o)}function u(n,t){var i,r;if(n instanceof Array){for(i=0;i<n.length;i++)t(i);typeof n.toJSON=="function"&&t("toJSON")}else for(r in n)t(r)}function n(){this.keys=[],this.values=[]}var r=10;s.toJS=function(n){if(arguments.length==0)throw new Error("When calling ko.toJS, pass the object you want to convert.");return i(n,function(n){for(var t=0;s.isObservable(n)&&t<r;t++)n=n();return n})},s.toJSON=function(n,t,i){var r=s.toJS(n);return s.utils.stringifyJson(r,t,i)},n.prototype={constructor:n,save:function(n,t){var i=s.utils.arrayIndexOf(this.keys,n);i>=0?this.values[i]=t:(this.keys.push(n),this.values.push(t))},get:function(n){var i=s.utils.arrayIndexOf(this.keys,n);return i>=0?this.values[i]:t}}}(),s.exportSymbol("toJS",s.toJS),s.exportSymbol("toJSON",s.toJSON),function(){var n="__ko__hasDomDataOptionValue__";s.selectExtensions={readValue:function(i){switch(s.utils.tagNameLower(i)){case"option":return i[n]===!0?s.utils.domData.get(i,s.bindingHandlers.options.optionValueDomDataKey):s.utils.ieVersion<=7?i.getAttributeNode("value")&&i.getAttributeNode("value").specified?i.value:i.text:i.value;case"select":return i.selectedIndex>=0?s.selectExtensions.readValue(i.options[i.selectedIndex]):t;default:return i.value}},writeValue:function(i,r){switch(s.utils.tagNameLower(i)){case"option":switch(typeof r){case"string":s.utils.domData.set(i,s.bindingHandlers.options.optionValueDomDataKey,t),n in i&&delete i[n],i.value=r;break;default:s.utils.domData.set(i,s.bindingHandlers.options.optionValueDomDataKey,r),i[n]=!0,i.value=typeof r=="number"?r:""}break;case"select":r===""&&(r=t),(r===null||r===t)&&(i.selectedIndex=-1);for(var u=i.options.length-1;u>=0;u--)if(s.selectExtensions.readValue(i.options[u])==r){i.selectedIndex=u;break}i.size>1||i.selectedIndex!==-1||(i.selectedIndex=0);break;default:(r===null||r===t)&&(r=""),i.value=r}}}}(),s.exportSymbol("selectExtensions",s.selectExtensions),s.exportSymbol("selectExtensions.readValue",s.selectExtensions.readValue),s.exportSymbol("selectExtensions.writeValue",s.selectExtensions.writeValue),s.expressionRewriting=function(){function n(n,i){for(var r=null;n!=r;)r=n,n=n.replace(t,function(n,t){return i[t]});return n}function u(n){if(s.utils.arrayIndexOf(i,s.utils.stringTrim(n).toLowerCase())>=0)return!1;var t=n.match(r);return t===null?!1:t[1]?"Object("+t[1]+")"+t[2]:n}function f(n){var t=s.utils.stringTrim(n);switch(t.length&&t.charAt(0)){case"'":case'"':return n;default:return"'"+t+"'"}}var t=/\@ko_token_(\d+)\@/g,i=["true","false","null","undefined"],r=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i;return{bindingRewriteValidators:[],parseObjectLiteral:function(t){var i=s.utils.stringTrim(t),e,u,o,y,a,r,f,h,c,p,b,w,k,l,v,d,g;if(i.length<3)return[];for(i.charAt(0)==="{"&&(i=i.substring(1,i.length-1)),e=[],u=null,r=0;r<i.length;r++)if(f=i.charAt(r),u===null)switch(f){case'"':case"'":case"/":u=r,o=f}else f==o&&i.charAt(r-1)!=="\\"&&(h=i.substring(u,r+1),e.push(h),c="@ko_token_"+(e.length-1)+"@",i=i.substring(0,u)+c+i.substring(r+1),r-=h.length-c.length,u=null);for(u=null,o=null,y=0,a=null,r=0;r<i.length;r++){if(f=i.charAt(r),u===null)switch(f){case"{":u=r,a=f,o="}";break;case"(":u=r,a=f,o=")";break;case"[":u=r,a=f,o="]"}f===a?y++:f===o&&(y--,y===0&&(h=i.substring(u,r+1),e.push(h),c="@ko_token_"+(e.length-1)+"@",i=i.substring(0,u)+c+i.substring(r+1),r-=h.length-c.length,u=null))}for(p=[],b=i.split(","),w=0,k=b.length;w<k;w++)l=b[w],v=l.indexOf(":"),v>0&&v<l.length-1?(d=l.substring(0,v),g=l.substring(v+1),p.push({key:n(d,e),value:n(g,e)})):p.push({unknown:n(l,e)});return p},preProcessBindings:function(n){for(var a=typeof n=="string"?s.expressionRewriting.parseObjectLiteral(n):n,t=[],r=[],i,c,e,o,l,h=0;i=a[h];h++)t.length>0&&t.push(","),i.key?(c=f(i.key),e=i.value,t.push(c),t.push(":"),t.push(e),(e=u(s.utils.stringTrim(e)))&&(r.length>0&&r.push(", "),r.push(c+" : function(__ko_value) { "+e+" = __ko_value; }"))):i.unknown&&t.push(i.unknown);return o=t.join(""),r.length>0&&(l=r.join(""),o=o+", '_ko_property_writers' : { "+l+" } "),o},keyValueArrayContainsKey:function(n,t){for(var i=0;i<n.length;i++)if(s.utils.stringTrim(n[i].key)==t)return!0;return!1},writeValueToProperty:function(n,t,i,r,u){if(n&&s.isObservable(n))s.isWriteableObservable(n)&&(!u||n.peek()!==r)&&n(r);else{var f=t()._ko_property_writers;f&&f[i]&&f[i](r)}}}}(),s.exportSymbol("expressionRewriting",s.expressionRewriting),s.exportSymbol("expressionRewriting.bindingRewriteValidators",s.expressionRewriting.bindingRewriteValidators),s.exportSymbol("expressionRewriting.parseObjectLiteral",s.expressionRewriting.parseObjectLiteral),s.exportSymbol("expressionRewriting.preProcessBindings",s.expressionRewriting.preProcessBindings),s.exportSymbol("jsonExpressionRewriting",s.expressionRewriting),s.exportSymbol("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",s.expressionRewriting.preProcessBindings),function(){function n(n){return n.nodeType==8&&(t?n.text:n.nodeValue).match(e)}function i(n){return n.nodeType==8&&(t?n.text:n.nodeValue).match(o)}function u(t,r){for(var u=t,f=1,e=[];u=u.nextSibling;){if(i(u)&&(f--,f===0))return e;e.push(u),n(u)&&f++}if(!r)throw new Error("Cannot find closing comment tag to match: "+t.nodeValue);return null}function f(n,t){var i=u(n,t);return i?i.length>0?i[i.length-1].nextSibling:n.nextSibling:null}function c(t){var r=t.firstChild,u=null,e;if(r)do u?u.push(r):n(r)?(e=f(r,!0),e?r=e:u=[r]):i(r)&&(u=[r]);while(r=r.nextSibling);return u}var t=r&&r.createComment("test").text==="<!--test-->",e=t?/^<!--\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*-->$/:/^\s*ko(?:\s+(.+\s*\:[\s\S]*))?\s*$/,o=t?/^<!--\s*\/ko\s*-->$/:/^\s*\/ko\s*$/,h={ul:!0,ol:!0};s.virtualElements={allowedBindings:{},childNodes:function(t){return n(t)?u(t):t.childNodes},emptyNode:function(t){var r,i,u;if(n(t))for(r=s.virtualElements.childNodes(t),i=0,u=r.length;i<u;i++)s.removeNode(r[i]);else s.utils.emptyDomNode(t)},setDomNodeChildren:function(t,i){var u,r,f;if(n(t))for(s.virtualElements.emptyNode(t),u=t.nextSibling,r=0,f=i.length;r<f;r++)u.parentNode.insertBefore(i[r],u);else s.utils.setDomNodeChildren(t,i)},prepend:function(t,i){n(t)?t.parentNode.insertBefore(i,t.nextSibling):t.firstChild?t.insertBefore(i,t.firstChild):t.appendChild(i)},insertAfter:function(t,i,r){r?n(t)?t.parentNode.insertBefore(i,r.nextSibling):r.nextSibling?t.insertBefore(i,r.nextSibling):t.appendChild(i):s.virtualElements.prepend(t,i)},firstChild:function(t){return n(t)?!t.nextSibling||i(t.nextSibling)?null:t.nextSibling:t.firstChild},nextSibling:function(t){return(n(t)&&(t=f(t)),t.nextSibling&&i(t.nextSibling))?null:t.nextSibling},virtualNodeBindingValue:function(t){var i=n(t);return i?i[1]:null},normaliseVirtualElementDomStructure:function(n){var t,i,u,r;if(h[s.utils.tagNameLower(n)]&&(t=n.firstChild,t))do if(t.nodeType===1&&(i=c(t),i))for(u=t.nextSibling,r=0;r<i.length;r++)u?n.insertBefore(i[r],u):n.appendChild(i[r]);while(t=t.nextSibling)}}}(),s.exportSymbol("virtualElements",s.virtualElements),s.exportSymbol("virtualElements.allowedBindings",s.virtualElements.allowedBindings),s.exportSymbol("virtualElements.emptyNode",s.virtualElements.emptyNode),s.exportSymbol("virtualElements.insertAfter",s.virtualElements.insertAfter),s.exportSymbol("virtualElements.prepend",s.virtualElements.prepend),s.exportSymbol("virtualElements.setDomNodeChildren",s.virtualElements.setDomNodeChildren),function(){function t(n,t){var r=n;return t[r]||(t[r]=i(n))}function i(n){var t=s.expressionRewriting.preProcessBindings(n),i="with($context){with($data||{}){return{"+t+"}}}";return new Function("$context","$element",i)}var n="data-bind";s.bindingProvider=function(){this.bindingCache={}},s.utils.extend(s.bindingProvider.prototype,{nodeHasBindings:function(t){switch(t.nodeType){case 1:return t.getAttribute(n)!=null;case 8:return s.virtualElements.virtualNodeBindingValue(t)!=null;default:return!1}},getBindings:function(n,t){var i=this.getBindingsString(n,t);return i?this.parseBindingsString(i,t,n):null},getBindingsString:function(t){switch(t.nodeType){case 1:return t.getAttribute(n);case 8:return s.virtualElements.virtualNodeBindingValue(t);default:return null}},parseBindingsString:function(n,i,r){try{var u=t(n,this.bindingCache);return u(i,r)}catch(f){f.message="Unable to parse bindings.\nBindings value: "+n+"\nMessage: "+f.message;throw f;}}}),s.bindingProvider.instance=new s.bindingProvider}(),s.exportSymbol("bindingProvider",s.bindingProvider),function(){function o(n){var t=s.virtualElements.allowedBindings[n];if(!t)throw new Error("The binding '"+n+"' cannot be used with virtual elements");}function r(n,t,i){for(var r,u=s.virtualElements.firstChild(t);r=u;)u=s.virtualElements.nextSibling(r),f(n,r,i)}function f(n,t,i){var f=!0,u=t.nodeType===1,o;u&&s.virtualElements.normaliseVirtualElementDomStructure(t),o=u&&i||s.bindingProvider.instance.nodeHasBindings(t),o&&(f=e(t,null,n,i).shouldBindDescendants),f&&r(n,t,!u)}function e(i,r,u,f){function l(n){return function(){return e[n]}}function a(){return e}var h=0,e,c,v=s.utils.domData.get(i,n);if(!r){if(v)throw Error("You cannot apply bindings multiple times to the same element.");s.utils.domData.set(i,n,!0)}return s.dependentObservable(function(){var n=u&&u instanceof s.bindingContext?u:new s.bindingContext(s.utils.unwrapObservable(u)),y=n.$data,p;!v&&f&&s.storedBindingContextForNode(i,n),p=typeof r=="function"?r(n,i):r,e=p||s.bindingProvider.instance.getBindings(i,n),e&&(h===0&&(h=1,s.utils.objectForEach(e,function(r){var u=s.bindingHandlers[r],e,f;if(u&&i.nodeType===8&&o(r),u&&typeof u.init=="function"&&(e=u.init,f=e(i,l(r),a,y,n),f&&f.controlsDescendantBindings)){if(c!==t)throw new Error("Multiple bindings ("+c+" and "+r+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");c=r}}),h=2),h===2&&s.utils.objectForEach(e,function(t){var r=s.bindingHandlers[t],u;r&&typeof r.update=="function"&&(u=r.update,u(i,l(t),a,y,n))}))},null,{disposeWhenNodeIsRemoved:i}),{shouldBindDescendants:c===t}}var n,i;s.bindingHandlers={},s.bindingContext=function(n,t,i){t?(s.utils.extend(this,t),this.$parentContext=t,this.$parent=t.$data,this.$parents=(t.$parents||[]).slice(0),this.$parents.unshift(this.$parent)):(this.$parents=[],this.$root=n,this.ko=s),this.$data=n,i&&(this[i]=n)},s.bindingContext.prototype.createChildContext=function(n,t){return new s.bindingContext(n,this,t)},s.bindingContext.prototype.extend=function(n){var t=s.utils.extend(new s.bindingContext,this);return s.utils.extend(t,n)},n="__ko_boundElement",i="__ko_bindingContext__",s.storedBindingContextForNode=function(n,t){if(arguments.length==2)s.utils.domData.set(n,i,t);else return s.utils.domData.get(n,i)},s.applyBindingsToNode=function(n,t,i){return n.nodeType===1&&s.virtualElements.normaliseVirtualElementDomStructure(n),e(n,t,i,!0)},s.applyBindingsToDescendants=function(n,t){(t.nodeType===1||t.nodeType===8)&&r(n,t,!0)},s.applyBindings=function(n,t){if(t&&t.nodeType!==1&&t.nodeType!==8)throw new Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||u.document.body,f(n,t,!0)},s.contextFor=function(n){switch(n.nodeType){case 1:case 8:var i=s.storedBindingContextForNode(n);if(i)return i;if(n.parentNode)return s.contextFor(n.parentNode)}return t},s.dataFor=function(n){var i=s.contextFor(n);return i?i.$data:t},s.exportSymbol("bindingHandlers",s.bindingHandlers),s.exportSymbol("applyBindings",s.applyBindings),s.exportSymbol("applyBindingsToDescendants",s.applyBindingsToDescendants),s.exportSymbol("applyBindingsToNode",s.applyBindingsToNode),s.exportSymbol("contextFor",s.contextFor),s.exportSymbol("dataFor",s.dataFor)}(),v={"class":"className","for":"htmlFor"},s.bindingHandlers.attr={update:function(n,i){var u=s.utils.unwrapObservable(i())||{};s.utils.objectForEach(u,function(i,r){r=s.utils.unwrapObservable(r);var u=r===!1||r===null||r===t;u&&n.removeAttribute(i),s.utils.ieVersion<=8&&i in v?(i=v[i],u?n.removeAttribute(i):n[i]=r):u||n.setAttribute(i,r.toString()),i==="name"&&s.utils.setElementName(n,u?"":r.toString())})}},s.bindingHandlers.checked={init:function(n,t,i){var r=function(){var u,r,f;if(n.type=="checkbox")u=n.checked;else if(n.type=="radio"&&n.checked)u=n.value;else return;r=t(),f=s.utils.unwrapObservable(r),n.type=="checkbox"&&f instanceof Array?s.utils.addOrRemoveItem(r,n.value,n.checked):s.expressionRewriting.writeValueToProperty(r,i,"checked",u,!0)};s.utils.registerEventHandler(n,"click",r),n.type!="radio"||n.name||s.bindingHandlers.uniqueName.init(n,function(){return!0})},update:function(n,t){var i=s.utils.unwrapObservable(t());n.type=="checkbox"?n.checked=i instanceof Array?s.utils.arrayIndexOf(i,n.value)>=0:i:n.type=="radio"&&(n.checked=n.value==i)}},y="__ko__cssValue",s.bindingHandlers.css={update:function(n,t){var i=s.utils.unwrapObservable(t());typeof i=="object"?s.utils.objectForEach(i,function(t,i){i=s.utils.unwrapObservable(i),s.utils.toggleDomNodeCssClass(n,t,i)}):(i=String(i||""),s.utils.toggleDomNodeCssClass(n,n[y],!1),n[y]=i,s.utils.toggleDomNodeCssClass(n,i,!0))}},s.bindingHandlers.enable={update:function(n,t){var i=s.utils.unwrapObservable(t());i&&n.disabled?n.removeAttribute("disabled"):i||n.disabled||(n.disabled=!0)}},s.bindingHandlers.disable={update:function(n,t){s.bindingHandlers.enable.update(n,function(){return!s.utils.unwrapObservable(t())})}},s.bindingHandlers.event={init:function(n,t,i,r){var u=t()||{};s.utils.objectForEach(u,function(u){typeof u=="string"&&s.utils.registerEventHandler(n,u,function(n){var e,o=t()[u],h,f,c;if(o){h=i();try{f=s.utils.makeArray(arguments),f.unshift(r),e=o.apply(r,f)}finally{e!==!0&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}c=h[u+"Bubble"]!==!1,c||(n.cancelBubble=!0,n.stopPropagation&&n.stopPropagation())}})})}},s.bindingHandlers.foreach={makeTemplateValueAccessor:function(n){return function(){var i=n(),t=s.utils.peekObservable(i);return!t||typeof t.length=="number"?{foreach:i,templateEngine:s.nativeTemplateEngine.instance}:(s.utils.unwrapObservable(i),{foreach:t.data,as:t.as,includeDestroyed:t.includeDestroyed,afterAdd:t.afterAdd,beforeRemove:t.beforeRemove,afterRender:t.afterRender,beforeMove:t.beforeMove,afterMove:t.afterMove,templateEngine:s.nativeTemplateEngine.instance})}},init:function(n,t){return s.bindingHandlers.template.init(n,s.bindingHandlers.foreach.makeTemplateValueAccessor(t))},update:function(n,t,i,r,u){return s.bindingHandlers.template.update(n,s.bindingHandlers.foreach.makeTemplateValueAccessor(t),i,r,u)}},s.expressionRewriting.bindingRewriteValidators.foreach=!1,s.virtualElements.allowedBindings.foreach=!0,c="__ko_hasfocusUpdating",p="__ko_hasfocusLastValue",s.bindingHandlers.hasfocus={init:function(n,t,i){var r=function(r){var u,f,e;if(n[c]=!0,u=n.ownerDocument,"activeElement"in u){try{f=u.activeElement}catch(o){f=u.body}r=f===n}e=t(),s.expressionRewriting.writeValueToProperty(e,i,"hasfocus",r,!0),n[p]=r,n[c]=!1},u=r.bind(null,!0),f=r.bind(null,!1);s.utils.registerEventHandler(n,"focus",u),s.utils.registerEventHandler(n,"focusin",u),s.utils.registerEventHandler(n,"blur",f),s.utils.registerEventHandler(n,"focusout",f)},update:function(n,t){var i=!!s.utils.unwrapObservable(t());n[c]||n[p]===i||(i?n.focus():n.blur(),s.dependencyDetection.ignore(s.utils.triggerEvent,null,[n,i?"focusin":"focusout"]))}},s.bindingHandlers.hasFocus=s.bindingHandlers.hasfocus,s.bindingHandlers.html={init:function(){return{controlsDescendantBindings:!0}},update:function(n,t){s.utils.setHtml(n,t())}},w="__ko_withIfBindingData",b("if"),b("ifnot",!1,!0),b("with",!0,!1,function(n,t){return n.createChildContext(t)}),s.bindingHandlers.options={init:function(n){if(s.utils.tagNameLower(n)!=="select")throw new Error("options binding applies only to SELECT elements");while(n.length>0)n.remove(0);return{controlsDescendantBindings:!0}},update:function(n,i,u){function p(n,t,i){var r=typeof t;return r=="function"?t(n):r=="string"?n[t]:i}function k(n,i,u){var e,c,a;return u.length&&(o=u[0].selected&&[s.selectExtensions.readValue(u[0])]),e=r.createElement("option"),n===l?(s.utils.setHtml(e,h),s.selectExtensions.writeValue(e,t)):(c=p(n,f.optionsValue,n),s.selectExtensions.writeValue(e,s.utils.unwrapObservable(c)),a=p(n,f.optionsText,c),s.utils.setTextContent(e,a)),[e]}function w(n,t){if(o){var i=s.utils.arrayIndexOf(o,s.selectExtensions.readValue(t[0]))>=0;s.utils.setOptionNodeSelectionState(t[0],i)}}var y=n.length==0,c=!y&&n.multiple?n.scrollTop:null,e=s.utils.unwrapObservable(i()),f=u(),b=f.optionsIncludeDestroyed,l={},h,o,a,v;n.multiple?o=s.utils.arrayMap(n.selectedOptions||s.utils.arrayFilter(n.childNodes,function(n){return n.tagName&&s.utils.tagNameLower(n)==="option"&&n.selected}),function(n){return s.selectExtensions.readValue(n)}):n.selectedIndex>=0&&(o=[s.selectExtensions.readValue(n.options[n.selectedIndex])]),e?(typeof e.length=="undefined"&&(e=[e]),a=s.utils.arrayFilter(e,function(n){return b||n===t||n===null||!s.utils.unwrapObservable(n._destroy)}),"optionsCaption"in f&&(h=s.utils.unwrapObservable(f.optionsCaption),h!==null&&h!==t&&a.unshift(l))):e=[],v=w,f.optionsAfterRender&&(v=function(n,i){w(n,i),s.dependencyDetection.ignore(f.optionsAfterRender,null,[i[0],n!==l?n:t])}),s.utils.setDomNodeChildrenFromArrayMapping(n,a,k,null,v),o=null,y&&"value"in f&&d(n,s.utils.peekObservable(f.value),!0),s.utils.ensureSelectElementIsRenderedCorrectly(n),c&&Math.abs(c-n.scrollTop)>20&&(n.scrollTop=c)}},s.bindingHandlers.options.optionValueDomDataKey="__ko.optionValueDomData__",s.bindingHandlers.selectedOptions={init:function(n,t,i){s.utils.registerEventHandler(n,"change",function(){var u=t(),r=[];s.utils.arrayForEach(n.getElementsByTagName("option"),function(n){n.selected&&r.push(s.selectExtensions.readValue(n))}),s.expressionRewriting.writeValueToProperty(u,i,"selectedOptions",r)})},update:function(n,t){if(s.utils.tagNameLower(n)!="select")throw new Error("values binding applies only to SELECT elements");var i=s.utils.unwrapObservable(t());i&&typeof i.length=="number"&&s.utils.arrayForEach(n.getElementsByTagName("option"),function(n){var t=s.utils.arrayIndexOf(i,s.selectExtensions.readValue(n))>=0;s.utils.setOptionNodeSelectionState(n,t)})}},s.bindingHandlers.style={update:function(n,t){var i=s.utils.unwrapObservable(t()||{});s.utils.objectForEach(i,function(t,i){i=s.utils.unwrapObservable(i),n.style[t]=i||""})}},s.bindingHandlers.submit={init:function(n,t,i,r){if(typeof t()!="function")throw new Error("The value for a submit binding must be a function");s.utils.registerEventHandler(n,"submit",function(i){var u,f=t();try{u=f.call(r,n)}finally{u!==!0&&(i.preventDefault?i.preventDefault():i.returnValue=!1)}})}},s.bindingHandlers.text={update:function(n,t){s.utils.setTextContent(n,t())}},s.virtualElements.allowedBindings.text=!0,s.bindingHandlers.uniqueName={init:function(n,t){if(t()){var i="ko_unique_"+ ++s.bindingHandlers.uniqueName.currentIndex;s.utils.setElementName(n,i)}}},s.bindingHandlers.uniqueName.currentIndex=0,s.bindingHandlers.value={init:function(n,t,i){var r=["change"],u=i().valueUpdate,e=!1,f,o;u&&(typeof u=="string"&&(u=[u]),s.utils.arrayPushAll(r,u),r=s.utils.arrayGetDistinctValues(r)),f=function(){e=!1;var r=t(),u=s.selectExtensions.readValue(n);s.expressionRewriting.writeValueToProperty(r,i,"value",u)},o=s.utils.ieVersion&&n.tagName.toLowerCase()=="input"&&n.type=="text"&&n.autocomplete!="off"&&(!n.form||n.form.autocomplete!="off"),o&&s.utils.arrayIndexOf(r,"propertychange")==-1&&(s.utils.registerEventHandler(n,"propertychange",function(){e=!0}),s.utils.registerEventHandler(n,"blur",function(){e&&f()})),s.utils.arrayForEach(r,function(t){var i=f;s.utils.stringStartsWith(t,"after")&&(i=function(){setTimeout(f,0)},t=t.substring("after".length)),s.utils.registerEventHandler(n,t,i)})},update:function(n,t){var u=s.utils.tagNameLower(n)==="select",i=s.utils.unwrapObservable(t()),e=s.selectExtensions.readValue(n),o=i!==e,r,f;o&&(r=function(){s.selectExtensions.writeValue(n,i)},r(),f=u,f&&setTimeout(r,0)),u&&n.length>0&&d(n,i,!1)}},s.bindingHandlers.visible={update:function(n,t){var i=s.utils.unwrapObservable(t()),r=!(n.style.display=="none");i&&!r?n.style.display="":!i&&r&&(n.style.display="none")}},nt("click"),s.templateEngine=function(){},s.templateEngine.prototype.renderTemplateSource=function(){throw new Error("Override renderTemplateSource");},s.templateEngine.prototype.createJavaScriptEvaluatorBlock=function(){throw new Error("Override createJavaScriptEvaluatorBlock");},s.templateEngine.prototype.makeTemplateSource=function(n,t){if(typeof n=="string"){t=t||r;var i=t.getElementById(n);if(!i)throw new Error("Cannot find template with ID "+n);return new s.templateSources.domElement(i)}if(n.nodeType==1||n.nodeType==8)return new s.templateSources.anonymousTemplate(n);throw new Error("Unknown template type: "+n);},s.templateEngine.prototype.renderTemplate=function(n,t,i,r){var u=this.makeTemplateSource(n,r);return this.renderTemplateSource(u,t,i)},s.templateEngine.prototype.isTemplateRewritten=function(n,t){return this.allowTemplateRewriting===!1?!0:this.makeTemplateSource(n,t).data("isRewritten")},s.templateEngine.prototype.rewriteTemplate=function(n,t,i){var r=this.makeTemplateSource(n,i),u=t(r.text());r.text(u),r.data("isRewritten",!0)},s.exportSymbol("templateEngine",s.templateEngine),s.templateRewriting=function(){function r(n){for(var f=s.expressionRewriting.bindingRewriteValidators,i,r,u,t=0;t<n.length;t++)if(i=n[t].key,f.hasOwnProperty(i))if(r=f[i],typeof r=="function"){if(u=r(n[t].value),u)throw new Error(u);}else if(!r)throw new Error("This template engine does not support the '"+i+"' binding within its templates");}function n(n,t,i,u){var f=s.expressionRewriting.parseObjectLiteral(n),e,o;return r(f),e=s.expressionRewriting.preProcessBindings(f),o="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+e+" } })()},'"+i.toLowerCase()+"')",u.createJavaScriptEvaluatorBlock(o)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,i=/<!--\s*ko\b\s*([\s\S]*?)\s*-->/g;return{ensureTemplateIsRewritten:function(n,t,i){t.isTemplateRewritten(n,i)||t.rewriteTemplate(n,function(n){return s.templateRewriting.memoizeBindingAttributeSyntax(n,t)},i)},memoizeBindingAttributeSyntax:function(r,u){return r.replace(t,function(){return n(arguments[4],arguments[1],arguments[2],u)}).replace(i,function(){return n(arguments[1],"<!-- ko -->","#comment",u)})},applyMemoizedBindingsToNextSibling:function(n,t){return s.memoization.memoize(function(i,r){var u=i.nextSibling;u&&u.nodeName.toLowerCase()===t&&s.applyBindingsToNode(u,n,r)})}}}(),s.exportSymbol("__tr_ambtns",s.templateRewriting.applyMemoizedBindingsToNextSibling),function(){s.templateSources={},s.templateSources.domElement=function(n){this.domElement=n},s.templateSources.domElement.prototype.text=function(){var i=s.utils.tagNameLower(this.domElement),n=i==="script"?"text":i==="textarea"?"value":"innerHTML",t;if(arguments.length==0)return this.domElement[n];t=arguments[0],n==="innerHTML"?s.utils.setHtml(this.domElement,t):this.domElement[n]=t},s.templateSources.domElement.prototype.data=function(n){if(arguments.length===1)return s.utils.domData.get(this.domElement,"templateSourceData_"+n);s.utils.domData.set(this.domElement,"templateSourceData_"+n,arguments[1])};var n="__ko_anon_template__";s.templateSources.anonymousTemplate=function(n){this.domElement=n},s.templateSources.anonymousTemplate.prototype=new s.templateSources.domElement,s.templateSources.anonymousTemplate.prototype.constructor=s.templateSources.anonymousTemplate,s.templateSources.anonymousTemplate.prototype.text=function(){var i,r;if(arguments.length==0)return i=s.utils.domData.get(this.domElement,n)||{},i.textData===t&&i.containerData&&(i.textData=i.containerData.innerHTML),i.textData;r=arguments[0],s.utils.domData.set(this.domElement,n,{textData:r})},s.templateSources.domElement.prototype.nodes=function(){var t,i;if(arguments.length==0)return t=s.utils.domData.get(this.domElement,n)||{},t.containerData;i=arguments[0],s.utils.domData.set(this.domElement,n,{containerData:i})},s.exportSymbol("templateSources",s.templateSources),s.exportSymbol("templateSources.domElement",s.templateSources.domElement),s.exportSymbol("templateSources.anonymousTemplate",s.templateSources.anonymousTemplate)}(),function(){function u(n,t,i){for(var r,u=n,f=s.virtualElements.nextSibling(t);u&&(r=u)!==f;)u=s.virtualElements.nextSibling(r),(r.nodeType===1||r.nodeType===8)&&i(r)}function f(n,t){if(n.length){var i=n[0],r=n[n.length-1];u(i,r,function(n){s.applyBindings(t,n)}),u(i,r,function(n){s.memoization.unmemoizeDomNodeAndDescendants(n,[t])})}}function i(n){return n.nodeType?n:n.length>0?n[0]:null}function e(t,r,u,e,o){var h,c;o=o||{};var l=t&&i(t),a=l&&l.ownerDocument,v=o.templateEngine||n;if(s.templateRewriting.ensureTemplateIsRewritten(u,v,a),h=v.renderTemplate(u,e,o,a),typeof h.length!="number"||h.length>0&&typeof h[0].nodeType!="number")throw new Error("Template engine must return an array of DOM nodes");c=!1;switch(r){case"replaceChildren":s.virtualElements.setDomNodeChildren(t,h),c=!0;break;case"replaceNode":s.utils.replaceDomNodes(t,h),c=!0;break;case"ignoreTargetNode":break;default:throw new Error("Unknown renderMode: "+r);}return c&&(f(h,e),o.afterRender&&s.dependencyDetection.ignore(o.afterRender,null,[h,e.$data])),h}function o(n,i){var u=s.utils.domData.get(n,r);u&&typeof u.dispose=="function"&&u.dispose(),s.utils.domData.set(n,r,i&&i.isActive()?i:t)}var n,r;s.setTemplateEngine=function(i){if(i!=t&&!(i instanceof s.templateEngine))throw new Error("templateEngine must inherit from ko.templateEngine");n=i},s.renderTemplate=function(r,u,f,o,h){if(f=f||{},(f.templateEngine||n)==t)throw new Error("Set a template engine before calling renderTemplate");if(h=h||"replaceChildren",o){var c=i(o),l=function(){return!c||!s.utils.domNodeIsAttachedToDocument(c)},a=c&&h=="replaceNode"?c.parentNode:c;return s.dependentObservable(function(){var n=u&&u instanceof s.bindingContext?u:new s.bindingContext(s.utils.unwrapObservable(u)),t=typeof r=="function"?r(n.$data,n):r,l=e(o,h,t,n,f);h=="replaceNode"&&(o=l,c=i(o))},null,{disposeWhen:l,disposeWhenNodeIsRemoved:a})}return s.memoization.memoize(function(n){s.renderTemplate(r,u,f,n,"replaceNode")})},s.renderTemplateForEach=function(n,i,r,u,o){var h,c=function(t,i){h=o.createChildContext(s.utils.unwrapObservable(t),r.as),h.$index=i;var u=typeof n=="function"?n(t,h):n;return e(null,"ignoreTargetNode",u,h,r)},l=function(n,t){f(t,h),r.afterRender&&r.afterRender(t,n)};return s.dependentObservable(function(){var n=s.utils.unwrapObservable(i)||[],f;typeof n.length=="undefined"&&(n=[n]),f=s.utils.arrayFilter(n,function(n){return r.includeDestroyed||n===t||n===null||!s.utils.unwrapObservable(n._destroy)}),s.dependencyDetection.ignore(s.utils.setDomNodeChildrenFromArrayMapping,null,[u,f,c,r,l])},null,{disposeWhenNodeIsRemoved:u})},r="__ko__templateComputedDomDataKey__",s.bindingHandlers.template={init:function(n,t){var i=s.utils.unwrapObservable(t()),r,u;return typeof i=="string"||i.name||n.nodeType!=1&&n.nodeType!=8||(r=n.nodeType==1?n.childNodes:s.virtualElements.childNodes(n),u=s.utils.moveCleanedNodesToContainerElement(r),new s.templateSources.anonymousTemplate(n).nodes(u)),{controlsDescendantBindings:!0}},update:function(n,t,i,r,u){var e=s.utils.unwrapObservable(t()),f={},h=!0,l,c=null,a,v;typeof e!="string"&&(f=e,e=s.utils.unwrapObservable(f.name),"if"in f&&(h=s.utils.unwrapObservable(f["if"])),h&&"ifnot"in f&&(h=!s.utils.unwrapObservable(f.ifnot)),l=s.utils.unwrapObservable(f.data)),"foreach"in f?(a=h&&f.foreach||[],c=s.renderTemplateForEach(e||n,a,f,n,u)):h?(v="data"in f?u.createChildContext(l,f.as):u,c=s.renderTemplate(e||n,v,f,n)):s.virtualElements.emptyNode(n),o(n,c)}},s.expressionRewriting.bindingRewriteValidators.template=function(n){var t=s.expressionRewriting.parseObjectLiteral(n);return t.length==1&&t[0].unknown?null:s.expressionRewriting.keyValueArrayContainsKey(t,"name")?null:"This template engine does not support anonymous templates nested within its templates"},s.virtualElements.allowedBindings.template=!0}(),s.exportSymbol("setTemplateEngine",s.setTemplateEngine),s.exportSymbol("renderTemplate",s.renderTemplate),s.utils.compareArrays=function(){function r(r,u,f){return r=r||[],u=u||[],r.length<=u.length?i(r,u,n,t,f):i(u,r,t,n,f)}function i(n,t,i,r,u){for(var nt=Math.min,ot=Math.max,l=[],c=n.length,f,a=t.length,st=a-c||1,tt=c+a+1,o,b,it,rt,ut,ft,et,y,g,h,p,w,e=0;e<=c;e++)for(b=o,l.push(o=[]),it=nt(a,e+st),rt=ot(0,e-1),f=rt;f<=it;f++)f?e?n[e-1]===t[f-1]?o[f]=b[f-1]:(ut=b[f]||tt,ft=o[f-1]||tt,o[f]=nt(ut,ft)+1):o[f]=f+1:o[f]=e+1;var s=[],k,d=[],v=[];for(e=c,f=a;e||f;)k=l[e][f]-1,f&&k===l[e][f-1]?d.push(s[s.length]={status:i,value:t[--f],index:f}):e&&k===l[e-1][f]?v.push(s[s.length]={status:r,value:n[--e],index:e}):(s.push({status:"retained",value:t[--f]}),--e);if(d.length&&v.length)for(et=c*10,y=g=0;(u||y<et)&&(p=d[g]);g++){for(h=0;w=v[h];h++)if(p.value===w.value){p.moved=w.index,w.moved=p.index,v.splice(h,1),y=h=0;break}y+=h}return s.reverse()}var n="added",t="deleted";return r}(),s.exportSymbol("utils.compareArrays",s.utils.compareArrays),function(){function n(n){while(n.length&&!s.utils.domNodeIsAttachedToDocument(n[0]))n.splice(0,1);if(n.length>1){for(var t=n[0],r=n[n.length-1],i=[t];t!==r;){if(t=t.nextSibling,!t)return;i.push(t)}Array.prototype.splice.apply(n,[0,n.length].concat(i))}return n}function r(i,r,u,f,e){var o=[],h=s.dependentObservable(function(){var t=r(u,e,n(o))||[];o.length>0&&(s.utils.replaceDomNodes(o,t),f&&s.dependencyDetection.ignore(f,null,[u,t,e])),o.splice(0,o.length),s.utils.arrayPushAll(o,t)},null,{disposeWhenNodeIsRemoved:i,disposeWhen:function(){return!s.utils.anyDomNodeIsAttachedToDocument(o)}});return{mappedNodes:o,dependentObservable:h.isActive()?h:t}}var i="setDomNodeChildrenFromArrayMapping_lastMappingResult";s.utils.setDomNodeChildrenFromArrayMapping=function(u,f,e,o,h){function et(t,i){c=b[i],g!==i&&(tt[t]=c),c.indexObservable(g++),n(c.mappedNodes),k.push(c),v.push(c)}function y(n,t){if(n)for(var i=0,r=t.length;i<r;i++)t[i]&&s.utils.arrayForEach(t[i].mappedNodes,function(r){n(r,i,t[i].arrayEntry)})}var p,w,l,it,ot,a,rt;f=f||[],o=o||{};var st=s.utils.domData.get(u,i)===t,b=s.utils.domData.get(u,i)||[],ht=s.utils.arrayMap(b,function(n){return n.arrayEntry}),ct=s.utils.compareArrays(ht,f,o.dontLimitMoves),k=[],d=0,g=0,nt=[],v=[],ut=[],tt=[],ft=[],c;for(l=0;p=ct[l];l++){w=p.moved;switch(p.status){case"deleted":w===t&&(c=b[d],c.dependentObservable&&c.dependentObservable.dispose(),nt.push.apply(nt,n(c.mappedNodes)),o.beforeRemove&&(ut[l]=c,v.push(c))),d++;break;case"retained":et(l,d++);break;case"added":w!==t?et(l,w):(c={arrayEntry:p.value,indexObservable:s.observable(g++)},k.push(c),v.push(c),st||(ft[l]=c))}}for(y(o.beforeMove,tt),s.utils.arrayForEach(nt,o.beforeRemove?s.cleanNode:s.removeNode),l=0,it=s.virtualElements.firstChild(u);c=v[l];l++){for(c.mappedNodes||s.utils.extend(c,r(u,e,c.arrayEntry,h,c.indexObservable)),rt=0;a=c.mappedNodes[rt];it=a.nextSibling,ot=a,rt++)a!==it&&s.virtualElements.insertAfter(u,a,ot);!c.initialized&&h&&(h(c.arrayEntry,c.mappedNodes,c.indexObservable),c.initialized=!0)}y(o.beforeRemove,ut),y(o.afterMove,tt),y(o.afterAdd,ft),s.utils.domData.set(u,i,k)}}(),s.exportSymbol("utils.setDomNodeChildrenFromArrayMapping",s.utils.setDomNodeChildrenFromArrayMapping),s.nativeTemplateEngine=function(){this.allowTemplateRewriting=!1},s.nativeTemplateEngine.prototype=new s.templateEngine,s.nativeTemplateEngine.prototype.constructor=s.nativeTemplateEngine,s.nativeTemplateEngine.prototype.renderTemplateSource=function(n){var f=!(s.utils.ieVersion<9),e=f?n.nodes:null,r=e?n.nodes():null,u;return r?s.utils.makeArray(r.cloneNode(!0).childNodes):(u=n.text(),s.utils.parseHtmlFragment(u))},s.nativeTemplateEngine.instance=new s.nativeTemplateEngine,s.setTemplateEngine(s.nativeTemplateEngine.instance),s.exportSymbol("nativeTemplateEngine",s.nativeTemplateEngine),function(){s.jqueryTmplTemplateEngine=function(){function t(){if(n<2)throw new Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");}function u(n,t,r){return i.tmpl(n,t,r)}var n=this.jQueryTmplVersion=function(){if(typeof i=="undefined"||!i.tmpl)return 0;try{if(i.tmpl.tag.tmpl.open.toString().indexOf("__")>=0)return 2}catch(n){}return 1}();this.renderTemplateSource=function(n,f,e){var o,s;e=e||{},t(),o=n.data("precompiled"),o||(s=n.text()||"",s="{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}",o=i.template(null,s),n.data("precompiled",o));var c=[f.$data],l=i.extend({koBindingContext:f},e.templateOptions),h=u(o,c,l);return h.appendTo(r.createElement("div")),i.fragments={},h},this.createJavaScriptEvaluatorBlock=function(n){return"{{ko_code ((function() { return "+n+" })()) }}"},this.addTemplate=function(n,t){r.write("<script type='text/html' id='"+n+"'>"+t+"<\/script>")},n>0&&(i.tmpl.tag.ko_code={open:"__.push($1 || '');"},i.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},s.jqueryTmplTemplateEngine.prototype=new s.templateEngine,s.jqueryTmplTemplateEngine.prototype.constructor=s.jqueryTmplTemplateEngine;var n=new s.jqueryTmplTemplateEngine;n.jQueryTmplVersion>0&&s.setTemplateEngine(n),s.exportSymbol("jqueryTmplTemplateEngine",s.jqueryTmplTemplateEngine)}()})})()}(),function(n){n(["jquery"],function(n){return function(){function h(n){e&&e(n)}function u(r){function l(){if(!(n(":focus",e).length>0))return e.fadeOut(u.fadeOut,function(){c(e),u.onFadeOut&&u.onFadeOut(),s.state="hidden",s.endTime=new Date,h(s)})}function w(){(u.timeOut>0||u.extendedTimeOut>0)&&(v=setTimeout(l,u.extendedTimeOut))}function b(){clearTimeout(v),e.stop(!0,!0).fadeIn(u.fadeIn)}var u=i(),a=r.iconClass||u.iconClass;typeof r.optionsOverride!="undefined"&&(u=n.extend(u,r.optionsOverride),a=r.optionsOverride.iconClass||a),o++,t=f(u);var v=null,e=n("<div/>"),y=n("<div/>"),p=n("<div/>"),s={toastId:o,state:"visible",startTime:new Date,options:u,map:r};return r.iconClass&&e.addClass(u.toastClass).addClass(a),r.title&&(y.append(r.title).addClass(u.titleClass),e.append(y)),r.message&&(p.append(r.message).addClass(u.messageClass),e.append(p)),e.hide(),u.newestOnTop?t.prepend(e):t.append(e),e.fadeIn(u.fadeIn,u.onFadeIn),u.timeOut>0&&(v=setTimeout(l,u.timeOut)),e.hover(b,w),!u.onclick&&u.tapToDismiss&&e.click(l),u.onclick&&e.click(function(){u.onclick()&&l()}),h(s),u.debug&&console&&console.log(s),e}function f(r){return(r||(r=i()),t=n("#"+r.containerId),t.length)?t:(t=n("<div/>").attr("id",r.containerId).addClass(r.positionClass),t.appendTo(n(r.target)),t)}function i(){return n.extend({},a,s.options)}function c(n){(t||(t=f()),n.is(":visible"))||(n.remove(),n=null,t.children().length===0&&t.remove())}var l="1.3.1",t,r={error:"error",info:"info",success:"success",warning:"warning"},e,o=0,a={tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,fadeIn:300,onFadeIn:undefined,fadeOut:1e3,onFadeOut:undefined,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",target:"body",newestOnTop:!0},v=function(n,t,f){return u({type:r.error,iconClass:i().iconClasses.error,message:n,optionsOverride:f,title:t})},y=function(n,t,f){return u({type:r.info,iconClass:i().iconClasses.info,message:n,optionsOverride:f,title:t})},p=function(n){e=n},w=function(n,t,f){return u({type:r.success,iconClass:i().iconClasses.success,message:n,optionsOverride:f,title:t})},b=function(n,t,f){return u({type:r.warning,iconClass:i().iconClasses.warning,message:n,optionsOverride:f,title:t})},k=function(r){var u=i();if(t||f(u),r&&n(":focus",r).length===0){r.fadeOut(u.fadeOut,function(){c(r)});return}t.children().length&&t.fadeOut(u.fadeOut,function(){t.remove()})},s={clear:k,error:v,getContainer:f,info:y,options:{},subscribe:p,success:w,version:l,warning:b};return s}()})}(typeof define=="function"&&define.amd?define:function(n,t){typeof module!="undefined"&&module.exports?module.exports=t(require(n[0])):window.toastr=t(window.jQuery)}),!function(n){if("function"==typeof bootstrap)bootstrap("promise",n);else if("object"==typeof exports)module.exports=n();else if("function"==typeof define&&define.amd)define(n);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=n}else Q=n()}(function(){"use strict";function h(n){var t=Function.call;return function(){return t.apply(n,arguments)}}function ct(n){return n===Object(n)}function ii(n){return"[object StopIteration]"===wr(n)||n instanceof ut}function lt(n,t){var r,i,u;if(k&&t.stack&&"object"==typeof n&&null!==n&&n.stack&&-1===n.stack.indexOf(st)){for(r=[],i=t;i;i=i.source)i.stack&&r.unshift(i.stack);r.unshift(n.stack),u=r.join("\n"+st+"\n"),n.stack=ri(u)}}function ri(n){for(var t,r=n.split("\n"),u=[],i=0;i<r.length;++i)t=r[i],fi(t)||ui(t)||!t||u.push(t);return u.join("\n")}function ui(n){return-1!==n.indexOf("(module.js:")||-1!==n.indexOf("(node.js:")}function at(n){var r=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(n),t,i;return r?[r[1],Number(r[2])]:(t=/at ([^ ]+):(\d+):(?:\d+)$/.exec(n),t)?[t[1],Number(t[2])]:(i=/.*@(.+):(\d+)$/.exec(n),i?[i[1],Number(i[2])]:void 0)}function fi(n){var t=at(n),r,i;return t?(r=t[0],i=t[1],r===gt&&i>=ar&&ti>=i):!1}function vt(){if(k)try{throw new Error;}catch(r){var n=r.stack.split("\n"),i=n[0].indexOf("@")>0?n[1]:n[2],t=at(i);return t?(gt=t[0],t[1]):void 0}}function g(n,t,i){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+i+" instead.",new Error("").stack),n.apply(n,arguments)}}function n(n){return c(n)}function i(){function a(n){t=n,s.source=n,p(l,function(t,i){f(function(){n.promiseDispatch.apply(n,i)})},void 0),l=void 0,v=void 0}var t,l=[],v=[],h=et(i.prototype),s=et(u.prototype);if(s.promiseDispatch=function(n,i,u){var e=r(arguments);l?(l.push(e),"when"===i&&u[1]&&v.push(u[1])):f(function(){t.promiseDispatch.apply(t,e)})},s.valueOf=g(function(){if(l)return s;var n=yt(t);return o(n)&&(t=n),n},"valueOf","inspect"),s.inspect=function(){return t?t.inspect():{state:"pending"}},n.longStackSupport&&k)try{throw new Error;}catch(y){s.stack=y.stack.substring(y.stack.indexOf("\n")+1)}return h.promise=s,h.resolve=function(n){t||a(c(n))},h.fulfill=function(n){t||a(tt(n))},h.reject=function(n){t||a(e(n))},h.notify=function(n){t||p(v,function(t,i){f(function(){i(n)})},void 0)},h}function ei(n){if("function"!=typeof n)throw new TypeError("resolver must be a function.");var t=i();return rt(n,t.resolve,t.reject,t.notify).fail(t.reject),t.promise}function u(n,t,i){var r,f;return void 0===t&&(t=function(n){return e(new Error("Promise does not support operation: "+n))}),void 0===i&&(i=function(){return{state:"unknown"}}),r=et(u.prototype),(r.promiseDispatch=function(i,u,f){var o;try{o=n[u]?n[u].apply(r,f):t.call(r,u,f)}catch(s){o=e(s)}i&&i(o)},r.inspect=i,i)&&(f=i(),"rejected"===f.state&&(r.exception=f.reason),r.valueOf=g(function(){var n=i();return"pending"===n.state||"rejected"===n.state?r:n.value})),r}function yt(n){if(o(n)){var t=n.inspect();if("fulfilled"===t.state)return t.value}return n}function o(n){return ct(n)&&"function"==typeof n.promiseDispatch&&"function"==typeof n.inspect}function pt(n){return ct(n)&&"function"==typeof n.then}function oi(n){return o(n)&&"pending"===n.inspect().state}function si(n){return!o(n)||"fulfilled"===n.inspect().state}function hi(n){return o(n)&&"rejected"===n.inspect().state}function ci(){ht||"undefined"==typeof window||window.Touch||!window.console||console.warn("[Q] Unhandled rejection reasons (should be empty):",s),ht=!0}function wt(){for(var n,t=0;t<s.length;t++)n=s[t],n&&"undefined"!=typeof n.stack?console.warn("Unhandled rejection reason:",n.stack):console.warn("Unhandled rejection reason (no stack):",n)}function nt(){s.length=0,d.length=0,ht=!1,w||(w=!0,"undefined"!=typeof process&&process.on&&process.on("exit",wt))}function li(n,t){w&&(d.push(n),s.push(t),ci())}function ai(n){if(w){var t=vr(d,n);-1!==t&&(d.splice(t,1),s.splice(t,1))}}function e(n){var t=u({when:function(t){return t&&ai(this),t?t(n):this}},function(){return this},function(){return{state:"rejected",reason:n}});return li(t,n),t}function tt(n){return u({when:function(){return n},get:function(t){return n[t]},set:function(t,i){n[t]=i},"delete":function(t){delete n[t]},post:function(t,i){return null===t||void 0===t?n.apply(void 0,i):n[t].apply(n,i)},apply:function(t,i){return n.apply(t,i)},keys:function(){return pr(n)}},void 0,function(){return{state:"fulfilled",value:n}})}function c(n){return o(n)?n:pt(n)?vi(n):tt(n)}function vi(n){var t=i();return f(function(){try{n.then(t.resolve,t.reject,t.notify)}catch(i){t.reject(i)}}),t.promise}function yi(n){return u({isDef:function(){}},function(t,i){return v(n,t,i)},function(){return c(n).inspect()})}function t(t,i,r,u){return n(t).then(i,r,u)}function bt(n,i,r){return t(n,function(n){return y(n).then(function(n){return i.apply(void 0,n)},r)},r)}function pi(n){return function(){function i(n,i){var o;if(ot){try{o=u[n](i)}catch(s){return e(s)}return o.done?o.value:t(o.value,r,f)}try{o=u[n](i)}catch(s){return ii(s)?s.value:e(s)}return t(o,r,f)}var u=n.apply(this,arguments),r=i.bind(i,"send"),f=i.bind(i,"throw");return r()}}function wi(t){n.done(n.async(t)())}function bi(n){throw new ut(n);}function ki(n){return function(){return bt([this,y(arguments)],function(t,i){return n.apply(t,i)})}}function v(n,t,r){var u=i();return f(function(){c(n).promiseDispatch(u.resolve,t,r)}),u.promise}function l(n){return function(t){var i=r(arguments,1);return v(t,n,i)}}function it(n,t){var i=r(arguments,2);return b(n,t,i)}function a(n,t){return v(n,"apply",[void 0,t])}function rt(n){var t=r(arguments,1);return a(n,t)}function di(n){var t=r(arguments,1);return function(){var i=t.concat(r(arguments));return v(n,"apply",[this,i])}}function y(n){return t(n,function(n){var u=0,r=i();return p(n,function(i,f,e){var s;o(f)&&"fulfilled"===(s=f.inspect()).state?n[e]=s.value:(++u,t(f,function(t){n[e]=t,0==--u&&r.resolve(n)},r.reject))},void 0),0===u&&r.resolve(n),r.promise})}function gi(n){return t(n,function(n){return n=ft(n,c),t(y(ft(n,function(n){return t(n,ni,ni)})),function(){return n})})}function nr(n){return t(n,function(n){return y(ft(n,function(i,r){return t(i,function(t){return n[r]={state:"fulfilled",value:t},n[r]},function(t){return n[r]={state:"rejected",reason:t},n[r]})})).thenResolve(n)})}function kt(n,i){return t(n,void 0,i)}function tr(n,i){return t(n,void 0,void 0,i)}function ir(n,i){return t(n,function(n){return t(i(),function(){return n})},function(n){return t(i(),function(){return e(n)})})}function rr(i,r,u,e){var o=function(t){f(function(){if(lt(t,i),!n.onerror)throw t;n.onerror(t)})},s=r||u||e?t(i,r,u,e):i;"object"==typeof process&&process&&process.domain&&(o=process.domain.bind(o)),kt(s,o)}function ur(n,r,u){var f=i(),e=setTimeout(function(){f.reject(new Error(u||"Timed out after "+r+" ms"))},r);return t(n,function(n){clearTimeout(e),f.resolve(n)},function(n){clearTimeout(e),f.reject(n)},f.notify),f.promise}function fr(n,r){void 0===r&&(r=n,n=void 0);var u=i();return t(n,void 0,void 0,u.notify),setTimeout(function(){u.resolve(n)},r),u.promise}function er(n,t){var f=r(t),u=i();return f.push(u.makeNodeResolver()),a(n,f).fail(u.reject),u.promise}function or(n){var u=r(arguments,1),t=i();return u.push(t.makeNodeResolver()),a(n,u).fail(t.reject),t.promise}function sr(n){var t=r(arguments,1);return function(){var f=t.concat(r(arguments)),u=i();return f.push(u.makeNodeResolver()),a(n,f).fail(u.reject),u.promise}}function hr(n,t){var u=r(arguments,2);return function(){function o(){return n.apply(t,arguments)}var e=u.concat(r(arguments)),f=i();return e.push(f.makeNodeResolver()),a(o,e).fail(f.reject),f.promise}}function dt(n,t,u){var e=r(u||[]),f=i();return e.push(f.makeNodeResolver()),b(n,t,e).fail(f.reject),f.promise}function cr(n,t){var f=r(arguments,2),u=i();return f.push(u.makeNodeResolver()),b(n,t,f).fail(u.reject),u.promise}function lr(n,t){return t?(n.then(function(n){f(function(){t(null,n)})},function(n){f(function(){t(n)})}),void 0):n}var k=!1,ot,st,b,ti;try{throw new Error;}catch(br){k=!!br.stack}var gt,ut,ar=vt(),ni=function(){},f=function(){function t(){for(var f,i;n.next;){n=n.next,f=n.task,n.task=void 0,i=n.domain,i&&(n.domain=void 0,i.enter());try{f()}catch(e){if(u)throw i&&i.exit(),setTimeout(t,0),i&&i.enter(),e;setTimeout(function(){throw e;},0)}i&&i.exit()}r=!1}var n={task:void 0,next:null},o=n,r=!1,i=void 0,u=!1,e;return(f=function(n){o=o.next={task:n,domain:u&&process.domain,next:null},r||(r=!0,i())},"undefined"!=typeof process&&process.nextTick)?(u=!0,i=function(){process.nextTick(t)}):"function"==typeof setImmediate?i="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)}:"undefined"!=typeof MessageChannel?(e=new MessageChannel,e.port1.onmessage=t,i=function(){e.port2.postMessage(0)}):i=function(){setTimeout(t,0)},f}(),r=h(Array.prototype.slice),p=h(Array.prototype.reduce||function(n,t){var i=0,r=this.length;if(1===arguments.length)for(;;){if(i in this){t=this[i++];break}if(++i>=r)throw new TypeError;}for(;r>i;i++)i in this&&(t=n(t,this[i],i));return t}),vr=h(Array.prototype.indexOf||function(n){for(var t=0;t<this.length;t++)if(this[t]===n)return t;return-1}),ft=h(Array.prototype.map||function(n,t){var i=this,r=[];return p(i,function(u,f,e){r.push(n.call(t,f,e,i))},void 0),r}),et=Object.create||function(n){function t(){}return t.prototype=n,new t},yr=h(Object.prototype.hasOwnProperty),pr=Object.keys||function(n){var i=[],t;for(t in n)yr(n,t)&&i.push(t);return i},wr=h(Object.prototype.toString);ut="undefined"!=typeof ReturnValue?ReturnValue:function(n){this.value=n};try{new Function("(function* (){ yield 1; })"),ot=!0}catch(br){ot=!1}st="From previous event:",n.nextTick=f,n.longStackSupport=!1,n.defer=i,i.prototype.makeNodeResolver=function(){var n=this;return function(t,i){t?n.reject(t):arguments.length>2?n.resolve(r(arguments,1)):n.resolve(i)}},n.promise=ei,n.makePromise=u,u.prototype.then=function(t,r,u){function c(n){try{return"function"==typeof t?t(n):n}catch(i){return e(i)}}function l(n){if("function"==typeof r){lt(n,h);try{return r(n)}catch(t){return e(t)}}return e(n)}function a(n){return"function"==typeof u?u(n):n}var h=this,o=i(),s=!1;return f(function(){h.promiseDispatch(function(n){s||(s=!0,o.resolve(c(n)))},"when",[function(n){s||(s=!0,o.resolve(l(n)))}])}),h.promiseDispatch(void 0,"when",[void 0,function(t){var i,r=!1;try{i=a(t)}catch(u){if(r=!0,!n.onerror)throw u;n.onerror(u)}r||o.notify(i)}]),o.promise},u.prototype.thenResolve=function(n){return t(this,function(){return n})},u.prototype.thenReject=function(n){return t(this,function(){throw n;})},p(["isFulfilled","isRejected","isPending","dispatch","when","spread","get","set","del","delete","post","send","mapply","invoke","mcall","keys","fapply","fcall","fbind","all","allResolved","timeout","delay","catch","finally","fail","fin","progress","done","nfcall","nfapply","nfbind","denodeify","nbind","npost","nsend","nmapply","ninvoke","nmcall","nodeify"],function(t,i){u.prototype[i]=function(){return n[i].apply(n,[this].concat(r(arguments)))}},void 0),u.prototype.toSource=function(){return this.toString()},u.prototype.toString=function(){return"[object Promise]"},n.nearer=yt,n.isPromise=o,n.isPromiseAlike=pt,n.isPending=oi,n.isFulfilled=si,n.isRejected=hi;var s=[],d=[],ht=!1,w=!0;return n.resetUnhandledRejections=nt,n.getUnhandledReasons=function(){return s.slice()},n.stopUnhandledRejectionTracking=function(){nt(),"undefined"!=typeof process&&process.on&&process.removeListener("exit",wt),w=!1},nt(),n.reject=e,n.fulfill=tt,n.resolve=c,n.master=yi,n.when=t,n.spread=bt,n.async=pi,n.spawn=wi,n["return"]=bi,n.promised=ki,n.dispatch=v,n.dispatcher=l,n.get=l("get"),n.set=l("set"),n["delete"]=n.del=l("delete"),b=n.post=l("post"),n.mapply=b,n.send=it,n.invoke=it,n.mcall=it,n.fapply=a,n["try"]=rt,n.fcall=rt,n.fbind=di,n.keys=l("keys"),n.all=y,n.allResolved=g(gi,"allResolved","allSettled"),n.allSettled=nr,n["catch"]=n.fail=kt,n.progress=tr,n["finally"]=n.fin=ir,n.done=rr,n.timeout=ur,n.delay=fr,n.nfapply=er,n.nfcall=or,n.nfbind=sr,n.denodeify=n.nfbind,n.nbind=hr,n.npost=dt,n.nmapply=dt,n.nsend=cr,n.ninvoke=n.nsend,n.nmcall=n.nsend,n.nodeify=lr,ti=vt(),n}),function(n){typeof exports=="object"?module.exports=n():typeof define=="function"?define(n):breeze=n()}(function(){function d(n,t){for(var i in n)ht(n,i)&&t(i,n[i])}function vr(n,t){var i,r;for(i in n)if(ht(n,i)&&(r=n[i],t(i,r)))return{key:i,value:r};return null}function rr(n,t){var u=[],i,r;for(i in n)ht(n,i)&&(r=t?t(i,n[i]):n[i],r!==undefined&&u.push(r));return u}function ai(n,t){return function(i){return i[n]===t}}function yt(n){return function(t){return t[n]}}function yr(n){var i=[],t;for(t in n)ht(n,t)&&i.push(n[t]);return i}function ut(n,t){if(!t)return n;for(var i in t)ht(t,i)&&(n[i]=t[i]);return n}function vi(n,t){for(var i in t)n[i]===undefined&&(n[i]=t[i]);return n}function ri(n,t){return t.defaultInstance=vi(new t(n),t.defaultInstance),n}function pt(n,t){var f={},r,i,u;for(r in t)r in n&&(i=n[r],u=t[r],i!=u)&&(Array.isArray(i)&&i.length===0||(typeof u=="function"?i=u(i):typeof i=="object"&&i&&i.parentEnum&&(i=i.name),i!==undefined)&&(f[r]=i));return f}function pr(n,t){var i={},r=n.length;return t.forEach(function(t){for(var f,e,u=0;u<r;u++)if(f=n[u],f&&(e=f[t],e!==undefined)){i[t]=e;break}}),i}function w(n){return n?Array.isArray(n)?n:[n]:[]}function b(n,t){for(var i=0,r=n.length;i<r;i++)if(t(n[i]))return n[i];return null}function ur(n,t){for(var i=0,r=n.length;i<r;i++)if(t(n[i]))return i;return-1}function fr(n,t){for(var r=wi(t)?t:undefined,u=n.length,i=0;i<u;i++)if(r?r(n[i]):n[i]===t)return n.splice(i,1),i;return-1}function yi(n,t,i){for(var u=[],f=Math.min(n.length,t.length),r=0;r<f;++r)u.push(i(n[r],t[r]));return u}function er(n,t,i){if(!n||!t||n.length!==t.length)return!1;for(var r=0;r<n.length;r++)if(Array.isArray(n[r])){if(!er(n[r],t[r]))return!1}else if(i){if(!i(n[r],t[r]))return!1}else if(n[r]!==t[r])return!1;return!0}function pi(n,t){var i=n[t];return i||(i=[],n[t]=i),i}function wr(n,t){for(var u=n.split(";"),r,i=0,f=u.length;i<f;i++)if(r=fu(u[i]),r)return r;throw new Error("Unable to initialize "+n+".  "+t||"");}function fu(n){var t=window[n];return t?t:(window.require&&(t=window.require(n)),t)?t:null}function ui(n,t,i,r){var u=n[t];if(i===u)return r();n[t]=i;try{return r()}finally{u===undefined?delete n[t]:n[t]=u}}function br(n,t,i){var r;try{return r=n(),i()}catch(u){typeof r=="object"&&(r.error=u);throw u;}finally{t(r)}}function kr(n){return function(){for(var r=c(arguments),i="",u=r.length,t=null;u--;)t=r[u],i+=t===Object(t)?JSON.stringify(t):t,n.memoize||(n.memoize={});return i in n.memoize?n.memoize[i]:n.memoize[i]=n.apply(this,r)}}function fi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})}function dr(n){var r,t,i;if(typeof n!="string")throw new Error("Invalid ISO8601 duration '"+n+"'");if(r=/^P((\d+Y)?(\d+M)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(n),!r)throw new Error("Invalid ISO8601 duration '"+n+"'");var f=[2,3,4,6,7,8],e=[31104e3,2592e3,86400,3600,60,1],u=0;for(t=0;t<6;t++)i=r[f[t]],i=i?+i.replace(/[A-Za-z]+/g,""):0,u+=i*e[t];return u}function gr(n){return n===null?"null":n===undefined?"undefined":Object.prototype.toString.call(n).slice(8,-1).toLowerCase()}function ct(n){return gr(n)==="date"&&!isNaN(n.getTime())}function wi(n){return gr(n)==="function"}function bi(n){return typeof n=="string"&&/[a-fA-F\d]{8}-(?:[a-fA-F\d]{4}-){3}[a-fA-F\d]{12}/.test(n)}function ki(n){return typeof n=="string"&&/^(-|)?P([0-9]+Y|)?([0-9]+M|)?([0-9]+D|)?T?([0-9]+H|)?([0-9]+M|)?([0-9]+S|)?/.test(n)}function ei(n){if(n===null||n===undefined)return!0;for(var t in n)if(ht(n,t))return!1;return!0}function eu(n){return!isNaN(parseFloat(n))&&isFinite(n)}function lt(n,t){return!n||!t?!1:n.indexOf(t,0)===0}function or(n,t){return!n||!t?!1:n.indexOf(t,n.length-t.length)!==-1}function a(n){var t=arguments,i=RegExp("%([1-"+(arguments.length-1)+"])","g");return n.replace(i,function(n,i){return t[i]})}function nu(n){var t=Function.call;return function(){return t.apply(n,arguments)}}function su(n,t,i){var f,c,y,nt,r,st,ht,ct,w,h,rt,l,s,lt,p,b,ut,ft,at,et,vt,yt,tt;if(t===undefined&&(t=null),f=i(),c=n.dataType,c&&c.parse&&(t=c.parse(t,typeof t)),t!==f&&(!c||!c.isDate||!t||!f||t.valueOf()!==f.valueOf())){var ot=this,d=n.name,g,e=this.entityAspect,v;if(e?(v=e,g=d):(v=this.complexAspect,e=v.entityAspect,g=v.parent?v.propertyPath+"."+d:d),y=e._inProcess,y){if(y.indexOf(n)>=0)return;y.push(n)}else y=[n],e._inProcess=y;nt=e.entity;try{if(r=e.entityManager,e.entityState.isUnchangedOrModified()&&v.originalValues[d]===undefined&&n.isDataProperty&&!n.isComplexProperty&&(v.originalValues[d]=f!==undefined?f:n.defaultValue),n.isComplexProperty)if(n.isScalar){if(!t)throw new Error(a("You cannot set the '%1' property to null because it's datatype is the ComplexType: '%2'",n.name,n.dataType.name));f||(st=c.getCtor(),f=new st,i(f)),c.dataProperties.forEach(function(n){var i=n.name,r=t.getProperty(i);f.setProperty(i,r)})}else throw new Error(a("You cannot set a non-scalar complex property: '%1'",n.name));else if(n.isDataProperty){if(n.isPartOfKey&&!this.complexAspect&&r&&!r.isLoading){var pt=this.entityType.keyProperties,wt=pt.map(function(i){return i==n?t:this.getProperty(i.name)},this),it=new o(this.entityType,wt);if(r.findEntityByKey(it))throw new Error("An entity with this key is already in the cache: "+it.toString());ht=this.entityAspect.getKey(),ct=r._findEntityGroup(this.entityType),ct._replaceKey(ht,it)}w=n.relatedNavigationProperty,w&&r?t!=null?(l=new o(w.entityType,[t]),s=r.findEntityByKey(l),s?this.setProperty(w.name,s):r._unattachedChildrenMap.addChild(l,w,this)):this.setProperty(w.name,null):n.inverseNavigationProperty&&r&&!r._inKeyFixup&&(h=n.inverseNavigationProperty,f!=null&&(l=new o(h.parentType,[f]),s=r.findEntityByKey(l),s&&(h.isScalar?s.setProperty(h.name,null):(rt=s.getProperty(h.name),rt.splice(rt.indexOf(this),1)))),t!=null&&(l=new o(h.parentType,[t]),s=r.findEntityByKey(l),s?h.isScalar?s.setProperty(h.name,this):s.getProperty(h.name).push(this):r._unattachedChildrenMap.addChild(l,h,this))),i(t),r&&!r.isLoading&&(e.entityState.isUnchanged()&&!n.isUnmapped&&e.setModified(),r.validationOptions.validateOnPropertyChange&&e._validateProperty(t,{entity:nt,property:n,propertyName:g,oldValue:f})),n.isPartOfKey&&!this.complexAspect&&(lt=this.entityType.keyProperties.indexOf(n),this.entityType.navigationProperties.forEach(function(n){var u=n.inverse,f=u?u.foreignKeyNames:n.invForeignKeyNames,i,r;if(f.length!==0)if(i=ot.getProperty(n.name),r=f[lt],n.isScalar){if(!i)return;i.setProperty(r,t)}else i.forEach(function(n){n.setProperty(r,t)})}),e.getKey(!0))}else{if(!n.isScalar)throw new Error("Nonscalar navigation properties are readonly - entities can be added or removed but the collection may not be changed.");if(p=n.inverse,t!=null)if(b=t.entityAspect,r){if(b.entityState.isDetached())r.isLoading||r.attachEntity(t,u.Added);else if(b.entityManager!==r)throw new Error("An Entity cannot be attached to an entity in another EntityManager. One of the two entities must be detached first.");}else b&&b.entityManager&&(r=b.entityManager,r.isLoading||r.attachEntity(e.entity,u.Added));p?p.isScalar?(f!=null&&f.setProperty(p.name,null),t!=null&&t.setProperty(p.name,this)):(f!=null&&(ut=f.getProperty(p.name),ft=ut.indexOf(this),ft!==-1&&ut.splice(ft,1)),t!=null&&(at=t.getProperty(p.name),at.push(this))):n.invForeignKeyNames&&r&&!r._inKeyFixup&&(et=n.invForeignKeyNames,t!=null?(vt=this.entityAspect.getKey().values,et.forEach(function(n,i){t.setProperty(n,vt[i])})):f!=null&&et.forEach(function(n){var i=f.entityType.getProperty(n);i.isPartOfKey||f.setProperty(n,null)})),i(t),r&&!r.isLoading&&(e.entityState.isUnchanged()&&!n.isUnmapped&&e.setModified(),r.validationOptions.validateOnPropertyChange&&e._validateProperty(t,{entity:this,property:n,propertyName:g,oldValue:f})),n.relatedDataProperties&&(e.entityState.isDeleted()||(yt=n.entityType.keyProperties,yt.forEach(function(i,r){var u=n.relatedDataProperties[r],f;(t||!u.isPartOfKey)&&(f=t?t.getProperty(i.name):u.defaultValue,ot.setProperty(u.name,f))})))}tt={entity:nt,property:n,propertyName:g,oldValue:f,newValue:t},r?r.isLoading||r.isRejectingChanges||(e.propertyChanged.publish(tt),r.entityChanged.publish({entityAction:k.PropertyChange,entity:nt,args:tt})):e.propertyChanged.publish(tt)}finally{y.pop()}}}function iu(n){return n.indexOf(":#")>=0}function hi(n,t){return n+":#"+t}function sr(n,t,i){var r,u,f;if(t)if(Array.isArray(t))t.forEach(n.addProperty.bind(n));else if(typeof t=="object")for(r in t)ht(t,r)&&(u=t[r],u.name=r,f=new i(u),n.addProperty(f));else throw new Error("The 'dataProperties' or 'navigationProperties' values must be either an array of data/nav properties or an object where each property defines a data/nav property");}function tr(n,t){var i,r,u;if(i=Array.isArray(t)?t:t.split("."),i.length===1)return n.getProperty(t);for(r=n,u=0;u<i.length;u++)if(r=r.getProperty(i[u]),r==null)break;return r}function ru(n){return n&&n.isDate?function(n){return n&&n.getTime()}:n===i.Time?function(n){return n&&dr(n)}:function(n){return n}}var t={version:"1.3.5",metadataVersion:"1.0.5"},ht,c,r,ft,tt,l,wt,f,bt,kt,k,ot,oi,o,u,h,si,i,hr,gt,ni,uu,ar,vt,ir;t.entityModel=t,t.entityTracking_backingStore="backingStore",t.entityTracking_ko="ko",t.entityTracking_backbone="backbone",t.remoteAccess_odata="odata",t.remoteAccess_webApi="webApi",ht=nu(Object.prototype.hasOwnProperty),c=nu(Array.prototype.slice),Object.create||(Object.create=function(n){var t=function(){};return t.prototype=n,new t}),r={},r.objectForEach=d,r.extend=ut,r.propEq=ai,r.pluck=yt,r.arrayEquals=er,r.arrayFirst=b,r.arrayIndexOf=ur,r.arrayRemoveItem=fr,r.arrayZip=yi,r.requireLib=wr,r.using=ui,r.memoize=kr,r.getUuid=fi,r.durationToSeconds=dr,r.isDate=ct,r.isGuid=bi,r.isDuration=ki,r.isFunction=wi,r.isEmpty=ei,r.isNumeric=eu,r.stringStartsWith=lt,r.stringEndsWith=or,r.formatString=a,r.parent=t,t.core=r;var di=function(){function f(n,t){return t==null?!1:typeof t=="string"&&t.length>0}function e(n,t){return t==null?!1:typeof t===n.typeName?!0:!1}function o(n,t){return t==null?!1:t instanceof n.type}function s(n,t){return t==null?!1:t[n.propertyName]!==undefined}function h(n,t){return t==null?!1:n.enumType.contains(t)}function c(n,t){return n.allowNull?t!==undefined:t!=null}function l(n,t){if(t==null)return!0;var i=n.prevContext;return i?i.fn(i,t):!0}function v(n,t){var r=n.prevContext,u=r?" or it "+i(r,t):"";return"is optional"+u}function y(n,t){if(!Array.isArray(t)||n.mustNotBeEmpty&&t.length===0)return!1;var i=n.prevContext;return i?t.every(function(n){return i.fn(i,n)}):!0}function p(n,t){var u=n.mustNotBeEmpty?"a nonEmpty array":"an array",r=n.prevContext,f=r?" where each element "+i(r,t):"";return" must be "+u+f}function i(n,t){var i=n.msg;return typeof i=="function"&&(i=i(n,t)),i}function t(n,t){if(n._context){for(var i=n._context;i.prevContext!=null;)i=i.prevContext;if(i.prevContext===null)return i.prevContext=t,n;if(t.prevContext===null)t.prevContext=n._context;else throw new Error("Illegal construction - use 'or' to combine checks");}return w(n,t)}function w(n,t){return n._contexts[n._contexts.length-1]=t,n._context=t,n}function b(n){var t=n._contexts;return(t[t.length-1]==null&&t.pop(),t.length===0)?undefined:t.some(function(t){return t.fn(t,n.v)})}function u(n,t){throw new Error(a("Error configuring an instance of '%1'. %2",n&&n._$typeName||"object",t));}var r=function(n,t){this.v=n,this.name=t,this._contexts=[null]},n=r.prototype;return n.isObject=function(){return this.isTypeOf("object")},n.isBoolean=function(){return this.isTypeOf("boolean")},n.isString=function(){return this.isTypeOf("string")},n.isNonEmptyString=function(){return t(this,{fn:f,msg:"must be a nonEmpty string"})},n.isNumber=function(){return this.isTypeOf("number")},n.isFunction=function(){return this.isTypeOf("function")},n.isTypeOf=function(n){return t(this,{fn:e,typeName:n,msg:a("must be a '%1'",n)})},n.isInstanceOf=function(n,i){return i=i||n.prototype._$typeName,t(this,{fn:o,type:n,typeName:i,msg:a("must be an instance of '%1'",i)})},n.hasProperty=function(n){return t(this,{fn:s,propertyName:n,msg:a("must have a '%1' property ",n)})},n.isEnumOf=function(n){return t(this,{fn:h,enumType:n,msg:a("must be an instance of the '%1' enumeration",n.name)})},n.isRequired=function(n){return t(this,{fn:c,allowNull:n,msg:"is required"})},n.isOptional=function(){var n={fn:l,prevContext:null,msg:v};return t(this,n)},n.isNonEmptyArray=function(){return this.isArray(!0)},n.isArray=function(n){var i={fn:y,mustNotBeEmpty:n,prevContext:null,msg:p};return t(this,i)},n.or=function(){return this._contexts.push(null),this._context=null,this},n.check=function(n){var t=b(this);if(t!==undefined){if(!t)throw new Error(this.getMessage());return this.v!==undefined?this.v:n}},n._addContext=function(n){return t(this,n)},n.getMessage=function(){var n=this,t=this._contexts.map(function(t){return i(t,n.v)}).join(", or it ");return a(this.MESSAGE_PREFIX,this.name)+" "+t},n.withDefault=function(n){return this.defaultValue=n,this},n.whereParam=function(n){return this.parent.whereParam(n)},n.applyAll=function(n,t,i){var e=n._$typeName,r,f;if(i=i||e&&this.parent.config._$typeName===e,r=ut({},this.parent.config),this.parent.params.forEach(function(f){i||delete r[f.name];try{f.check()}catch(e){u(n,e.message)}t||f._applyOne(n)}),!i)for(f in r)r[f]!==undefined&&u(n,a("Unknown property: '%1'.",f))},n._applyOne=function(n){this.v!==undefined?n[this.name]=this.v:this.defaultValue!==undefined&&(n[this.name]=this.defaultValue)},n.MESSAGE_PREFIX="The '%1' parameter ",r}(),n=function(n,t){return new di(n,t)},ou=function(){var n=function(n){if(typeof n!="object")throw new Error("Configuration parameter should be an object, instead it is a: "+typeof n);this.config=n,this.params=[]},t=n.prototype;return t.whereParam=function(n){var t=new di(this.config[n],n);return t.parent=this,this.params.push(t),t},n}(),v=function(n){return new ou(n)};r.Param=di,r.assertParam=n,r.assertConfig=v,ft=function(){function t(){}var i=function(n,i){this.name=n;var r=new t(i);r.parentEnum=this,this._symbolPrototype=r,i&&Object.keys(i).forEach(function(n){r[n]=i[n]})},n=i.prototype;return i.isSymbol=function(n){return n instanceof t},n.fromName=function(n){return this[n]},n.addSymbol=function(n){var t=Object.create(this._symbolPrototype);return n&&Object.keys(n).forEach(function(i){t[i]=n[i]}),setTimeout(function(){t.getName()},0),t},n.seal=function(){this.getSymbols().forEach(function(n){return n.getName()})},n.getSymbols=function(){return this.getNames().map(function(n){return this[n]},this)},n.getNames=function(){var t=[],n;for(n in this)this.hasOwnProperty(n)&&(n=="name"||n.substr(0,1)==="_"||wi(this[n])||t.push(n));return t},n.contains=function(n){return n instanceof t?this[n.getName()]===n:!1},t.prototype.getName=function(){if(!this.name){var n=this;this.name=b(this.parentEnum.getNames(),function(t){return n.parentEnum[t]===n})}return this.name},t.prototype.toString=function(){return this.getName()},t.prototype.toJSON=function(){return{_$typeName:this.parentEnum.name,name:this.name}},i}(),r.Enum=ft,tt=function(){function f(n,t,i){var r=n._subscribers;if(!r)return!0;r.forEach(function(r){try{r.callback(t)}catch(u){u.context="unable to publish on topic: "+n.name,i?i(u):n._defaultErrorCallback?n._defaultErrorCallback(u):o(u)}})}function e(n){if(r[n])return n;var t=b(Object.keys(r),function(t){return t.indexOf(n)===0});if(!t)throw new Error("Unable to find any registered event that matches: "+n);return t}function o(){}var r={},u=1,t=function(t,i,u){n(t,"eventName").isNonEmptyString().check(),n(i,"publisher").isObject().check(),this.name=t,r[t]=!0,this.publisher=i,u&&(this._defaultErrorCallback=u)},i=t.prototype;return i.publish=function(n,i,r){return t._isEnabled(this.name,this.publisher)?(i===!0?setTimeout(f,0,this,n,r):f(this,n,r),!0):!1},i.publishAsync=function(n,t){this.publish(n,!0,t)},i.subscribe=function(n){this._subscribers||(this._subscribers=[]);var t=u;return this._subscribers.push({unsubKey:t,callback:n}),++u,t},i.unsubscribe=function(n){if(!this._subscribers)return!1;var t=this._subscribers,i=ur(t,function(t){return t.unsubKey===n});return i!==-1?(t.splice(i,1),t.length===0&&(this._subscribers=null),!0):!1},i.clear=function(){this._subscribers=null},t.bubbleEvent=function(n,t){n._getEventParent=t},t.enable=function(t,i,r){n(t,"eventName").isNonEmptyString().check(),n(i,"obj").isObject().check(),n(r,"isEnabled").isBoolean().isOptional().or().isFunction().check(),t=e(t),i._$eventMap||(i._$eventMap={}),i._$eventMap[t]=r},t._enableFast=function(n,t,i){t._$eventMap||(t._$eventMap={}),t._$eventMap[n.name]=i},t.isEnabled=function(i,r){if(n(i,"eventName").isNonEmptyString().check(),n(r,"obj").isObject().check(),!r._getEventParent)throw new Error("This object does not support event enabling/disabling");return t._isEnabled(r,e(i))},t._isEnabled=function(n,i){var r=null,f=i._$eventMap,u;return f&&(r=f[n]),r!=null?typeof r=="function"?r(i):!!r:(u=i._getEventParent&&i._getEventParent(),u?t._isEnabled(n,u):!0)},t}(),r.Event=tt,l=function(){function u(n,i,r){var u=i.defaultInstance;return u||(u=new i.ctor,i.defaultInstance=u,u._$impl=i),u.initialize(),r&&(n.defaultInstance=u),t.interfaceInitialized.publish({interfaceName:n.name,instance:u,isDefault:!0}),u.checkForRecomposition&&t.interfaceInitialized.subscribe(function(n){u.checkForRecomposition(n)}),u}function r(n){var r=n.toLowerCase(),i=vr(t.interfaceRegistry||{},function(n){return n.toLowerCase()===r});if(!i)throw new Error("Unknown interface name: "+n);return i.value}var t={},i;return t.functionRegistry={},t.typeRegistry={},t.objectRegistry={},t.interfaceInitialized=new tt("interfaceInitialized_config",t),i=function(n){this.name=n,this.defaultInstance=null,this._implMap={}},i.prototype.registerCtor=function(n,t){this._implMap[n.toLowerCase()]={ctor:t,defaultInstance:null}},i.prototype.getImpl=function(n){return this._implMap[n.toLowerCase()]},i.prototype.getFirstImpl=function(){var n=vr(this._implMap,function(){return!0});return n?n.value:null},t.interfaceRegistry={ajax:new i("ajax"),modelLibrary:new i("modelLibrary"),dataService:new i("dataService")},t.interfaceRegistry.modelLibrary.getDefaultInstance=function(){if(!this.defaultInstance)throw new Error("Unable to locate the default implementation of the '"+this.name+"' interface.  Possible options are 'ko', 'backingStore' or 'backbone'. See the breeze.config.initializeAdapterInstances method.");return this.defaultInstance},t.setProperties=function(n){v(n).whereParam("remoteAccessImplementation").isOptional().whereParam("trackingImplementation").isOptional().whereParam("ajaxImplementation").isOptional().applyAll(n),n.remoteAccessImplementation&&t.initializeAdapterInstance("dataService",n.remoteAccessImplementation),n.trackingImplementation&&t.initializeAdapterInstance("modelLibrary",n.trackingImplementation),n.ajaxImplementation&&t.initializeAdapterInstance("ajax",n.ajaxImplementation)},t.registerAdapter=function(t,i){var f,u,e;if(n(t,"interfaceName").isNonEmptyString().check(),n(i,"adapterCtor").isFunction().check(),f=new i,u=f.name,!u)throw new Error("Unable to locate a 'name' property on the constructor passed into the 'registerAdapter' call.");e=r(t),e.registerCtor(u,i)},t.getAdapter=function(n,t){var i=r(n),u;return t?(u=i.getImpl(t),u?u.ctor:null):i.defaultInstance?i.defaultInstance._$impl.ctor:null},t.initializeAdapterInstances=function(n){return v(n).whereParam("dataService").isOptional().whereParam("modelLibrary").isOptional().whereParam("ajax").isOptional().applyAll(this,!1),rr(n,t.initializeAdapterInstance)},t.initializeAdapterInstance=function(t,i,f){f=f===undefined?!0:f,n(t,"interfaceName").isNonEmptyString().check(),n(i,"adapterName").isNonEmptyString().check(),n(f,"isDefault").isBoolean().check();var e=r(t),o=e.getImpl(i);if(!o)throw new Error("Unregistered adapter.  Interface: "+t+" AdapterName: "+i);return u(e,o,f)},t.getAdapterInstance=function(n,t){var f=r(n),i;return t&&t!==""?(i=f.getImpl(t),i?i.defaultInstance:null):f.defaultInstance?f.defaultInstance:(i=f.getFirstImpl(),i.defaultInstance?i.defaultInstance:u(f,i,!0))},t.registerFunction=function(i,r){n(i,"fn").isFunction().check(),n(r,"fnName").isString().check(),i.prototype._$fnName=r,t.functionRegistry[r]=i},t._storeObject=function(n,i,r){var u=(typeof i=="string"?i:i.prototype._$typeName)+"."+r;t.objectRegistry[u]=n},t._fetchObject=function(n,i){if(!i)return undefined;var r=(typeof n=="string"?n:n.prototype._$typeName)+"."+i,u=t.objectRegistry[r];if(!u)throw new Error("Unable to locate a registered object by the name: "+r);return u},t.registerType=function(i,r){n(i,"ctor").isFunction().check(),n(r,"typeName").isString().check(),i.prototype._$typeName=r,t.typeRegistry[r]=i},t.stringifyPad="  ",t}(),wt=l.interfaceRegistry.modelLibrary,r.config=l,t.config=l,f=function(){function c(n,t,i){return t?n.replace(/%([^%]+)%/g,function(n,r){var u;return u=i?t.hasOwnProperty(r)?t[r]:"":t[r],u?wi(u)?u(t):u:""}):n}function i(t,i,r,u){return n.messageTemplates[t]=a("'%displayName%' must be an integer between the values of %1 and %2",i,r),function(){var f=function(n,t){return n==null?!0:(typeof n=="string"&&t&&t.allowString&&(n=parseInt(n,0)),typeof n!="number"||isNaN(n)||Math.floor(n)!==n?!1:i!=null&&n<i?!1:r!=null&&n>r?!1:!0)};return new n(t,f,u)}}var r=-32768,u=32767,f=-2147483648,e=2147483647,o=0,s=255,h={displayName:function(n){return n.property?n.property.displayName||n.propertyName||n.property.name:"Value"}},n=function(t,i,r){this._baseContext=r||{},this._baseContext.name=t,r=ut(Object.create(h),this._baseContext),r.messageTemplate=r.messageTemplate||n.messageTemplates[t],this.name=t,this.valFn=i,this.context=r},t=n.prototype;return t._$typeName="Validator",t.validate=function(n,t){var i;return(i=t?ut(Object.create(this.context),t):this.context,this.currentContext=i,!this.valFn(n,i))?(i.value=n,new bt(this,i,this.getMessage())):null},t.getMessage=function(){try{var n=this.currentContext,t=n.message;return t?typeof t=="function"?t(n):t:n.messageTemplate?c(n.messageTemplate,n):"invalid value: "+this.name||"{unnamed validator}"}catch(i){return"Unable to format error message"+i.toString()}},t.toJSON=function(){return this._baseContext},n.fromJSON=function(n){var i="Validator."+n.name,t=l.functionRegistry[i];if(!t)throw new Error("Unable to locate a validator named:"+n.name);return t(n)},n.register=function(n){l.registerFunction(function(){return n},"Validator."+n.name)},n.registerFactory=function(n,t){l.registerFunction(n,"Validator."+t)},n.messageTemplates={required:"'%displayName%' is required",date:"'%displayName%' must be a date",string:"'%displayName%' must be a string",bool:"'%displayName%' must be a 'true' or 'false' value",guid:"'%displayName%' must be a GUID",duration:"'%displayName%' must be a ISO8601 duration string, such as 'P3H24M60S'",number:"'%displayName%' must be a number",integer:"'%displayName%' must be an integer",integerRange:"'%displayName%' must be an integer between the values of %minValue% and %maxValue%",maxLength:"'%displayName%' must be a string with less than %maxLength% characters",stringLength:"'%displayName%' must be a string with between %minLength% and %maxLength% characters"},n.required=function(){var t=function(n,t){return typeof n=="string"?t&&t.allowEmptyStrings?!0:n.length>0:n!=null};return new n("required",t)},n.maxLength=function(t){var i=function(n,t){return n==null?!0:typeof n!="string"?!1:n.length<=t.maxLength};return new n("maxLength",i,t)},n.stringLength=function(t){var i=function(n,t){return n==null?!0:typeof n!="string"?!1:t.minLength!=null&&n.length<t.minLength?!1:t.maxLength!=null&&n.length>t.maxLength?!1:!0};return new n("stringLength",i,t)},n.string=function(){var t=function(n){return n==null?!0:typeof n=="string"};return new n("string",t)},n.guid=function(){var t=function(n){return n==null?!0:bi(n)};return new n("guid",t)},n.duration=function(){var t=function(n){return n==null?!0:ki(n)};return new n("duration",t)},n.number=n.double=n.single=function(t){var i=function(n,t){return n==null?!0:(typeof n=="string"&&t&&t.allowString&&(n=parseInt(n,10)),typeof n=="number"&&!isNaN(n))};return new n("number",i,t)},n.integer=n.int64=function(t){var i=function(n,t){return n==null?!0:(typeof n=="string"&&t&&t.allowString&&(n=parseInt(n,10)),typeof n=="number"&&!isNaN(n)&&Math.floor(n)===n)};return new n("integer",i,t)},n.int32=function(n){return i("int32",f,e,n)()},n.int16=function(n){return i("int16",r,u,n)()},n.byte=function(n){return i("byte",o,s,n)()},n.bool=function(){var t=function(n){return n==null?!0:n===!0||n===!1};return new n("bool",t)},n.none=function(){var t=function(){return!0};return new n("none",t)},n.date=function(){var t=function(n){if(n==null)return!0;if(typeof n=="string")try{return!isNaN(Date.parse(n))}catch(t){return!1}else return ct(n)};return new n("date",t)},d(n,function(n,t){typeof t=="function"&&n!=="fromJSON"&&n!=="register"&&n!=="registerFactory"&&l.registerFunction(t,"Validator."+n)}),n}(),bt=function(){var t=function(t,i,r){n(t,"validator").isString().or().isInstanceOf(f).check(),this.validator=t,i=i||{},this.context=i,this.property=i.property,this.property&&(this.propertyName=i.propertyName||i.property.name),this.errorMessage=r,this.key=bt.getKey(t,this.propertyName)};return t.getKey=function(n,t){return(t||"")+":"+n.name},t}(),t.Validator=f,t.ValidationError=bt,kt=function(){function i(n,t){return t&&v(t).whereParam("validateOnAttach").isBoolean().isOptional().whereParam("validateOnSave").isBoolean().isOptional().whereParam("validateOnQuery").isBoolean().isOptional().whereParam("validateOnPropertyChange").isBoolean().isOptional().applyAll(n),n}var n=function(n){i(this,n)},t=n.prototype;return t._$typeName="ValidationOptions",t.using=function(n){if(!n)return this;var t=new kt(this);return i(t,n),t},t.setAsDefault=function(){return ri(this,n)},n.defaultInstance=new n({validateOnAttach:!0,validateOnSave:!0,validateOnQuery:!1,validateOnPropertyChange:!0}),n}(),t.ValidationOptions=kt,t.makeComplexArray=function(){function t(n,t){var i=f(n,t);return!i.length,i}function f(n,t){return t}function i(n,t){u(n,"arrayChanged",{complexArray:n,added:t})}function r(n,t){u(n,"arrayChanged",{complexArray:n,removed:t})}function u(n,t,i){var r=n._getPendingPubs();r?n._pendingArgs?e(n._pendingArgs,i):(n._pendingArgs=i,r.push(function(){n[t].publish(n._pendingArgs),n._pendingArgs=null})):n[t].publish(i)}function e(n,t){var i,u,r;for(i in t)if(i!=="complexArray"&&n.hasOwnProperty(i))if(u=t[i],r=n[i],r){if(!Array.isArray(r))throw new Error("Cannot combine non array args");Array.prototype.push.apply(r,u)}else n[i]=u}function o(t,i,r){return t.parentEntity=i,t.complexProperty=r,t.arrayChanged=new tt("arrayChanged_entityCollection",t),t._addsInProcess=[],ut(t,n)}var n={};return n.push=function(){var n,r;return this._inProgress?-1:(n=t(this,c(arguments)),!n.length)?this.length:(r=Array.prototype.push.apply(this,n),i(this,n),r)},n.unshift=function(){var n=t(this,c(arguments)),r;return n.length?(r=Array.prototype.unshift.apply(this,n),i(this,c(n)),r):this.length},n.pop=function(){var n=Array.prototype.pop.apply(this);return r(this,[n]),n},n.shift=function(){var n=Array.prototype.shift.apply(this);return r(this,[n]),n},n.splice=function(){var n=t(this,c(arguments,2)),f=c(arguments,0,2).concat(n),u=Array.prototype.splice.apply(this,f);return r(this,u),n.length&&i(this,n),u},n._getEventParent=function(){return this.parentEntity.entityAspect},n._getPendingPubs=function(){var n=this.parentEntity.entityAspect.entityManager;return n&&n._pendingPubs},o}(),k=function(){var t={isAttach:function(){return!!this.isAttach},isDetach:function(){return!!this.isDetach},isModification:function(){return!!this.isModification}},n=new ft("EntityAction",t);return n.Attach=n.addSymbol({isAttach:!0}),n.AttachOnQuery=n.addSymbol({isAttach:!0}),n.AttachOnImport=n.addSymbol({isAttach:!0}),n.Detach=n.addSymbol({isDetach:!0}),n.MergeOnQuery=n.addSymbol({isModification:!0}),n.MergeOnImport=n.addSymbol({isModification:!0}),n.MergeOnSave=n.addSymbol({isModification:!0}),n.PropertyChange=n.addSymbol({isModification:!0}),n.EntityStateChange=n.addSymbol(),n.AcceptChanges=n.addSymbol(),n.RejectChanges=n.addSymbol({isModification:!0}),n.Clear=n.addSymbol({isDetach:!0}),n.seal(),n}(),t.EntityAction=k,ot=function(){function i(n){var u=n.entityAspect||n.complexAspect,f=n.entityType||n.complexType,r=u.originalValues,t;for(t in r)n.setProperty(t,r[t]);f.complexProperties.forEach(function(t){var r=n.getProperty(t.name);t.isScalar?i(r):r.forEach(function(n){i(n)})})}function r(n){var i=n.entityAspect||n.complexAspect,t;i.originalValues={},t=n.entityType||n.complexType,t.complexProperties.forEach(function(t){var i=n.getProperty(t.name);t.isScalar?r(i):i.forEach(function(n){r(n)})})}function s(n){var t=!0,u=n.entityType||n.complexType,i=n.entityAspect||n.complexAspect,r=n.entityAspect||n.complexAspect.entityAspect;return u.getProperties().forEach(function(u){var f=n.getProperty(u.name),o=i.propertyPath?i.propertyPath+"."+u.name:u.name,e;u.validators.length>0&&(e={entity:r.entity,property:u,propertyName:o},t=r._validateProperty(f,e)&&t),u.isComplexProperty&&u.isScalar&&(t=s(f)&&t)}),u.validators.forEach(function(n){t=c(r,n,i.entity)&&t}),t}function c(n,t,i,r){var u=t.validate(i,r);return u?(n._addValidationError(u),!1):(n._removeValidationError(t,r?r.propertyName:null),!0)}var h=function(n){var t,i,r,f;if(n===null){if(t=ot._nullInstance,t)return t;ot._nullInstance=this}else if(n===undefined)throw new Error("The EntityAspect ctor requires an entity as its only argument.");else if(n.entityAspect)return n.entityAspect;if(!(this instanceof ot))return new ot(n);if(this.entity=n,this.entityGroup=null,this.entityManager=null,this.entityState=u.Detached,this.isBeingSaved=!1,this.originalValues={},this._validationErrors={},this.validationErrorsChanged=new tt("validationErrorsChanged_entityAspect",this),this.propertyChanged=new tt("propertyChanged_entityAspect",this),n!=null){if(n.entityAspect=this,i=n.entityType,!i)if(r=n.prototype._$typeName,r)throw new Error("Metadata for this entityType has not yet been resolved: "+r);else throw new Error("This entity is not registered as a valid EntityType");f=i.getEntityCtor(),wt.getDefaultInstance().startTracking(n,f.prototype)}},t=h.prototype;return t._postInitialize=function(){var t=this.entity,i=t.entityType.getEntityCtor(),n=i._$initializationFn;n&&(typeof n=="string"&&(n=t[n]),n(t))},tt.bubbleEvent(t,function(){return this.entityManager}),t.getKey=function(t){if(t=n(t,"forceRefresh").isBoolean().isOptional().check(!1),t||!this._entityKey){var i=this.entity.entityType,r=i.keyProperties,u=r.map(function(n){return this.entity.getProperty(n.name)},this);this._entityKey=new o(i,u)}return this._entityKey},t.acceptChanges=function(){var n=this.entityManager;this.entityState.isDeleted()?n.detachEntity(this.entity):this.setUnchanged(),n.entityChanged.publish({entityAction:k.AcceptChanges,entity:this.entity})},t.rejectChanges=function(){var n=this.entity,t=this.entityManager;ui(t,"isRejectingChanges",!0,function(){i(n)}),this.entityState.isAdded()?(t.detachEntity(n),t._notifyStateChange(n,!1)):(this.entityState.isDeleted()&&this.entityManager._linkRelatedEntities(n),this.setUnchanged(),this.propertyChanged.publish({entity:n,propertyName:null}),this.entityManager.entityChanged.publish({entityAction:k.RejectChanges,entity:n}))},t.setUnchanged=function(){r(this.entity),delete this.hasTempKey,this.entityState=u.Unchanged,this.entityManager._notifyStateChange(this.entity,!1)},t.setModified=function(){this.entityState=u.Modified,this.entityManager._notifyStateChange(this.entity,!0)},t.setDeleted=function(){var n=this.entityManager;this.entityState.isAdded()?(n.detachEntity(this.entity),n._notifyStateChange(this.entity,!1)):(this.entityState=u.Deleted,this._removeFromRelations(),n._notifyStateChange(this.entity,!0))},t.loadNavigationProperty=function(n,t,i){var r=this.entity,u=r.entityType._checkNavProperty(n),f=nt.fromEntityNavigation(r,u,t,i);return r.entityAspect.entityManager.executeQuery(f,t,i)},t.validateEntity=function(){var n=!0;return this._processValidationOpAndPublish(function(t){n=s(t.entity)}),n},t.validateProperty=function(n,t){var i=this.getPropertyValue(n);return i&&i.complexAspect?s(i):(t=t||{},t.entity=this.entity,typeof n=="string"?(t.property=this.entity.entityType.getProperty(n,!0),t.propertyName=n):(t.property=n,t.propertyName=n.name),this._validateProperty(i,t))},t.getValidationErrors=function(t){var i,r;return n(t,"property").isOptional().isEntityProperty().or().isString().check(),i=yr(this._validationErrors),t&&(r=typeof t=="string"?t:t.name,i=i.filter(function(n){return n.property.name===r})),i},t.addValidationError=function(t){n(t,"validationError").isInstanceOf(bt).check(),this._processValidationOpAndPublish(function(n){n._addValidationError(t)})},t.removeValidationError=function(t,i){n(t,"validator").isString().or().isInstanceOf(f).check(),n(i,"property").isOptional().isEntityProperty().check(),this._processValidationOpAndPublish(function(n){n._removeValidationError(t,i&&i.name)})},t.clearValidationErrors=function(){this._processValidationOpAndPublish(function(n){d(n._validationErrors,function(t,i){i&&(delete n._validationErrors[t],n._pendingValidationResult.removed.push(i))})})},t.getParentKey=function(n){var t=n.foreignKeyNames,i,r;return t.length===0?null:(i=this,r=t.map(function(n){return i.entity.getProperty(n)}),new o(n.entityType,r))},t.getPropertyValue=function(t){var i,r,u;if(n(t,"property").isString().or().isEntityProperty().check(),typeof t=="string")for(r=t.trim().split("."),u=r.shift(),i=this.entity,i=i.getProperty(u);r.length>0;)u=r.shift(),i=i.getProperty(u);else{if(!(t.parentType instanceof e))throw new Error("The validateProperty method does not accept a 'property' parameter whose parentType is a ComplexType; Pass a 'property path' string as the 'property' paramter instead ");i=this.entity.getProperty(t.name)}return i},t._detach=function(){this.entityGroup=null,this.entityManager=null,this.entityState=u.Detached,this.originalValues={},this._validationErrors={},this.validationErrorsChanged.clear(),this.propertyChanged.clear()},t._removeFromRelations=function(){var n=this.entity;n.entityType.navigationProperties.forEach(function(t){var i=t.inverse,r,u;i&&(r=n.getProperty(t.name),t.isScalar?r&&(i.isScalar?r.setProperty(i.name,null):(u=r.getProperty(i.name),u.length&&fr(u,n)),n.setProperty(t.name,null)):(r.slice(0).forEach(function(n){i.isScalar&&n.setProperty(i.name,null)}),r.length=0))})},t._validateProperty=function(n,t){var i=!0;return this._processValidationOpAndPublish(function(r){t.property.validators.forEach(function(u){i=i&&c(r,u,n,t)})}),i},t._processValidationOpAndPublish=function(n){if(this._pendingValidationResult)n(this);else try{this._pendingValidationResult={entity:this.entity,added:[],removed:[]},n(this),(this._pendingValidationResult.added.length>0||this._pendingValidationResult.removed.length>0)&&this.validationErrorsChanged.publish(this._pendingValidationResult)}finally{this._pendingValidationResult=undefined}},t._addValidationError=function(n){this._validationErrors[n.key]=n,this._pendingValidationResult.added.push(n)},t._removeValidationError=function(n,t){var i=bt.getKey(n,t),r=this._validationErrors[i];r&&(delete this._validationErrors[i],this._pendingValidationResult.removed.push(r))},h}(),oi=function(){var n=function(n,t,i){var r,u,f,e;if(!n)throw new Error("The  ComplexAspect ctor requires an entity as its only argument.");if(n.complexAspect)return n.complexAspect;if(!(this instanceof oi))return new oi(n,t,i);if(this.complexObject=n,n.complexAspect=this,this.originalValues={},t==null)this.entityAspect=new ot(null);else{for(this.parent=t,this.parentProperty=i,this.propertyPath=i,r=t;r.complexType;)this.propertyPath=r.complexAspect.propertyPath+"."+this.propertyPath,r=r.complexAspect.parent;this.entityAspect=r.entityAspect}if(u=n.complexType,!u)if(f=n.prototype._$typeName,f)throw new Error("Metadata for this complexType has not yet been resolved: "+f);else throw new Error("This entity is not registered as a valid ComplexType");e=u.getCtor(),wt.getDefaultInstance().startTracking(n,e.prototype)},t=n.prototype;return t._postInitialize=function(){var n=this.complexObject,i=n.complexType.getCtor(),t=i._$initializationFn;t&&(typeof t=="string"?n[t](n):i._$initializationFn(n))},n}(),t.EntityAspect=ot,t.ComplexAspect=oi,o=function(){function f(n){return n.join(u)}var u=":::",t=function(t,r){n(t,"entityType").isInstanceOf(e).check();var u=t.getSelfAndSubtypes();u.length>1&&(this._subtypes=u.filter(function(n){return n.isAbstract===!1})),Array.isArray(r)||(r=c(arguments,1)),this.entityType=t,t.keyProperties.forEach(function(n,t){n.dataType===i.Guid&&(r[t]=r[t]&&r[t].toLowerCase())}),this.values=r,this._keyInGroup=f(r)},r;return t._$typeName="EntityKey",r=t.prototype,r.toJSON=function(){return{entityType:this.entityType.name,values:this.values}},t.fromJSON=function(n,t){var i=t._getEntityType(n.entityType,!0);return new o(i,n.values)},r.equals=function(n){return n instanceof o?this.entityType===n.entityType&&er(this.values,n.values):!1},r.toString=function(){return this.entityType.name+"-"+this._keyInGroup},t.equals=function(n,t){return n instanceof o?n.equals(t):!1},r._isEmpty=function(){return this.values.join("").length===0},t}(),t.EntityKey=o,u=function(){var t={isUnchanged:function(){return this===n.Unchanged},isAdded:function(){return this===n.Added},isModified:function(){return this===n.Modified},isDeleted:function(){return this===n.Deleted},isDetached:function(){return this===n.Detached},isUnchangedOrModified:function(){return this===n.Unchanged||this===n.Modified},isAddedModifiedOrDeleted:function(){return this===n.Added||this===n.Modified||this===n.Deleted}},n=new ft("EntityState",t);return n.Unchanged=n.addSymbol(),n.Added=n.addSymbol(),n.Modified=n.addSymbol(),n.Deleted=n.addSymbol(),n.Detached=n.addSymbol(),n.seal(),n}(),t.EntityState=u,t.makeRelationArray=function(){function i(n,t){var i=e(n,t),f,r;return i.length?(f=n.parentEntity,r=f.entityAspect.entityManager,r&&!r.isLoading&&i.forEach(function(t){if(t.entityAspect.entityState.isDetached()){n._inProgress=!0;try{r.attachEntity(t,u.Added)}finally{n._inProgress=!1}}}),i):i}function e(n,t){var i=n.parentEntity,r=n.navigationProperty,u=r.inverse,f;if(u)f=t.filter(function(t){if(n._addsInProcess.indexOf(t)>=0)return!1;var r=t.getProperty(u.name);return r!==i});else var e=r.invForeignKeyNames,o=i.entityType.keyProperties,f=t.filter(function(t){return n._addsInProcess.indexOf(t)>=0?!1:e.some(function(n,r){var u=o[r].name,f=i.getProperty(u),e=t.getProperty(n);return f!==e})});return f}function t(n,t){var i=n.parentEntity,u=n.navigationProperty,e=u.inverse,r=n._addsInProcess,o=r.length;try{t.forEach(function(n){if(r.push(n),e)n.setProperty(e.name,i);else{var t=i.entityType.keyProperties;u.invForeignKeyNames.forEach(function(r,u){n.setProperty(r,i.getProperty(t[u].name))})}})}finally{r.splice(o,t.length)}f(n,"arrayChanged",{relationArray:n,added:t})}function f(n,t,i){var r=n._getPendingPubs();r?n._pendingArgs?o(n._pendingArgs,i):(n._pendingArgs=i,r.push(function(){n[t].publish(n._pendingArgs),n._pendingArgs=null})):n[t].publish(i)}function o(n,t){var i,u,r;for(i in t)if(i!=="relationArray"&&n.hasOwnProperty(i))if(u=t[i],r=n[i],r){if(!Array.isArray(r))throw new Error("Cannot combine non array args");Array.prototype.push.apply(r,u)}else n[i]=u}function r(n,t){var i=n.navigationProperty.inverse;i&&t.forEach(function(n){n.setProperty(i.name,null)}),f(n,"arrayChanged",{relationArray:n,removed:t})}function s(t,i,r){return t.parentEntity=i,t.navigationProperty=r,t.arrayChanged=new tt("arrayChanged_entityCollection",t),t._addsInProcess=[],ut(t,n)}var n={};return n.push=function(){var n,r;return this._inProgress?-1:(n=i(this,c(arguments)),!n.length)?this.length:(r=Array.prototype.push.apply(this,n),t(this,n),r)},n._push=function(){if(this._inProgress)return-1;var n=c(arguments),i=Array.prototype.push.apply(this,n);return t(this,n),i},n.unshift=function(){var n=i(this,c(arguments)),r;return n.length?(r=Array.prototype.unshift.apply(this,n),t(this,c(n)),r):this.length},n.pop=function(){var n=Array.prototype.pop.apply(this);return r(this,[n]),n},n.shift=function(){var n=Array.prototype.shift.apply(this);return r(this,[n]),n},n.splice=function(){var n=i(this,c(arguments,2)),f=c(arguments,0,2).concat(n),u=Array.prototype.splice.apply(this,f);return r(this,u),n.length&&t(this,n),u},n.load=function(n,t){var i=this.parentEntity,r=nt.fromEntityNavigation(this.parentEntity,this.navigationProperty),u=i.entityAspect.entityManager;return u.executeQuery(r,n,t)},n._getEventParent=function(){return this.parentEntity.entityAspect},n._getPendingPubs=function(){var n=this.parentEntity.entityAspect.entityManager;return n&&n._pendingPubs},s}(),h=function(){function i(n,t){return t&&(v(t).whereParam("serviceName").isOptional().whereParam("adapterName").isString().isOptional().whereParam("hasServerMetadata").isBoolean().isOptional().whereParam("jsonResultsAdapter").isInstanceOf(si).isOptional().whereParam("useJsonp").isBoolean().isOptional().applyAll(n),n.serviceName=n.serviceName&&h._normalizeServiceName(n.serviceName),n.adapterInstance=n.adapterName&&l.getAdapterInstance("dataService",n.adapterName)),n}var n=function(n){i(this,n)},t=n.prototype;return t._$typeName="DataService",t.using=function(n){if(!n)return this;var t=new h(this);return i(t,n)},n.resolve=function(n){n.push({hasServerMetadata:!0,useJsonp:!1});var t=new h(pr(n,["serviceName","adapterName","hasServerMetadata","jsonResultsAdapter","useJsonp"]));if(!t.serviceName)throw new Error("Unable to resolve a 'serviceName' for this dataService");return t.adapterInstance=t.adapterInstance||l.getAdapterInstance("dataService",t.adapterName),t.jsonResultsAdapter=t.jsonResultsAdapter||t.adapterInstance.jsonResultsAdapter,t},n._normalizeServiceName=function(n){return n=n.trim(),n.substr(-1)!=="/"?n+"/":n},t.toJSON=function(){return pt(this,{serviceName:null,adapterName:null,hasServerMetadata:null,jsonResultsAdapter:function(n){return n&&n.name},useJsonp:null})},n.fromJSON=function(n){return n.jsonResultsAdapter=l._fetchObject(si,n.jsonResultsAdapter),new h(n)},t.makeUrl=function(n){var t=this.serviceName;return r.stringEndsWith(t,"/")&&(t=t.substr(0,t.length-1)),n="/"+n,r.stringEndsWith(t,n)||(t=t+n),t},n}(),si=function(){function i(n){return n.results}var n=function(n){if(arguments.length!=1)throw new Error("The JsonResultsAdapter ctor should be called with a single argument that is a configuration object.");v(n).whereParam("name").isNonEmptyString().whereParam("extractResults").isFunction().isOptional().withDefault(i).whereParam("visitNode").isFunction().applyAll(this),l._storeObject(this,t._$typeName,this.name)},t=n.prototype;return t._$typeName="JsonResultsAdapter",n}(),t.DataService=h,t.JsonResultsAdapter=si,i=function(){function e(n,t){n=a(n,t);throw new Error(n);}function et(t){switch(t){case n.String:return f.string;case n.Int64:return f.int64;case n.Int32:return f.int32;case n.Int16:return f.int16;case n.Decimal:return f.number;case n.Double:return f.number;case n.Single:return f.number;case n.DateTime:return f.date;case n.DateTimeOffset:return f.date;case n.Boolean:return f.bool;case n.Guid:return f.guid;case n.Byte:return f.byte;case n.Binary:return f.none;case n.Time:return f.duration;case n.Undefined:return f.none}}var v={},i={stringPrefix:"K_",nextNumber:-1,nextNumberIncrement:-1},y=function(){return i.stringPrefix+t().toString()},t=function(){var n=i.nextNumber;return i.nextNumber+=i.nextNumberIncrement,n},p=function(){return fi()},h=function(){return new Date},w=function(n){return n==null?n:n.toString()},r=function(n,t){var i,r;return t==="string"?(i=n.trim(),i==="")?null:(r=parseInt(i,10),isNaN(r)?n:r):t==="number"?Math.round(n):n},o=function(n,t){var i,r;return t==="string"?(i=n.trim(),i==="")?null:(r=parseFloat(i),isNaN(r)?n:r):n},c=function(n,t){var r,i;return t==="string"?(r=n.trim(),r==="")?null:(i=new Date(Date.parse(r)),ct(i)?i:n):t==="number"?(i=new Date(n),ct(i)?i:n):n},b=function(n,t){if(t==="string"){var i=n.trim().toLowerCase();return i==="false"||i===""?!1:i==="true"?!0:n}return n},k=function(n){return n==null?null:"'"+n+"'"},u=function(n){return n==null?null:typeof n=="string"?parseInt(n):n},s=function(n){return function(t){return t==null?null:(typeof t=="string"&&(t=parseFloat(t)),t+n)}},d=function(n){if(n==null)return null;try{return"datetime'"+n.toISOString()+"'"}catch(t){e("'%1' is not a valid dateTime",n)}},g=function(n){if(n==null)return null;try{return"datetimeoffset'"+n.toISOString()+"'"}catch(t){e("'%1' is not a valid dateTime",n)}},nt=function(n){return n==null?null:(ki(n)||e("'%1' is not a valid ISO 8601 duration",n),"time'"+n+"'")},tt=function(n){return n==null?null:(bi(n)||e("'%1' is not a valid guid",n),"guid'"+n+"'")},it=function(n){return n==null?null:typeof n=="string"?n.trim().toLowerCase()==="true":!!n},rt=function(n){return n==null?n:"binary'"+n+"'"},ut=function(n){return n},n=new ft("DataType",v),l;return n.String=n.addSymbol({defaultValue:"",parse:w,fmtOData:k,getNext:y}),n.Int64=n.addSymbol({defaultValue:0,isNumeric:!0,isInteger:!0,quoteJsonOData:!0,parse:r,fmtOData:u,getNext:t}),n.Int32=n.addSymbol({defaultValue:0,isNumeric:!0,isInteger:!0,parse:r,fmtOData:u,getNext:t}),n.Int16=n.addSymbol({defaultValue:0,isNumeric:!0,isInteger:!0,parse:r,fmtOData:u,getNext:t}),n.Byte=n.addSymbol({defaultValue:0,isNumeric:!0,isInteger:!0,parse:r,fmtOData:u}),n.Decimal=n.addSymbol({defaultValue:0,isNumeric:!0,quoteJsonOData:!0,parse:o,fmtOData:s("m"),getNext:t}),n.Double=n.addSymbol({defaultValue:0,isNumeric:!0,parse:o,fmtOData:s("d"),getNext:t}),n.Single=n.addSymbol({defaultValue:0,isNumeric:!0,parse:o,fmtOData:s("f"),getNext:t}),n.DateTime=n.addSymbol({defaultValue:new Date(1900,0,1),isDate:!0,parse:c,fmtOData:d,getNext:h}),n.DateTimeOffset=n.addSymbol({defaultValue:new Date(1900,0,1),isDate:!0,parse:c,fmtOData:g,getNext:h}),n.Time=n.addSymbol({defaultValue:"PT0S",fmtOData:nt}),n.Boolean=n.addSymbol({defaultValue:!1,parse:b,fmtOData:it}),n.Guid=n.addSymbol({defaultValue:"00000000-0000-0000-0000-000000000000",fmtOData:tt,getNext:p}),n.Binary=n.addSymbol({defaultValue:null,fmtOData:rt}),n.Undefined=n.addSymbol({defaultValue:undefined,fmtOData:ut}),n.seal(),n.fromEdmDataType=function(t){var i=null,r=t.split("."),u;return r.length>1&&(u=r[1],i=u==="image"?n.Byte:r.length==2?n.fromName(u)||n.Undefined:n.String),i},n.fromValue=function(t){if(ct(t))return n.DateTime;switch(typeof t){case"string":return bi(t)?n.Guid:ki(t)&&t.length>3?n.Time:n.String;case"boolean":return n.Boolean;case"number":return n.Int32}return n.Undefined},l=/.\d{3}$/,n.parseDateAsUTC=function(n){if(typeof n=="string"){var t=l.test(n);n=t?n+"Z":n}return n=new Date(Date.parse(n))},n.parseDateFromServer=n.parseDateAsUTC,n.constants=i,n.getSymbols().forEach(function(n){n.validatorCtor=et(n)}),n}(),t.DataType=i;var s=wr("Q","See https://github.com/kriskowal/q "),dt=function(){function y(n){var i=[],t,r;for(t in n)r=n[t],t===r.name&&i.push(n[t]);return i}function p(n,t){var o=hi(t.shortName,t.namespace),i=n._getEntityType(o,!0),r,f;return i?i:(r={shortName:t.shortName,namespace:t.namespace,isAbstract:t.isAbstract,autoGeneratedKeyType:it.fromName(t.autoGeneratedKeyType),defaultResourceName:t.defaultResourceName},i=t.isComplexType?new at(r):new e(r),t.baseTypeName?(i.baseTypeName=t.baseTypeName,f=n._getEntityType(t.baseTypeName),f?u(n,t,i,f):pi(n.deferredTypes,baseTypeName).push({json:t,stype:i})):u(n,t,i,null),i)}function u(n,t,i,r){var s,e,o;t.validators&&(i.validators=t.validators.map(f.fromJSON)),r&&(i.baseEntityType=r,r.dataProperties.forEach(function(n){var t=new g(n);t.isInherited=!0,i.addProperty(t)}),r.navigationProperties.forEach(function(n){var t=new st(n);t.isInherited=!0,i.addProperty(t)})),t.dataProperties.forEach(function(n){i.addProperty(g.fromJSON(n))}),s=!t.isComplexType,s&&t.navigationProperties&&t.navigationProperties.forEach(function(n){i.addProperty(st.fromJSON(n))}),n.addEntityType(i),e=n._deferredTypes,o=e[i.name],o&&(o.forEach(function(t){u(n,t.json,t.stype,i)}),delete e[i.name])}function o(n,t,i){if(iu(t))return t;var r=n._shortNameMap[t];if(!r&&i)throw new Error("Unable to locate 'entityTypeName' of: "+t);return r}var c=0,r=function(n){n=n||{},v(n).whereParam("namingConvention").isOptional().isInstanceOf(ni).withDefault(ni.defaultInstance).whereParam("localQueryComparisonOptions").isOptional().isInstanceOf(gt).withDefault(gt.defaultInstance).applyAll(this),this.dataServices=[],this._resourceEntityTypeMap={},this._structuralTypeMap={},this._shortNameMap={},this._ctorRegistry={},this._incompleteTypeMap={},this._incompleteComplexTypeMap={},this._id=c++},i=r.prototype;return i._$typeName="MetadataStore",r.ANONTYPE_PREFIX="_IB_",i.addDataService=function(t,i){n(t,"dataService").isInstanceOf(h).check(),n(i,"shouldOverwrite").isBoolean().isOptional().check();var r=this._getDataServiceIndex(t.serviceName);if(r>=0)if(!i)throw new Error("A dataService with this name '"+t.serviceName+"' already exists in this MetadataStore");else this.dataServices[r]=t;else this.dataServices.push(t)},i._getDataServiceIndex=function(n){return ur(this.dataServices,function(t){return t.serviceName===n})},i.addEntityType=function(n){if(n instanceof e||n instanceof at||(n=n.isComplexType?new at(n):new e(n)),!n.isComplexType&&n.keyProperties.length===0)throw new Error("Unable to add "+n.name+" to this MetadataStore.  An EntityType must have at least one property designated as a key property - See the 'DataProperty.isPartOfKey' property.");if(n.metadataStore=this,n.isAnonymous||(this._structuralTypeMap[n.name]=n,this._shortNameMap[n.shortName]=n.name),n.getProperties().forEach(function(t){n._updateNames(t),t.isUnmapped||n._mappedPropertiesCount++}),n._updateCps(),!n.isComplexType){n._updateNps();var t=n.defaultResourceName||n.baseEntityType&&n.baseEntityType.defaultResourceName;t&&!this.getEntityTypeNameForResourceName(t)&&this.setEntityTypeForResourceName(t,n.name),n.defaultResourceName=t,n.getEntityCtor()}n.baseEntityType&&n.baseEntityType.subtypes.push(n)},i.exportMetadata=function(){return JSON.stringify({metadataVersion:t.metadataVersion,namingConvention:this.namingConvention.name,localQueryComparisonOptions:this.localQueryComparisonOptions.name,dataServices:this.dataServices,structuralTypes:rr(this._structuralTypeMap),resourceEntityTypeMap:this._resourceEntityTypeMap},l.stringifyPad)},i.importMetadata=function(n){var i,e,r,u,f,o;if(this._deferredTypes={},n.schema)return tu.parse(this,n.schema);if(i=typeof n=="string"?JSON.parse(n):n,i.metadataVersion&&i.metadataVersion!==t.metadataVersion){e=a("Cannot import metadata with a different 'metadataVersion' (%1) than the current 'breeze.metadataVersion' (%2) ",i.metadataVersion,t.metadataVersion);throw new Error(e);}if(r=i.namingConvention,u=i.localQueryComparisonOptions,this.isEmpty())this.namingConvention=l._fetchObject(ni,r)||ni.defaultInstance,this.localQueryComparisonOptions=l._fetchObject(gt,u)||gt.defaultInstance;else{if(r&&this.namingConvention.name!==r)throw new Error("Cannot import metadata with a different 'namingConvention' from the current MetadataStore");if(u&&this.localQueryComparisonOptions.name!==u)throw new Error("Cannot import metadata with different 'localQueryComparisonOptions' from the current MetadataStore");}return f=this,i.dataServices&&i.dataServices.forEach(function(n){n=h.fromJSON(n),f.addDataService(n,!0)}),o=this._structuralTypeMap,i.structuralTypes.forEach(function(n){var t=p(f,n);o[t.name]=t}),ut(this._resourceEntityTypeMap,i.resourceEntityTypeMap),ut(this._incompleteTypeMap,i.incompleteTypeMap),this},r.importMetadata=function(n){var t=new dt;return t.importMetadata(n),t},i.hasMetadataFor=function(n){return!!this.getDataService(n)},i.getDataService=function(t){return n(t,"serviceName").isString().check(),t=h._normalizeServiceName(t),b(this.dataServices,function(n){return n.serviceName===t})},i.fetchMetadata=function(t,i,r){if(n(t,"dataService").isString().or().isInstanceOf(h).check(),n(i,"callback").isFunction().isOptional().check(),n(r,"errorCallback").isFunction().isOptional().check(),typeof t=="string"&&(t=this.getDataService(t)||new h({serviceName:t})),t=h.resolve([t]),this.hasMetadataFor(t.serviceName))throw new Error("Metadata for a specific serviceName may only be fetched once per MetadataStore. ServiceName: "+t.serviceName);return t.adapterInstance.fetchMetadata(this,t).then(function(n){return i&&i(n),s.resolve(n)}).fail(function(n){return r&&r(n),s.reject(n)})},i.trackUnmappedType=function(t,i){n(t,"entityCtor").isFunction().check(),n(i,"interceptor").isFunction().isOptional().check();var r=new e(this);r._setCtor(t,i)},i.registerEntityTypeCtor=function(t,i,r){var u,e,f;n(t,"structuralTypeName").isString().check(),n(i,"aCtor").isFunction().isOptional().check(),n(r,"initializationFn").isOptional().isFunction().or().isString().check(),u=o(this,t,!1),e=u||t,this._ctorRegistry[e]={ctor:i,initFn:r},u&&(f=this._structuralTypeMap[u],f&&f.getCtor(!0))},i.toQueryString=function(n){if(!n)throw new Error("query cannot be empty");if(typeof n=="string")return n;if(n instanceof nt)return n._toUri(this);throw new Error("unable to recognize query parameter as either a string or an EntityQuery");},i.isEmpty=function(){return ei(this._structuralTypeMap)},i.getEntityType=function(t,i){return n(t,"structuralTypeName").isString().check(),n(i,"okIfNotFound").isBoolean().isOptional().check(!1),this._getEntityType(t,i)},i._getEntityType=function(n,t){var f=o(this,n,!1),i=this._structuralTypeMap[f],r,u;if(!i){if(t)return null;r=a("Unable to locate a 'Type' by the name: '%1'. Be sure to execute a query or call fetchMetadata first.",n);throw new Error(r);}if(i.length){u=i.join(",");throw new Error("There are multiple types with this 'shortName': "+u);}return i},i.getEntityTypes=function(){return y(this._structuralTypeMap)},i.getIncompleteNavigationProperties=function(){return rr(this._incompleteTypeMap,function(n,t){return t})},i.getEntityTypeNameForResourceName=function(t){return n(t,"resourceName").isString().check(),this._resourceEntityTypeMap[t]},i.setEntityTypeForResourceName=function(t,i){var r,u;n(t,"resourceName").isString().check(),n(i,"entityTypeOrName").isInstanceOf(e).or().isString().check(),r=i instanceof e?i.name:o(this,i,!0),this._resourceEntityTypeMap[t]=r,u=this._getEntityType(r,!0),u&&!u.defaultResourceName&&(u.defaultResourceName=t)},i._getCtorRegistration=function(n){var t=metadataStore._ctorRegistry[n.name]||metadataStore._ctorRegistry[n.shortName];t.ctor||n.getEntityCtor()},i._checkEntityType=function(n){var t,i;if(!n.entityType){if(t=n.prototype._$typeName,!t)throw new Error("This entity has not been registered. See the MetadataStore.registerEntityTypeCtor method");i=this._getEntityType(t),i&&(n.entityType=i)}},r}(),tu=function(){function s(t,i){t._entityTypeResourceMap={},w(i).forEach(function(i){if(i.cSpaceOSpaceMapping){var u=JSON.parse(i.cSpaceOSpaceMapping),r={};u.forEach(function(n){r[n[0]]=n[1]}),i.cSpaceOSpaceMapping=r}i.entityContainer&&w(i.entityContainer).forEach(function(r){w(r.entitySet).forEach(function(r){var u=n(r.entityType,i).typeName;t.setEntityTypeForResourceName(r.name,u),t._entityTypeResourceMap[u]=r.name})}),i.complexType&&w(i.complexType).forEach(function(n){var r=c(n,i,t)}),i.entityType&&w(i.entityType).forEach(function(n){var r=h(n,i,t)})});var r=t.getIncompleteNavigationProperties();if(r.length>0)throw new Error("Bad nav properties");return t}function h(i,u,f){var l=i.name,a=r(l,u),o=new e({shortName:l,namespace:a,isAbstract:i.abstract&&i.abstract==="true"}),s,c,h;return i.baseType?(s=n(i.baseType,u).typeName,o.baseTypeName=s,c=f._getEntityType(s,!0),c?t(o,i,u,f,c):(h=f._deferredTypes[s],h||(h=[],f._deferredTypes[s]=h),h.push({entityType:o,csdlEntityType:i}))):t(o,i,u,f,null),o}function t(n,i,r,f,e){var c=[],o,s,h;e&&(n.baseEntityType=e,n.autoGeneratedKeyType=e.autoGeneratedKeyType,c=e.keyProperties.map(yt("name")),e.dataProperties.forEach(function(t){var i=new g(t);i.isInherited=!0,n.addProperty(i)}),e.navigationProperties.forEach(function(t){var i=new st(t);i.isInherited=!0,n.addProperty(i)})),o=i.key?w(i.key.propertyRef).map(yt("name")):[],o=c.concat(o),w(i.property).forEach(function(t){u(n,t,r,o)}),w(i.navigationProperty).forEach(function(t){a(n,t,r)}),f.addEntityType(n),n.defaultResourceName=f._entityTypeResourceMap[n.name],s=f._deferredTypes,h=s[n.name],h&&(h.forEach(function(i){t(i.entityType,i.csdlEntityType,r,f,n)}),delete s[n.name])}function c(n,t,i){var e=n.name,o=r(e,t),f=new at({shortName:e,namespace:o});return w(n.property).forEach(function(n){u(f,n,t)}),i.addEntityType(f),f}function u(n,t,i,r){var u,f=t.type.split(".");return f.length==2?u=o(n,t,r):v(t,i)?(u=o(n,t,r),u&&(u.enumType=t.type)):u=l(n,t,i),u&&(n.addProperty(u),y(u)),u}function o(n,t,r){var f=i.fromEdmDataType(t.type),s,e,u,o;return f==null?(n.warnings.push("Unable to recognize DataType for property: "+t.name+" DateType: "+t.type),null):(s=t.nullable==="true"||t.nullable==null,e=r!=null&&r.indexOf(t.name)>=0,e&&n.autoGeneratedKeyType==it.None&&p(t)&&(n.autoGeneratedKeyType=it.Identity),u=t.maxLength,u=u==null||u==="Max"?null:parseInt(u),o=new g({nameOnServer:t.name,dataType:f,isNullable:s,isPartOfKey:e,maxLength:u,concurrencyMode:t.concurrencyMode}),f===i.Undefined&&(o.rawTypeName=t.type),o)}function l(t,i,r){var u=n(i.type,r).typeName;return new g({nameOnServer:i.name,complexTypeName:u,isNullable:!1})}function a(t,i,r){var f=k(i,r),h=b(f.end,function(n){return n.role===i.toRole}),l=!(h.multiplicity==="*"),a=n(h.type,r).typeName,y=[],e=f.referentialConstraint,s;if(e){var o={nameOnServer:i.name,entityTypeName:a,isScalar:l,associationName:f.name},c=e.principal,v=e.dependent,u;return i.fromRole===c.role?(u=w(c.propertyRef),o.invForeignKeyNamesOnServer=u.map(yt("name"))):(u=w(v.propertyRef),o.foreignKeyNamesOnServer=u.map(yt("name"))),s=new st(o),t.addProperty(s),s}}function v(n,t){if(!t.enumType)return!1;var r=w(t.enumType),i=n.type.split("."),u=i[i.length-1];return r.some(function(n){return n.name===u})}function y(n){var t,r;(n.isNullable||n.validators.push(f.required()),n.isComplexProperty)||(n.dataType===i.String?n.maxLength?(r={maxLength:n.maxLength},t=f.maxLength(r)):t=f.string():t=n.dataType.validatorCtor(),n.validators.push(t))}function p(n){var i=b(Object.keys(n),function(n){return n.indexOf("StoreGeneratedPattern")>=0}),t,r;return i?n[i]==="Identity":(t=n.extensions,!t)?!1:(r=b(t,function(n){return n.name==="StoreGeneratedPattern"&&n.value==="Identity"}),!!r)}function k(t,i){var f=n(t.relationship,i).shortTypeName,r=i.association,u;return r?(Array.isArray(r)||(r=[r]),u=b(r,function(n){return n.name===f})):null}function n(n,t){var e,i,u,f,o;return n?lt(n,dt.ANONTYPE_PREFIX)?{shortTypeName:n,namespace:"",typeName:n,isAnon:!0}:(e=n.split(",")[0],i=e.split("."),i.length>1?(u=i[i.length-1],t?f=r(u,t):(o=i.slice(0,i.length-1),f=o.join(".")),{shortTypeName:u,namespace:f,typeName:hi(u,f)}):{shortTypeName:n,namespace:"",typeName:n}):null}function r(n,t){var r,u=t.cSpaceOSpaceMapping,i;return u&&(i=u[t.namespace+"."+n],r=i&&i.substr(0,i.length-(n.length+1))),r||t.namespace}var d=kr(function(t){return t&&n(t).typeName});return{parse:s,normalizeTypeName:d}}(),e=function(){function y(){return function(){}}function o(n){return n.filter(function(n){return!n.isInherited})}function r(n,t,i){var r,u,f;if(serverPropName=i+"OnServer",r=t[i],r&&r.length){if(t.isUnmapped)return;u=w(r).map(function(i){var r=n.clientPropertyNameToServer(i,t),u=n.serverPropertyNameToClient(r,t);if(i!==u)throw new Error("NamingConvention for this client property name does not roundtrip properly:"+i+"-->"+u);return r}),t[serverPropName]=Array.isArray(r)?u:u[0]}else{if(serverName=t[serverPropName],!serverName||serverName.length==0)return;f=w(serverName).map(function(i){var r=n.serverPropertyNameToClient(i,t),u=n.clientPropertyNameToServer(r,t);if(i!==u)throw new Error("NamingConvention for this server property name does not roundtrip properly:"+i+"-->"+u);return r}),t[i]=Array.isArray(serverName)?f:f[0]}}function s(n,t){var i=t._getEntityType(n.complexTypeName,!0);if(!i)return!1;if(!(i instanceof at))throw new Error("Unable to resolve ComplexType with the name: "+n.complexTypeName+" for the property: "+property.name);return n.dataType=i,n.defaultValue=null,!0}function h(n,t){var i=t._getEntityType(n.entityTypeName,!0),r;return i?(n.entityType=i,r=b(i.navigationProperties,function(t){return t.associationName===n.associationName&&(t.name!=n.name||t.entityTypeName!=n.entityTypeName)}),n.inverse=r,r||n.invForeignKeyNames.forEach(function(t){var r=i.getDataProperty(t),u=n.parentType;r.inverseNavigationProperty=b(u.navigationProperties,function(n){return n.invForeignKeyNames&&n.invForeignKeyNames.indexOf(r.name)>=0}),i.foreignKeyProperties.push(r)}),p(n),!0):!1}function p(n){var r=n.foreignKeyNames,t,i;r.length!==0&&(t=n.parentType,i=r.map(function(n){return t.getDataProperty(n)}),Array.prototype.push.apply(t.foreignKeyProperties,i),i.forEach(function(t){t.relatedNavigationProperty=n,n.relatedDataProperties?n.relatedDataProperties.push(t):n.relatedDataProperties=[t]}))}function c(n,t){var r=n.getPropertyNames(),u=wt.getDefaultInstance().getTrackablePropertyNames(t);u.forEach(function(t){if(r.indexOf(t)==-1){var u=new g({name:t,dataType:i.Undefined,isNullable:!0,isUnmapped:!0});n.addProperty(u)}})}var l=0,u=function(n){if(arguments.length>1)throw new Error("The EntityType ctor has a single argument that is either a 'MetadataStore' or a configuration object.");n._$typeName==="MetadataStore"?(this.metadataStore=n,this.shortName="Anon_"+ ++l,this.namespace="",this.isAnonymous=!0):v(n).whereParam("shortName").isNonEmptyString().whereParam("namespace").isString().isOptional().withDefault("").whereParam("baseTypeName").isString().isOptional().whereParam("isAbstract").isBoolean().isOptional().withDefault(!1).whereParam("autoGeneratedKeyType").isEnumOf(it).isOptional().withDefault(it.None).whereParam("defaultResourceName").isNonEmptyString().isOptional().withDefault(null).whereParam("dataProperties").isOptional().whereParam("navigationProperties").isOptional().applyAll(this),this.name=hi(this.shortName,this.namespace),this.dataProperties=[],this.navigationProperties=[],this.complexProperties=[],this.keyProperties=[],this.foreignKeyProperties=[],this.concurrencyProperties=[],this.unmappedProperties=[],this.validators=[],this.warnings=[],this._mappedPropertiesCount=0,this.subtypes=[],sr(this,n.dataProperties,g),sr(this,n.navigationProperties,st)},t=u.prototype;return t._$typeName="EntityType",t.setProperties=function(n){v(n).whereParam("autoGeneratedKeyType").isEnumOf(it).isOptional().whereParam("defaultResourceName").isString().isOptional().applyAll(this),n.defaultResourceName&&(this.defaultResourceName=n.defaultResourceName)},t.isSubtypeOf=function(t){n(t,"entityType").isInstanceOf(e).check();var i=this;do{if(i===t)return!0;i=i.baseEntityType}while(i);return!1},t.getSelfAndSubtypes=function(){var n=[this];return this.subtypes.forEach(function(t){var i=t.getSelfAndSubtypes();n.push.apply(n,i)}),n},t.addProperty=function(t){if(n(t,"dataProperty").isInstanceOf(g).or().isInstanceOf(st).check(),this.metadataStore&&!t.isUnmapped)throw new Error("The '"+this.name+"' EntityType has already been added to a MetadataStore and therefore no additional properties may be added to it.");if(t.parentType)if(t.parentType!==this)throw new Error("This dataProperty has already been added to "+t.parentType.name);else return this;return t.parentType=this,t.isDataProperty?this._addDataProperty(t):this._addNavigationProperty(t),this},t.createEntity=function(n){var t=this._createEntityCore();return n&&d(n,function(n,i){t.setProperty(n,i)}),t.entityAspect._postInitialize(),t},t._createEntityCore=function(){var t=this.getEntityCtor(),n=new t;return new ot(n),n},t.getCtor=t.getEntityCtor=function(n){var r;if(this._ctor&&!n)return this._ctor;var u=this.metadataStore._ctorRegistry,i=u[this.name]||u[this.shortName]||{},t=i.ctor||this._ctor;return t||(r=wt.getDefaultInstance().createCtor,t=r?r(this):y()),i.initFn&&(t._$initializationFn=i.initFn),t.prototype._$typeName=this.name,this._setCtor(t),t},t._setCtor=function(n,t){var r=new n,i=n.prototype;this._$typeName=="EntityType"?(c(this,r),i.entityType=this):(c(this,r),i.complexType=this),i._$interceptor=t?t:su,wt.getDefaultInstance().initializeEntityPrototype(i),this._ctor=n},t.addValidator=function(t,i){n(t,"validator").isInstanceOf(f).check(),n(i,"property").isOptional().isString().or().isEntityProperty().check(),i?(typeof i=="string"&&(i=this.getProperty(i,!0)),i.validators.push(t)):this.validators.push(t)},t.getProperties=function(){return this.dataProperties.concat(this.navigationProperties)},t.getPropertyNames=function(){return this.getProperties().map(yt("name"))},t.getDataProperty=function(n,t){var i=t?"nameOnServer":"name";return b(this.dataProperties,ai(i,n))},t.getNavigationProperty=function(n,t){var i=t?"nameOnServer":"name";return b(this.navigationProperties,ai(i,n))},t.getProperty=function(n,t){var f;t=t||!1;var r=Array.isArray(n)?n:n.trim().split("."),u=r[0],i=b(this.getProperties(),ai("name",u));if(r.length===1){if(i)return i;if(t)throw new Error("unable to locate property: "+u+" on entityType: "+this.name);else return null}else if(i){if(r.shift(),f=i.isNavigationProperty?i.entityType:i.dataType,f)return f.getProperty(r,t);throw new Error("should not get here - unknown property type for: "+i.name);}else if(t)throw new Error("unable to locate property: "+u+" on type: "+this.name);else return null},t.toString=function(){return this.name},t.toJSON=function(){return pt(this,{shortName:null,namespace:null,baseTypeName:null,isAbstract:!1,autoGeneratedKeyType:null,defaultResourceName:null,dataProperties:o,navigationProperties:o,validators:null})},t._clientPropertyPathToServer=function(n){var t=this.metadataStore.namingConvention.clientPropertyNameToServer,i=this;return n.split(".").map(function(n){var r=i.getProperty(n);return t(n,r)}).join("/")},t._updateNames=function(n){var t=this.metadataStore.namingConvention;r(t,n,"name"),n.isNavigationProperty&&(r(t,n,"foreignKeyNames"),r(t,n,"invForeignKeyNames"))},t._checkNavProperty=function(n){if(n.isNavigationProperty){if(n.parentType!=this)throw new Error(a("The navigationProperty '%1' is not a property of entity type '%2'",n.name,this.name));return n}if(typeof n=="string"){var t=this.getProperty(n);if(t&&t.isNavigationProperty)return t}throw new Error("The 'navigationProperty' parameter must either be a NavigationProperty or the name of a NavigationProperty");},t._addDataProperty=function(n){this.dataProperties.push(n),n.isPartOfKey&&this.keyProperties.push(n),n.isComplexProperty&&this.complexProperties.push(n),n.concurrencyMode&&n.concurrencyMode!=="None"&&this.concurrencyProperties.push(n),n.isUnmapped&&this.unmappedProperties.push(n)},t._addNavigationProperty=function(n){this.navigationProperties.push(n),iu(n.entityTypeName)||(n.entityTypeName=hi(n.entityTypeName,this.namespace))},t._updateCps=function(){var n=this.metadataStore,t=n._incompleteComplexTypeMap;this.complexProperties.forEach(function(i){i.complexType||s(i,n)||pi(t,i.complexTypeName).push(i)}),this.isComplexType&&((t[this.name]||[]).forEach(function(t){s(t,n)}),delete t[this.name])},t._updateNps=function(){var n=this.metadataStore,t=n._incompleteTypeMap;this.navigationProperties.forEach(function(i){i.entityType||h(i,n)||pi(t,i.entityTypeName).push(i)}),(t[this.name]||[]).forEach(function(t){h(t,n)}),delete t[this.name]},u}(),at=function(){var i=function(n){if(arguments.length>1)throw new Error("The ComplexType ctor has a single argument that is a configuration object.");v(n).whereParam("shortName").isNonEmptyString().whereParam("namespace").isString().isOptional().withDefault("").whereParam("dataProperties").isOptional().whereParam("isComplexType").isOptional().isBoolean().applyAll(this),this.name=hi(this.shortName,this.namespace),this.isComplexType=!0,this.dataProperties=[],this.complexProperties=[],this.validators=[],this.concurrencyProperties=[],this.unmappedProperties=[],this.navigationProperties=[],this.keyProperties=[],sr(this,n.dataProperties,g)},t=i.prototype;return t.createInstance=function(n){var t=this._createInstanceCore();return n&&d(n,function(n,i){t.setProperty(n,i)}),t.complexAspect._postInitialize(),t},t._createInstanceCore=function(n,t){var r=this.getCtor(),i=new r;return new oi(i,n,t),n&&i.complexAspect._postInitialize(),i},t.addProperty=function(t){if(n(t,"dataProperty").isInstanceOf(g).check(),this.metadataStore&&!t.isUnmapped)throw new Error("The '"+this.name+"' ComplexType has already been added to a MetadataStore and therefore no additional properties may be added to it.");if(t.parentType)if(t.parentType!==this)throw new Error("This dataProperty has already been added to "+property.parentType.name);else return this;return this._addDataProperty(t),this},t.getProperties=function(){return this.dataProperties},t.addValidator=e.prototype.addValidator,t.getProperty=e.prototype.getProperty,t.getPropertyNames=e.prototype.getPropertyNames,t._addDataProperty=e.prototype._addDataProperty,t._updateNames=e.prototype._updateNames,t._updateCps=e.prototype._updateCps,t.getCtor=e.prototype.getEntityCtor,t._setCtor=e.prototype._setCtor,t.toJSON=function(){return pt(this,{shortName:null,namespace:null,isComplexType:null,dataProperties:null,validators:null})},t._$typeName="ComplexType",i}(),g=function(){var t=function(n){var r,t;if(v(n).whereParam("name").isString().isOptional().whereParam("nameOnServer").isString().isOptional().whereParam("dataType").isEnumOf(i).isOptional().or().isString().or().isInstanceOf(at).whereParam("complexTypeName").isOptional().whereParam("isNullable").isBoolean().isOptional().withDefault(!0).whereParam("defaultValue").isOptional().whereParam("isPartOfKey").isBoolean().isOptional().whereParam("isUnmapped").isBoolean().isOptional().whereParam("concurrencyMode").isString().isOptional().whereParam("maxLength").isNumber().isOptional().whereParam("validators").isInstanceOf(f).isArray().isOptional().withDefault([]).whereParam("enumType").isOptional().whereParam("rawTypeName").isOptional().whereParam("isScalar").isOptional().applyAll(this),r=!!(this.name||this.nameOnServer),!r)throw new Error("A DataProperty must be instantiated with either a 'name' or a 'nameOnServer' property");if(this.complexTypeName)this.isComplexProperty=!0,this.dataType=null;else if(typeof this.dataType=="string"){if(t=i.fromName(this.dataType),!t)throw new Error("Unable to find a DataType enumeration by the name of: "+this.dataType);this.dataType=t}else this.dataType||(this.dataType=i.String);if(this.defaultValue==null)if(this.isNullable)this.defaultValue=null;else if(!this.isComplexProperty)if(this.dataType===i.Binary)this.defaultValue="AAAAAAAAJ3U=";else if(this.defaultValue=this.dataType.defaultValue,this.defaultValue==null)throw new Error("A nonnullable DataProperty cannot have a null defaultValue. Name: "+this.name);this.isComplexProperty&&(this.isScalar=this.isScalar==null||this.isScalar===!0)},n=t.prototype;return n._$typeName="DataProperty",n.isDataProperty=!0,n.isNavigationProperty=!1,n.toJSON=function(){return pt(this,{name:null,dataType:function(n){return n&&n.parentEnum?n.name:undefined},complexTypeName:null,isNullable:!0,defaultValue:null,isPartOfKey:!1,isUnmapped:!1,concurrencyMode:null,maxLength:null,validators:null,enumType:null,rawTypeName:null,isScalar:null})},t.fromJSON=function(n){return n.dataType=i.fromName(n.dataType),n.defaultValue&&n.dataType&&n.dataType.isDate&&(n.defaultValue=new Date(Date.parse(n.defaultValue))),n.validators&&(n.validators=n.validators.map(f.fromJSON)),new g(n)},t}(),st=function(){var t=function(n){v(n).whereParam("name").isString().isOptional().whereParam("nameOnServer").isString().isOptional().whereParam("entityTypeName").isString().whereParam("isScalar").isBoolean().whereParam("associationName").isString().isOptional().whereParam("foreignKeyNames").isArray().isString().isOptional().withDefault([]).whereParam("foreignKeyNamesOnServer").isArray().isString().isOptional().withDefault([]).whereParam("invForeignKeyNames").isArray().isString().isOptional().withDefault([]).whereParam("invForeignKeyNamesOnServer").isArray().isString().isOptional().withDefault([]).whereParam("validators").isInstanceOf(f).isArray().isOptional().withDefault([]).applyAll(this);var t=!!(this.name||this.nameOnServer);if(!t)throw new Error("A Navigation property must be instantiated with either a 'name' or a 'nameOnServer' property");},n=t.prototype;return n._$typeName="NavigationProperty",n.isDataProperty=!1,n.isNavigationProperty=!0,n.toJSON=function(){return pt(this,{name:null,entityTypeName:null,isScalar:null,associationName:null,validators:null,foreignKeyNames:null,invForeignKeyNames:null})},t.fromJSON=function(n){return n.validators&&(n.validators=n.validators.map(f.fromJSON)),new st(n)},t}(),it=function(){var n=new ft("AutoGeneratedKeyType");return n.None=n.addSymbol(),n.Identity=n.addSymbol(),n.KeyGenerator=n.addSymbol(),n.seal(),n}();(function(){function t(n,t){return t==null?!1:t.entityType!==undefined}function i(n,t){return t==null?!1:t.isDataProperty||t.isNavigationProperty}var n=di.prototype;n.isEntity=function(){return this._addContext({fn:t,msg:" must be an entity"})},n.isEntityProperty=function(){return this._addContext({fn:i,msg:" must be either a DataProperty or a NavigationProperty"})}})(),t.MetadataStore=dt,t.EntityType=e,t.ComplexType=at,t.DataProperty=g,t.NavigationProperty=st,t.AutoGeneratedKeyType=it,dt.normalizeTypeName=tu.normalizeTypeName,hr=function(){function i(n,t,i){var u=t.name+".."+t.parentType.name,r=n._tempIdMap[u];return r||i&&(r={entityType:t.parentType,propertyName:t.name,keyMap:{}},n._tempIdMap[u]=r),r}var n=function(){this._tempIdMap={}},t=n.prototype;return t.generateTempKeyValue=function(n,t){var o=n.keyProperties,e,f,r,u;if(o.length>1)throw new Error("Ids can not be autogenerated for entities with multipart keys");if(e=o[0],f=i(this,e,!0),t!=null&&(f.keyMap[t.toString()]||(r=t)),r===undefined)if(u=e.dataType,u.getNext)for(r=u.getNext(this);f.keyMap[r.toString()]!=null;)r=u.getNext(this);else throw new Error("Cannot use a property with a dataType of: "+u.toString()+" for id generation");return f.keyMap[r.toString()]=!0,r},t.getTempKeys=function(){var t=[],i,n,r,u;for(i in this._tempIdMap){n=this._tempIdMap[i],r=n.entityType;for(u in n.keyMap)t.push(new o(r,[u]))}return t},t.isTempKey=function(n){var r=n.entityType.keyProperties,u,t;return r.length>1?!1:(u=r[0],t=i(this,u),!t)?!1:t.keyMap[n.values[0].toString()]!==undefined},l.registerType(n,"KeyGenerator"),n}(),t.KeyGenerator=hr,gt=function(){var n=function(n){v(n||{}).whereParam("name").isOptional().isString().whereParam("isCaseSensitive").isOptional().isBoolean().whereParam("usesSql92CompliantStringComparison").isBoolean().applyAll(this),this.name||(this.name=fi()),l._storeObject(this,t._$typeName,this.name)},t=n.prototype;return t._$typeName="LocalQueryComparisonOptions",n.caseInsensitiveSQL=new n({name:"caseInsensitiveSQL",isCaseSensitive:!1,usesSql92CompliantStringComparison:!0}),n.defaultInstance=new n(n.caseInsensitiveSQL),t.setAsDefault=function(){return ri(this,n)},n}(),t.LocalQueryComparisonOptions=gt,ni=function(){var n=function(n){v(n||{}).whereParam("name").isOptional().isString().whereParam("serverPropertyNameToClient").isFunction().whereParam("clientPropertyNameToServer").isFunction().applyAll(this),this.name||(this.name=fi()),l._storeObject(this,t._$typeName,this.name)},t=n.prototype;return t._$typeName="NamingConvention",n.none=new n({name:"noChange",serverPropertyNameToClient:function(n){return n},clientPropertyNameToServer:function(n){return n}}),n.camelCase=new n({name:"camelCase",serverPropertyNameToClient:function(n){return n.substr(0,1).toLowerCase()+n.substr(1)},clientPropertyNameToServer:function(n){return n.substr(0,1).toUpperCase()+n.substr(1)}}),n.defaultInstance=new n(n.none),t.setAsDefault=function(){return ri(this,n)},n}(),t.NamingConvention=ni;var nt=function(){function u(n,t,i,r){var o=i._$typeName||i.parentEnum&&i.parentEnum.name,f=o&&o.substr(0,1).toLowerCase()+o.substr(1),e;if(r&&f!=r)throw new Error("Invalid value for property: "+r);if(f)if(e=t[f],e===undefined)throw new Error("Invalid config property: "+f);else e===null?n[f]=i:e(n,i);else d(i,function(i,r){u(n,t,r,i)})}function r(t){return n(t,"propertyPaths").isOptional().isString().or().isArray().isString().check(),typeof t=="string"&&(t=t.split(",")),t=t.map(function(n){return n.trim()})}function l(n){var t=n.entityType,i=t.keyProperties.map(function(t){return p.create(t.name,y.Equals,n.getProperty(t.name))});return p.and(i)}function f(n,t,i){var u,r=n._clone();return t?(u=li.create(t,i),r.orderByClause?r.orderByClause.addClause(u):r.orderByClause=u,r):(r.orderByClause=null,r)}function v(n,t){var i=n._clone();return t?(i.selectClause=new cu(t),i):(i.selectClause=null,i)}function w(n,t){var i=n._clone();return t?(i.expandClause=new lu(t),i):(i.expandClause=null,i)}function b(n,t){var i=n._clone();return i.parameters=t,i}function s(n){var t=n.entityType.keyProperties,i=yi(t,n.values,function(n,t){return p.create(n.name,y.Equals,t)});return p.and(i)}function k(n,t){var u,f,i,r,e,h;return t.isScalar?t.foreignKeyNames.length===0?null:(u=t.foreignKeyNames.map(function(t){return n.getProperty(t)}),f=new o(t.entityType,u),s(f)):(i=t.inverse,r=i?i.foreignKeyNames:t.invForeignKeyNames,r.length===0)?null:(e=n.entityAspect.getKey().values,h=yi(r,e,function(n,t){return p.create(n,y.Equals,t)}),p.and(h))}var i=function(t){n(t,"resourceName").isOptional().isString().check(),this.resourceName=t,this.entityType=null,this.wherePredicate=null,this.orderByClause=null,this.selectClause=null,this.skipCount=null,this.takeCount=null,this.expandClause=null,this.parameters={},this.inlineCountEnabled=!1,this.entityManager=null},t=i.prototype;return t._$typeName="EntityQuery",t.from=function(t){var i,r;if(n(t,"resourceName").isString().check(),i=this.resourceName,i&&i!==t)throw new Error("This query already has an resourceName - the resourceName may only be set once per query");return r=this._clone(),r.resourceName=t,r},i.from=function(t){return n(t,"resourceName").isString().check(),new nt(t)},t.toType=function(t){n(t,"entityType").isString().or().isInstanceOf(e).check();var i=this._clone();return i.toEntityType=t,i},t.where=function(n){var t=this._clone(),i;return arguments.length===0?(t.wherePredicate=null,t):(i=p.isPredicate(n)?n:p.create(c(arguments)),t.entityType&&i.validate(t.entityType),t.wherePredicate=t.wherePredicate?new ci("and",[t.wherePredicate,i]):i,t)},t.orderBy=function(n){return f(this,r(n))},t.orderByDesc=function(n){return f(this,r(n),!0)},t.select=function(n){return v(this,r(n))},t.skip=function(t){n(t,"count").isOptional().isNumber().check();var i=this._clone();return i.skipCount=arguments.length===0?null:t,i},t.top=function(n){return this.take(n)},t.take=function(t){n(t,"count").isOptional().isNumber().check();var i=this._clone();return i.takeCount=arguments.length===0?null:t,i},t.expand=function(n){return w(this,r(n))},t.withParameters=function(t){return n(t,"parameters").isObject().check(),b(this,t)},t.inlineCount=function(n){n===undefined&&(n=!0);var t=this._clone();return t.inlineCountEnabled=n,t},t.using=function(n){if(!n)return this;var t=this._clone();return u(t,{entityManager:null,dataService:null,queryOptions:null,fetchStrategy:function(n,t){n.queryOptions=(n.queryOptions||new rt).using(t)},mergeStrategy:function(n,t){n.queryOptions=(n.queryOptions||new rt).using(t)},jsonResultsAdapter:function(n,t){n.dataService=(n.dataService||new h).using({jsonResultsAdapter:t})}},n),t},t.execute=function(n,t){if(!this.entityManager)throw new Error("An EntityQuery must have its EntityManager property set before calling 'execute'");return this.entityManager.executeQuery(this,n,t)},t.executeLocally=function(){if(!this.entityManager)throw new Error("An EntityQuery must have its EntityManager property set before calling 'executeLocally'");return this.entityManager.executeQueryLocally(this)},i.fromEntities=function(t){var r;n(t,"entities").isEntity().or().isNonEmptyArray().isEntity().check(),Array.isArray(t)||(t=c(arguments));var u=t[0],i=new nt(u.entityType.defaultResourceName),f=t.map(function(n){return l(n)}),e=p.or(f);return i=i.where(e),r=u.entityAspect.entityManager,r&&(i=i.using(r)),i},i.fromEntityKey=function(t){n(t,"entityKey").isInstanceOf(o).check();var i=new nt(t.entityType.defaultResourceName),r=s(t);return i=i.where(r)},i.fromEntityNavigation=function(t,i){var u;n(t,"entity").isEntity().check(),n(i,"navigationProperty").isInstanceOf(st).check();var f=t.entityType._checkNavProperty(i),r=new nt(f.entityType.defaultResourceName),e=k(t,f);return r=r.where(e),u=t.entityAspect.entityManager,u&&(r=r.using(u)),r},t._getFromEntityType=function(n,t){var i=this.entityType,r,u;if(i)return i;if(r=this.resourceName,!r)throw new Error("There is no resourceName for this query");if(n.isEmpty())if(t)throw new Error("There is no metadata available for this query");else return null;if(u=n.getEntityTypeNameForResourceName(r),i=u?n._getEntityType(u):this._getToEntityType(n,!0),!i)if(t)throw new Error(a("Cannot find an entityType for resourceName: '%1'.  Consider adding an 'EntityQuery.toType' call to your query or calling the MetadataStore.setEntityTypeForResourceName method to register an entityType for this resourceName.",r));else return null;return this.entityType=i,i},t._getToEntityType=function(n,t){return this.toEntityType instanceof e?this.toEntityType:this.toEntityType?this.toEntityType=n._getEntityType(this.toEntityType,!1):t?null:!this.selectClause&&this._getFromEntityType(n,!1)},t._clone=function(){var n=new nt;return n.resourceName=this.resourceName,n.entityType=this.entityType,n.wherePredicate=this.wherePredicate,n.orderByClause=this.orderByClause,n.selectClause=this.selectClause,n.skipCount=this.skipCount,n.takeCount=this.takeCount,n.expandClause=this.expandClause,n.inlineCountEnabled=this.inlineCountEnabled,n.parameters=ut({},this.parameters),n.queryOptions=this.queryOptions,n.entityManager=this.entityManager,n.dataService=this.dataService,n.toEntityType=this.toEntityType,n},t._toUri=function(n){function f(){var n=t.wherePredicate;return n?(t.entityType&&n.validate(t.entityType),n.toOdataFragment(r)):""}function o(){return t.inlineCountEnabled?t.inlineCountEnabled?"allpages":"none":""}function s(){var n=t.orderByClause;return n?(t.entityType&&n.validate(t.entityType),n.toOdataFragment(r)):""}function h(){var n=t.selectClause;return n?(t.entityType&&n.validate(t.entityType),n.toOdataFragment(r)):""}function c(){var n=t.expandClause;return n?n.toOdataFragment(r):""}function l(){var n=t.skipCount;return n?n.toString():""}function a(){var n=t.takeCount;return n?n.toString():""}function v(n){var t=[],i,r;for(i in n)r=n[i],r&&t.push(i+"="+encodeURIComponent(r));return t.length>0?"?"+t.join("&"):""}var r=this._getFromEntityType(n,!1),t,i,u;return r||(r=new e(n)),t=this,i={},i.$filter=f(),i.$orderby=s(),i.$skip=l(),i.$top=a(),i.$expand=c(),i.$select=h(),i.$inlinecount=o(),i=ut(i,this.parameters),u=v(i),this.resourceName+u},t._toFilterFunction=function(n){var t=this.wherePredicate;return t?(t.validate(n),t.toFunction(n)):null},t._toOrderByComparer=function(n){var t=this.orderByClause;return t?t.getComparer(n):null},i}(),hu=function(){return{toupper:{fn:function(n){return n.toUpperCase()},dataType:i.String},tolower:{fn:function(n){return n.toLowerCase()},dataType:i.String},substring:{fn:function(n,t,i){return n.substring(t,i)},dataType:i.String},substringof:{fn:function(n,t){return t.indexOf(n)>=0},dataType:i.Boolean},length:{fn:function(n){return n.length},dataType:i.Int32},trim:{fn:function(n){return n.trim()},dataType:i.String},concat:{fn:function(n,t){return n.concat(t)},dataType:i.String},replace:{fn:function(n,t,i){return n.replace(t,i)},dataType:i.String},startswith:{fn:function(n,t){return lt(n,t)},dataType:i.Boolean},endswith:{fn:function(n,t){return or(n,t)},dataType:i.Boolean},indexof:{fn:function(n,t){return n.indexOf(t)},dataType:i.Int32},round:{fn:function(n){return Math.round(n)},dataType:i.Int32},ceiling:{fn:function(n){return Math.ceil(n)},dataType:i.Int32},floor:{fn:function(n){return Math.floor(n)},dataType:i.Int32},second:{fn:function(n){return n.second},dataType:i.Int32},minute:{fn:function(n){return n.minute},dataType:i.Int32},day:{fn:function(n){return n.day},dataType:i.Int32},month:{fn:function(n){return n.month},dataType:i.Int32},year:{fn:function(n){return n.year},dataType:i.Int32}}}(),ti=function(){function e(n){var t=n.split(".");return t.length===1?function(t){return t.getProperty(n)}:function(n){return tr(n,t)}}var r=/^[a-z_][\w.$]*$/i,u=/('[^']*'|[^,]+)/g,f=/("[^"]*"|[^,]+)/g,t=function(n,t,o){var c=n.split(":"),s,l,y,p,w,a,v,h,b,k;if(o&&(this.isValidated=!0),c.length==1)if(s=c[0].trim(),this.value=s,l=s.substr(0,1),y=l=="'"||l=='"',y)p=s.substr(1,s.length-2),this.fn=function(){return p},this.dataType=i.String;else if(w=r.test(s),w){if(o&&o.getProperty(s,!1)==null){this.isValidated=!1;return}this.propertyPath=s,this.fn=e(s)}else{if(o){this.isValidated=!1;return}this.fn=function(){return s},this.dataType=i.fromValue(s)}else try{this.fnName=c[0].trim().toLowerCase(),a=hu[this.fnName],this.localFn=a.fn,this.dataType=a.dataType,v=this,this.fn=function(n){var t=v.fnNodes.map(function(t){return t.fn(n)});return v.localFn.apply(null,t)},h=t[c[1]].trim(),h.substr(0,1)=="("&&(h=h.substr(1,h.length-2)),b=n.indexOf("'")>=0?u:f,k=h.match(b),this.fnNodes=k.map(function(n){return new ti(n,t)})}catch(d){this.isValidated=!1}},n=t.prototype;return t.create=function(n,t,r){var f,s,u;if(typeof n!="string")return null;for(var h=/\([^()]*\)/,e,o=[],c=0;e=h.exec(n);)f=e[0],o.push(f),s=":"+c++,n=n.replace(f,s);return u=new ti(n,o,t),!u.dataType&&r&&r.isStringFn&&(u.dataType=i.String),u.isValidated===!1?null:u},n.toString=function(){if(this.fnName){var n=this.fnNodes.map(function(n){return n.toString()});return this.fnName+"("+n.join(",")+")"}return this.value},n.updateWithEntityType=function(n){var t,i;if(this.propertyPath){if(n.isAnonymous)return;if(t=n.getProperty(this.propertyPath),!t){i=a("Unable to resolve propertyPath.  EntityType: '%1'   PropertyPath: '%2'",n.name,this.propertyPath);throw new Error(i);}this.dataType=t.dataType}},n.toOdataFragment=function(n){var i,r,t;return this.updateWithEntityType(n),this.fnName?(i=this.fnNodes.map(function(t){return t.toOdataFragment(n)}),r=this.fnName+"("+i.join(",")+")",r):(t=this.value.substr(0,1),t==="'"||t==='"'?this.value:this.value==this.propertyPath?n._clientPropertyPathToServer(this.propertyPath):this.value)},n.validate=function(n){if(this.isValidated===undefined)if(this.isValidated=!0,this.propertyPath){var t=n.getProperty(this.propertyPath,!0);this.dataType=t.isDataProperty?t.dataType:t.entityType}else this.fnNodes&&this.fnNodes.forEach(function(t){t.validate(n)})},t}(),y=function(){var n=new ft("FilterQueryOp");return n.Equals=n.addSymbol({operator:"eq",aliases:["=="]}),n.NotEquals=n.addSymbol({operator:"ne",aliases:["!="]}),n.GreaterThan=n.addSymbol({operator:"gt",aliases:[">"]}),n.LessThan=n.addSymbol({operator:"lt",aliases:["<"]}),n.GreaterThanOrEqual=n.addSymbol({operator:"ge",aliases:[">="]}),n.LessThanOrEqual=n.addSymbol({operator:"le",aliases:["<="]}),n.Contains=n.addSymbol({operator:"substringof",isFunction:!0,isStringFn:!0}),n.StartsWith=n.addSymbol({operator:"startswith",isFunction:!0,isStringFn:!0}),n.EndsWith=n.addSymbol({operator:"endswith",isFunction:!0,isStringFn:!0}),n.IsTypeOf=n.addSymbol({operator:"isof",isFunction:!0,aliases:["isTypeOf"]}),n.seal(),n._map=function(){var t={};return n.getSymbols().forEach(function(n){t[n.name.toLowerCase()]=n,t[n.operator.toLowerCase()]=n,n.aliases&&n.aliases.forEach(function(i){t[i.toLowerCase()]=n})}),t}(),n.from=function(t){return n.contains(t)?t:n._map[t.toLowerCase()]},n}(),gi=function(){var n=new ft("BooleanQueryOp");return n.And=n.addSymbol({operator:"and",aliases:["&&"]}),n.Or=n.addSymbol({operator:"or",aliases:["||"]}),n.Not=n.addSymbol({operator:"not",aliases:["~","!"]}),n.seal(),n._map=function(){var t={};return n.getSymbols().forEach(function(n){t[n.name.toLowerCase()]=n,t[n.operator.toLowerCase()]=n,n.aliases&&n.aliases.forEach(function(i){t[i.toLowerCase()]=n})}),t}(),n.from=function(t){return n.contains(t)?t:n._map[t.toLowerCase()]},n}(),p=function(){function t(n){if(n.length===1&&Array.isArray(n[0]))return n[0];var t=c(n);return p.isPredicate(t[0])?t:[p.create(t)]}var n=function(n,t,i,r){return arguments[0].prototype===!0?this:new cr(n,t,i,r)},i=n.prototype;return n.isPredicate=function(n){return n instanceof p},n.create=function(n,t,i,r){return Array.isArray(n)?(r=n.length===4?n[3]:!1,new cr(n[0],n[1],n[2],r)):new cr(n,t,i,r)},n.and=function(n){return n=t(arguments),n.length===1?n[0]:new ci("and",n)},n.or=function(n){return n=t(arguments),n.length===1?n[0]:new ci("or",n)},n.not=function(n){return new ci("not",[n])},i.and=function(i){return i=t(arguments),i.unshift(this),n.and(i)},i.or=function(i){return i=t(arguments),i.unshift(this),n.or(i)},i.not=function(){return new ci("not",[this])},n}(),cr=function(){function f(n,t,i){var h=n.metadataStore.localQueryComparisonOptions,r=ru(i),f;switch(t){case y.Equals:f=function(n,t){return n&&typeof n=="string"?u(n,t,h):r(n)==r(t)};break;case y.NotEquals:f=function(n,t){return n&&typeof n=="string"?!u(n,t,h):r(n)!=r(t)};break;case y.GreaterThan:f=function(n,t){return r(n)>r(t)};break;case y.GreaterThanOrEqual:f=function(n,t){return r(n)>=r(t)};break;case y.LessThan:f=function(n,t){return r(n)<r(t)};break;case y.LessThanOrEqual:f=function(n,t){return r(n)<=r(t)};break;case y.StartsWith:f=function(n,t){return e(n,t,h)};break;case y.EndsWith:f=function(n,t){return o(n,t,h)};break;case y.Contains:f=function(n,t){return s(n,t,h)};break;default:throw new Error("Unknown FilterQueryOp: "+t);}return f}function u(n,t,i){return t==null?!1:(typeof t!="string"&&(t=t.toString()),i.usesSql92CompliantStringComparison&&(n=(n||"").trim(),t=(t||"").trim()),i.isCaseSensitive||(n=(n||"").toLowerCase(),t=(t||"").toLowerCase()),n==t)}function e(n,t,i){return i.isCaseSensitive||(n=(n||"").toLowerCase(),t=(t||"").toLowerCase()),lt(n,t)}function o(n,t,i){return i.isCaseSensitive||(n=(n||"").toLowerCase(),t=(t||"").toLowerCase()),or(n,t)}function s(n,t,i){return i.isCaseSensitive||(n=(n||"").toLowerCase(),t=(t||"").toLowerCase()),n.indexOf(t)>=0}var r=function(t,i,r,u){if(n(t,"propertyOrExpr").isString().isOptional().check(),n(i,"operator").isEnumOf(y).or().isString().check(),n(r,"value").isRequired(!0).check(),n(u).isOptional().isBoolean().check(),this._filterQueryOp=y.from(i),!this._filterQueryOp)throw new Error("Unknown query operation: "+i);if(t)this._propertyOrExpr=t,this._fnNode1=ti.create(t,null,this._filterQueryOp);else if(this._filterQueryOp!==y.IsTypeOf)throw new Error("propertyOrExpr cannot be null except when using the 'IsTypeOf' operator");this._value=r,this._valueIsLiteral=u},t=new p({prototype:!0});return r.prototype=t,t.toOdataFragment=function(n){var u,f,r,t,e;return this._filterQueryOp==y.IsTypeOf?(u=n.metadataStore.getEntityType(this._value),f=u.namespace+"."+u.shortName,this._filterQueryOp.operator+"("+i.String.fmtOData(f)+")"):(r=this._fnNode1&&this._fnNode1.toOdataFragment(n),this.fnNode2!==undefined||this._valueIsLiteral||(this.fnNode2=ti.create(this._value,n)),this.fnNode2?t=this.fnNode2.toOdataFragment(n):(e=this._fnNode1.dataType||i.fromValue(this._value),t=e.fmtOData(this._value)),this._filterQueryOp.isFunction?this._filterQueryOp==y.Contains?this._filterQueryOp.operator+"("+t+","+r+") eq true":this._filterQueryOp.operator+"("+r+","+t+") eq true":r+" "+this._filterQueryOp.operator+" "+t)},t.toFunction=function(n){var o=this._fnNode1.dataType||i.fromValue(this._value),t=f(n,this._filterQueryOp,o),r=this._fnNode1.fn,u,e;return this.fnNode2!==undefined||this._valueIsLiteral||(this.fnNode2=ti.create(this._value,n)),this.fnNode2?(u=this.fnNode2.fn,function(n){return t(r(n),u(n))}):(e=this._value,function(n){return t(r(n),e)})},t.toString=function(){return a("{%1} %2 {%3}",this._propertyOrExpr,this._filterQueryOp.operator,this._value)},t.validate=function(n){this._fnNode1&&(this._fnNode1.validate(n),this.dataType=this._fnNode1.dataType)},r}(),ci=function(){function i(n,t,i){var u,r;switch(t){case gi.Not:return u=i[0].toFunction(n),function(n){return!u(n)};case gi.And:return r=i.map(function(t){return t.toFunction(n)}),function(n){return r.reduce(function(t,i){return t&&i(n)},!0)};case gi.Or:return r=i.map(function(t){return t.toFunction(n)}),function(n){return r.reduce(function(t,i){return t||i(n)},!1)};default:throw new Error("Invalid boolean operator:"+t);}}var t=function(n,t){if(!Array.isArray(t))throw new Error("predicates parameter must be an array");if(this.symbol==="not"&&t.length!==1)throw new Error("Only a single predicate can be passed in with the 'Not' operator");if(this._booleanQueryOp=gi.from(n),!this._booleanQueryOp)throw new Error("Unknown query operation: "+n);this._predicates=t},n=new p({prototype:!0});return t.prototype=n,n.toOdataFragment=function(n){return this._predicates.length==1?this._booleanQueryOp.operator+" ("+this._predicates[0].toOdataFragment(n)+")":this._predicates.map(function(t){return"("+t.toOdataFragment(n)+")"}).join(" "+this._booleanQueryOp.operator+" ")},n.toFunction=function(n){return i(n,this._booleanQueryOp,this._predicates)},n.toString=function(){return this._predicates.length==1?this._booleanQueryOp.operator+" ("+this._predicates[0]+")":this._predicates.map(function(n){return"("+n.toString()+")"}).join(" "+this._booleanQueryOp.operator+" ")},n.validate=function(n){this._isValidated||(this._predicates.every(function(t){t.validate(n)}),this._isValidated=!0)},t}(),li=function(){var n=function(t,i){return t.prototype===!0?this:n.create(t,i)},t=n.prototype;return n.create=function(n,t){if(n.length>1){var i=n.map(function(n){return new lr(n,t)});return new nr(i)}return new lr(n[0],t)},n.combine=function(n){return new nr(n)},n.isOrderByClause=function(n){return n instanceof li},t.addClause=function(n){return new nr([this,n])},n}(),lr=function(){var t=function(n,t){var i,r;if(!(typeof n=="string"))throw new Error("propertyPath is not a string");if(n=n.trim(),i=n.split(" "),i.length>1&&t!==!0&&t!==!1&&(t=lt(i[1].toLowerCase(),"desc"),!t&&(r=lt(i[1].toLowerCase(),"asc"),!r)))throw new Error("the second word in the propertyPath must begin with 'desc' or 'asc'");this.propertyPath=i[0],this.isDesc=t},n=new li({prototype:!0});return t.prototype=n,n.validate=function(n){n&&(this.lastProperty=n.getProperty(this.propertyPath,!0))},n.toOdataFragment=function(n){return n._clientPropertyPathToServer(this.propertyPath)+(this.isDesc?" desc":"")},n.getComparer=function(n){var t,r;this.lastProperty||this.validate(n),this.lastProperty&&(t=this.lastProperty.dataType,r=this.lastProperty.parentType.metadataStore.localQueryComparisonOptions.isCaseSensitive);var u=this.propertyPath,f=this.isDesc,e=this;return function(n,e){var o=tr(n,u),s=tr(e,u),c=t||o&&i.fromValue(o)||i.fromValue(s),h;return c===i.String?r?(o=o||"",s=s||""):(o=(o||"").toLowerCase(),s=(s||"").toLowerCase()):(h=ru(c),o=h(o),s=h(s)),o==s?0:o>s||s===undefined?f?-1:1:f?1:-1}},t}(),nr=function(){var t=function(n){var t=[];n.forEach(function(n){if(n instanceof nr)t=t.concat(n.orderByClauses);else if(n instanceof lr)t.push(n);else throw new Error("Invalid argument to CompositeOrderByClause ctor.");}),this._orderByClauses=t},n=new li({prototype:!0});return t.prototype=n,n.validate=function(n){this._orderByClauses.forEach(function(t){t.validate(n)})},n.toOdataFragment=function(n){var t=this._orderByClauses.map(function(t){return t.toOdataFragment(n)});return t.join(",")},n.getComparer=function(n){var t=this._orderByClauses.map(function(t){return t.getComparer(n)});return function(n,i){for(var u,r=0;r<t.length;r++)if(u=t[r](n,i),u!=0)return u;return 0}},t}(),cu=function(){var t=function(n){this.propertyPaths=n,this._pathNames=n.map(function(n){return n.replace(".","_")})},n=t.prototype;return n.validate=function(n){n&&this.propertyPaths.forEach(function(t){n.getProperty(t,!0)})},n.toOdataFragment=function(n){return this.propertyPaths.map(function(t){return n._clientPropertyPathToServer(t)}).join(",")},n.toFunction=function(){var t=this;return function(n){var i={};return t.propertyPaths.forEach(function(r,u){i[t._pathNames[u]]=tr(n,r)}),i}},t}(),lu=function(){var n=function(n){this.propertyPaths=n},t=n.prototype;return t.toOdataFragment=function(n){return this.propertyPaths.map(function(t){return n._clientPropertyPathToServer(t)}).join(",")},n}();t.FilterQueryOp=y,t.Predicate=p,t.EntityQuery=nt,t.FnNode=ti,t.OrderByClause=li;var et=function(){var n=new ft("MergeStrategy");return n.PreserveChanges=n.addSymbol(),n.OverwriteChanges=n.addSymbol(),n.seal(),n}(),ii=function(){var n=new ft("FetchStrategy");return n.FromServer=n.addSymbol(),n.FromLocalCache=n.addSymbol(),n.seal(),n}(),rt=function(){function i(n,t){return t&&v(t).whereParam("fetchStrategy").isEnumOf(ii).isOptional().whereParam("mergeStrategy").isEnumOf(et).isOptional().applyAll(n),n}var n=function(n){i(this,n)},t=n.prototype;return t._$typeName="QueryOptions",n.resolve=function(n){return new rt(pr(n,["fetchStrategy","mergeStrategy"]))},n.defaultInstance=new n({fetchStrategy:ii.FromServer,mergeStrategy:et.PreserveChanges}),t.using=function(n){if(!n)return this;var t=new rt(this);return et.contains(n)?n={mergeStrategy:n}:ii.contains(n)&&(n={fetchStrategy:n}),i(t,n)},t.setAsDefault=function(){return ri(this,n)},t.toJSON=function(){return pt(this,{fetchStrategy:null,mergeStrategy:null})},n.fromJSON=function(n){return new rt({fetchStrategy:ii.fromName(n.fetchStrategy),mergeStrategy:et.fromName(n.mergeStrategy)})},n}();return t.QueryOptions=rt,t.FetchStrategy=ii,t.MergeStrategy=et,uu=function(){function i(n){if(n){if(n.length===1){var t=n[0];return function(n){return n?n.entityAspect.entityState===t:!1}}return function(t){return t?n.some(function(n){return t.entityAspect.entityState===n}):!1}}return function(n){return!!n}}var r=i([u.Added,u.Modified,u.Deleted]),t=function(n,t){this.entityManager=n,this.entityType=t,this._indexMap={},this._entities=[],this._emptyIndexes=[]},n=t.prototype;return n.attachEntity=function(n,t){var i,r=n.entityAspect,u=r.getKey()._keyInGroup;if(i=this._indexMap[u],i>=0){if(this._entities[i]===n)return r.entityState=t,n;throw new Error("This key is already attached: "+r.getKey());}return this._emptyIndexes.length===0?i=this._entities.push(n)-1:(i=this._emptyIndexes.pop(),this._entities[i]=n),this._indexMap[u]=i,r.entityState=t,r.entityGroup=this,r.entityManager=this.entityManager,n},n.detachEntity=function(n){var r=n.entityAspect,i=r.getKey()._keyInGroup,t=this._indexMap[i];if(t===undefined)throw new Error("internal error - entity cannot be found in group");return delete this._indexMap[i],this._emptyIndexes.push(t),this._entities[t]=null,n},n.findEntityByKey=function(n){var t,i;return t=n instanceof o?n._keyInGroup:o.createKeyString(n),i=this._indexMap[t],i!==undefined?this._entities[i]:null},n.hasChanges=function(){return this._entities.some(r)},n.getEntities=function(n){var t=i(n);return this._entities.filter(t)},n._clear=function(){this._entities.forEach(function(n){n!=null&&n.entityAspect._detach()}),this._entities=null,this._indexMap=null,this._emptyIndexes=null},n._fixupKey=function(n,t){var r=this._indexMap[n],i,u;if(r===undefined)throw new Error("Internal Error in key fixup - unable to locate entity");i=this._entities[r],u=i.entityType.keyProperties[0].name,i.setProperty(u,t),delete i.entityAspect.hasTempKey,delete this._indexMap[n],this._indexMap[t]=r},n._replaceKey=function(n,t){var i=this._indexMap[n._keyInGroup];delete this._indexMap[n._keyInGroup],this._indexMap[t._keyInGroup]=i},t}(),ar=function(){function pt(n,t,i){var u=i?rt.defaultInstance:n.queryOptions,f=i?vt.defaultInstance:n.saveOptions,e=i?kt.defaultInstance:n.validationOptions,r=v(t).whereParam("serviceName").isOptional().isString().whereParam("dataService").isOptional().isInstanceOf(h).whereParam("queryOptions").isInstanceOf(rt).isOptional().withDefault(u).whereParam("saveOptions").isInstanceOf(vt).isOptional().withDefault(f).whereParam("validationOptions").isInstanceOf(kt).isOptional().withDefault(e).whereParam("keyGeneratorCtor").isFunction().isOptional();i&&(r=r.whereParam("metadataStore").isInstanceOf(dt).isOptional().withDefault(new dt)),r.applyAll(n),vi(n.queryOptions,u),vi(n.saveOptions,f),vi(n.validationOptions,e),t.serviceName&&(n.dataService=new h({serviceName:n.serviceName})),n.serviceName=n.dataService&&n.dataService.serviceName,n.keyGeneratorCtor=n.keyGeneratorCtor||hr,(i||t.keyGeneratorCtor)&&(n.keyGenerator=new n.keyGeneratorCtor)}function di(n,t){if(n.length!==t.length)return!1;for(var i=0,r=n.length;i<r;i++)if(n[i]!==t[i])return!1;return!0}function p(t,i){return n(i,"entityTypes").isString().isOptional().or().isNonEmptyArray().isString().or().isInstanceOf(e).or().isNonEmptyArray().isInstanceOf(e).check(),typeof i=="string"?i=t.metadataStore._getEntityType(i,!1):Array.isArray(i)&&typeof i[0]=="string"&&(i=i.map(function(n){return t.metadataStore._getEntityType(n,!1)})),i}function w(n,t,i){var u=ni(n,t),r;return u.forEach(function(n){if(n){var t=n.getEntities(i);r?r.push.apply(r,t):r=t}}),r||[]}function wt(n,t){if(t[0]instanceof o)return{entityKey:t[0],remainingArgs:c(t,1)};if(typeof t[0]=="string"&&t.length>=2){var i=n.metadataStore._getEntityType(t[0],!1);return{entityKey:new o(i,t[1]),remainingArgs:c(t,2)}}throw new Error("This method requires as its initial parameters either an EntityKey or an entityType name followed by a value or an array of values.");}function bt(n,t){n.forEach(function(n){n.entityAspect.isBeingSaved=t})}function gi(n,t){var i,r,u;return t?(i={},t.forEach(function(n){var t=i[n.entityType.name];t||(t={},t.entityType=n.entityType,t._entities=[],i[n.entityType.name]=t),t._entities.push(n)})):i=n._entityGroupMap,r=[],u={},d(i,function(n,t){u[n]=nr(t,r)}),{entityGroupMap:u,tempKeys:r}}function nr(n,t){var i={},u=n.entityType,f=u.dataProperties,r=[];return n._entities.forEach(function(n){if(n){var i=g(n,f,t);r.push(i)}}),i.entities=r,i}function g(n,t,i){var u={},r,f,e;return t.forEach(function(t){var r=t.name,i=n.getProperty(r),e,f;(i!=null||t.defaultValue!=null)&&(i&&i.complexType?(f=t.dataType.dataProperties,u[r]=Array.isArray(i)?i.length==0?[]:i.map(function(n){return g(n,f)}):g(i,f)):u[r]=i)}),n.entityAspect?(r=n.entityAspect,e=r.entityState,f={tempNavPropNames:tr(r,i),entityState:e.name},(e.isModified()||e.isDeleted())&&(f.originalValuesMap=r.originalValues),u.entityAspect=f):(r=n.complexAspect,f={},r.originalValues&&!ei(r.originalValues)&&(f.originalValuesMap=r.originalValues),u.complexAspect=f),u}function tr(n,t){var r=n.entity,i;return n.hasTempKey&&t.push(n.getKey().toJSON()),r.entityType.navigationProperties.forEach(function(n){if(n.relatedDataProperties){var t=r.getProperty(n.name);t&&t.entityAspect.hasTempKey&&(i=i||[],i.push(n.name))}}),i}function ir(n,t,i){var h=i.tempKeyMap,e=n.entityType,l=i.mergeStrategy===et.OverwriteChanges,r=null,c=e.dataProperties,a=e.keyProperties,s=n.entityManager.entityChanged;t.entities.forEach(function(t){var a=t.entityAspect,y=ft(t,e,!0),i=u.fromName(a.entityState),v,p;i.isAdded()?(v=h[y.toString()],r=v===undefined?n.findEntityByKey(y):null):r=n.findEntityByKey(y),r?(p=r.entityAspect.entityState.isUnchanged(),l||p?(f(r,t,c,!0),s.publish({entityAction:k.MergeOnImport,entity:r}),p?i.isUnchanged()||n.entityManager._notifyStateChange(r,!0):i.isUnchanged()&&n.entityManager._notifyStateChange(r,!1)):r=null):(r=e._createEntityCore(),f(r,t,c,!0),v!==undefined&&(r.setProperty(e.keyProperties[0].name,v),a.tempNavPropNames&&a.tempNavPropNames.forEach(function(n){var t=e.getNavigationProperty(n),i=t.relatedDataProperties[0].name,u=r.getProperty(i),f=new o(t.entityType,[u]),s=h[f.toString()];r.setProperty(i,s)})),r.entityAspect._postInitialize(),r=n.attachEntity(r,i),s&&(s.publish({entityAction:k.AttachOnImport,entity:r}),i.isUnchanged()||n.entityManager._notifyStateChange(r,!0))),r&&(r.entityAspect.entityState=i,i.isModified()&&(r.entityAspect.originalValuesMap=a.originalValues),n.entityManager._linkRelatedEntities(r))})}function gt(n,t,i){return n=n.then(function(n){return t&&t(n),s.resolve(n)}).fail(function(n){return i&&i(n),s.reject(n)})}function rr(n,t){var i;return i=t?t.filter(function(t){if(t.entityAspect.entityManager!==n)throw new Error("Only entities in this entityManager may be saved");return!t.entityAspect.entityState.isDetached()}):n.getChanges()}function ur(n,t){n._inKeyFixup=!0,t.forEach(function(t){var i=n._entityGroupMap[t.entityTypeName];i._fixupKey(t.tempValue,t.realValue)}),n._inKeyFixup=!1}function ni(n,t){function r(){return new Error("The EntityManager.getChanges() 'entityTypes' parameter must be either an entityType or an array of entityTypes or null")}var i=n._entityGroupMap;if(t){if(t instanceof e)return[i[t.name]];if(Array.isArray(t))return t.map(function(n){if(n instanceof e)return i[n.name];throw r();});throw r();}else return yr(i)}function er(n,t){var i=t.entityAspect.getKey(),r=yi(t.entityType.keyProperties,i.values,function(n,t){return n.defaultValue===t?n:null}).filter(function(n){return n!==null});if(r.length)if(t.entityType.autoGeneratedKeyType!==it.None)n.generateTempKeyValue(t);else if(r.length===i.values.length)throw new Error("Cannot attach an object to an EntityManager without first setting its key or setting its entityType 'AutoGeneratedKeyType' property to something other than 'None'");}function or(n,t){function i(){return new Error("The EntityManager.getChanges() 'entityStates' parameter must either be null, an entityState or an array of entityStates")}if(!t)return null;if(u.contains(t))t=[t];else if(Array.isArray(t))t.forEach(function(n){if(!u.contains(n))throw i();});else throw i();return t}function ti(n,t,i){var r=st(n,t.entityType);r.attachEntity(t,i),n._linkRelatedEntities(t)}function sr(n,t,i){var r=t.entityType.navigationProperties;r.forEach(function(r){var u=t.getProperty(r.name);if(r.isScalar){if(!u)return;n.attachEntity(u,i)}else u.forEach(function(t){n.attachEntity(t,i)})})}function ri(n,t,i,r){var f;try{if(f=n.metadataStore,f.isEmpty()&&r.hasServerMetadata)throw new Error("cannot execute _executeQueryCore until metadataStore is populated.");if(i.fetchStrategy===ii.FromLocalCache)return s.fcall(function(){var i=n.executeQueryLocally(t);return{results:i,query:t}});var e=r.makeUrl(f.toQueryString(t)),u={url:e,query:t,entityManager:n,dataService:r,queryOptions:i,refMap:{},deferredFns:[]},o=n.validationOptions.validateOnQuery;return r.adapterInstance.executeQuery(u).then(function(i){var f=br(function(){var t={isLoading:n.isLoading};return n.isLoading=!0,n._pendingPubs=[],t},function(i){n.isLoading=i.isLoading,n._pendingPubs.forEach(function(n){n()}),n._pendingPubs=null,t=null,u=null,i.error&&s.reject(i.error)},function(){var f=r.jsonResultsAdapter.extractResults(i),e;return Array.isArray(f)||(f=[f]),e=f.map(function(n){var t=y(n,u,{nodeType:"root"});return o&&t.entityAspect&&t.entityAspect.validateEntity(),t}),u.deferredFns.length>0&&u.deferredFns.forEach(function(n){n()}),{results:e,query:t,entityManager:n,XHR:i.XHR,inlineCount:i.inlineCount}});return s.resolve(f)}).fail(function(i){return i&&(i.query=t,i.entityManager=n),s.reject(i)})}catch(h){return h&&(h.query=t),s.reject(h)}}function y(n,t,i){if(t.query==null&&n.entityAspect)return n.entityAspect.entityState.isDeleted()?t.entityManager.detachEntity(n):n.entityAspect.acceptChanges(),n;i=i||{};var r=t.dataService.jsonResultsAdapter.visitNode(n,t,i)||{};return t.query&&i.nodeType==="root"&&!r.entityType&&(r.entityType=t.query._getToEntityType&&t.query._getToEntityType(t.entityManager.metadataStore)),ut(n,t,r)}function ut(n,t,i,r){if(i.ignore||n==null)return null;if(i.nodeRefId){var u=cr(i.nodeRefId,t);return typeof u=="function"?(t.deferredFns.push(function(){r(u)}),undefined):u}return i.entityType?i.entityType.isComplexType?n:lr(n,t,i):(i.nodeId&&(t.refMap[i.nodeId]=n),typeof n!="object"||ct(n)?n:vr(n,t))}function cr(n,t){var i=t.refMap[n];return i===undefined?function(){return t.refMap[n]}:i}function lr(n,t,i){var f,e,o,h;n._$meta=i,f=t.entityManager,e=i.entityType,typeof e=="string"&&(e=f.metadataStore._getEntityType(e,!1)),n.entityType=e;var c=t.queryOptions.mergeStrategy,s=t.query==null,l=ft(n,e,!1),r=f.findEntityByKey(l);if(r){if(s&&r.entityAspect.entityState.isDeleted())return f.detachEntity(r),r;o=r.entityAspect.entityState,c===et.OverwriteChanges||o.isUnchanged()?(oi(r,n,t),r.entityAspect.wasLoaded=!0,i.extra&&(r.entityAspect.extraMetadata=i.extra),r.entityAspect.entityState=u.Unchanged,r.entityAspect.originalValues={},r.entityAspect.propertyChanged.publish({entity:r,propertyName:null}),h=s?k.MergeOnSave:k.MergeOnQuery,f.entityChanged.publish({entityAction:h,entity:r}),o.isUnchanged||f._notifyStateChange(r,!1)):(li(t,r,n),e.navigationProperties.forEach(function(i){i.isScalar?ai(n,i,t):bi(n,i,t)}))}else r=e._createEntityCore(),r.initializeFrom&&r.initializeFrom(n),oi(r,n,t),r.entityAspect._postInitialize(),i.extra&&(r.entityAspect.extraMetadata=i.extra),ti(f,r,u.Unchanged),r.entityAspect.wasLoaded=!0,f.entityChanged.publish({entityAction:k.AttachOnQuery,entity:r});return r}function vr(n,t){var u=t.entityManager,r=t.dataService.jsonResultsAdapter,f=u.metadataStore.namingConvention.serverPropertyNameToClient,i={};return d(n,function(n,u){var o=r.visitNode(u,t,{nodeType:"anonProp",propertyName:n})||{},e;o.ignore||(e=f(n),i[e]=Array.isArray(u)?u.map(function(u,f){return o=r.visitNode(u,t,{nodeType:"anonPropItem",propertyName:n})||{},ut(u,t,o,function(n){i[e][f]=n()})}):ut(u,t,o,function(n){i[e]=n()}))}),i}function oi(n,t,i){li(i,n,t);var r=n.entityType;f(n,t,r.dataProperties,!1),r.navigationProperties.forEach(function(r){r.isScalar?wr(r,n,t,i):kr(r,n,t,i)})}function f(n,t,i,r){if(i.forEach(function(i){pr(n,t,i,r)}),r){var u=n.entityAspect?"entityAspect":"complexAspect",f=t[u].originalValuesMap;f&&(n[u].originalValues=f)}}function pr(n,t,i,r){var e,u,o;(fn=r?si:hi,e=fn(t,i),e!==undefined)&&(u=ci(i,e),i.isComplexProperty?(oldVal=n.getProperty(i.name),o=i.dataType.dataProperties,i.isScalar?f(oldVal,u,o,r):(oldVal.length=0,u.forEach(function(t){var u=i.dataType._createInstanceCore(n,i.name);f(u,t,o,r),oldVal.push(u)}))):n.setProperty(i.name,u))}function ft(n,t,i){fn=i?si:hi;var r=t.keyProperties.map(function(t){return ci(t,fn(n,t))});return new o(t,r)}function si(n,t){return n[t.name]}function hi(n,t){return n[t.nameOnServer||t.isUnmapped&&t.name]}function ci(n,t){return t===undefined?undefined:(n.dataType.isDate&&t?ct(t)||(t=i.parseDateFromServer(t)):n.dataType===i.Binary&&t&&t.$value!==undefined&&(t=t.$value),t)}function li(n,t,i){var r=i._$meta.nodeId;r!=null&&(n.refMap[r]=t)}function wr(n,t,i,r){var u=ai(i,n,r);u!=null&&(typeof u=="function"?r.deferredFns.push(function(){u=u(),wi(u,t,n)}):wi(u,t,n))}function ai(n,t,i){var r=n[t.nameOnServer],u;return r?u=y(r,i,{nodeType:"navProp",navigationProperty:t}):null}function wi(n,t,i){var u,f,r,e;if(n&&(u=i.name,f=t.getProperty(u),f!==n)){if(t.setProperty(u,n),r=i.inverse,!r)return;r.isScalar?n.setProperty(r.name,t):(e=n.getProperty(r.name),e.push(t))}}function kr(n,t,i,r){var e=bi(i,n,r),u,f;e!=null&&(u=n.inverse,u)&&(f=t.getProperty(n.name),f.wasLoaded=!0,e.forEach(function(n){typeof n=="function"?r.deferredFns.push(function(){n=n(),ki(n,f,t,u)}):ki(n,f,t,u)}))}function bi(n,t,i){var r=n[t.nameOnServer],u;return r?Array.isArray(r)?u=r.map(function(n){return y(n,i,{nodeType:"navPropItem",navigationProperty:t})}):null:null}function ki(n,t,i,r){if(n){var u=n.getProperty(r.name);u!==i&&(t.push(n),n.setProperty(r.name,i))}}function dr(n){var t=n.filter(function(n){return n.entityAspect.isBeingSaved=!0,n.entityAspect.entityState.isModified()&&n.entityType.concurrencyProperties.length>0});t.length!==0&&t.forEach(function(n){n.entityType.concurrencyProperties.forEach(function(t){gr(n,t)})})}function gr(n,t){var r,f,u;if(!n.entityAspect.originalValues[t.name])if(r=n.getProperty(t.name),r||(r=t.dataType.defaultValue),t.dataType.isNumeric)n.setProperty(t.name,r+1);else if(t.dataType.isDate){for(f=new Date,u=new Date;f.getTime()===u.getTime();)u=new Date;n.setProperty(t.name,u)}else if(t.dataType===i.Guid)n.setProperty(t.name,fi());else{if(t.dataType===i.Binary)return;throw new Error("Unable to update the value of concurrency property before saving: "+t.name);}}function st(n,t){var i=n._entityGroupMap[t.name];return i||(i=new uu(n,t),n._entityGroupMap[t.name]=i),i}function nu(n,t){var i=t.getSelfAndSubtypes();return i.map(function(t){return st(n,t)})}function ht(n,t){var i={},r=n.entityType||n.complexType;return r.dataProperties.forEach(function(r){if(!r.isUnmapped||!t)if(r.isComplexProperty)r.isScalar?i[r.nameOnServer]=ht(n.getProperty(r.name),t):(complexObjs=n.getProperty(r.name),i[r.nameOnServer]=complexObjs.map(function(n){return ht(n,t)}));else{var u=n.getProperty(r.name);u=yt(u,r,t),u!==undefined&&(i[r.nameOnServer]=u)}}),i}function lt(n,t,i){var f=n.entityType||n.complexType,e=n.entityAspect||n.complexAspect,u=t.namingConvention.clientPropertyNameToServer,r={};return d(e.originalValues,function(n,t){var e=f.getProperty(n);t=yt(t,e,i),t!==undefined&&(r[u(n,e)]=t)}),f.complexProperties.forEach(function(f){var o=n.getProperty(f.name),e,s;f.isScalar?(e=lt(o,t,i),ei(e)||(r[u(f.name,f)]=e)):(s=o.map(function(n){return lt(n,t,i)}),r[u(f.name,f)]=s)}),r}function at(n,t,i){var f=n.entityType||n.complexType,e=n.entityAspect||n.complexAspect,u=t.namingConvention.clientPropertyNameToServer,r={};return d(e.originalValues,function(t){var s=f.getProperty(t),o=n.getProperty(t);o=yt(o,s,i),o!==undefined&&(r[u(t,s)]=o)}),f.complexProperties.forEach(function(i){var e=n.getProperty(i.name),f,o;i.isScalar?(f=at(e,t),ei(f)||(r[u(i.name,i)]=f)):(o=e.map(function(n){return at(n,t)}),r[u(i.name,i)]=o)}),r}function yt(n,t,r){if(r){if(t.isUnmapped)return;t.dataType===i.DateTimeOffset?n=n&&new Date(n.getTime()-n.getTimezoneOffset()*6e4):t.dataType.quoteJsonOData&&(n=n!=null?n.toString():n)}return n}function r(){this.map={}}var a=function(n){if(arguments.length>1)throw new Error("The EntityManager ctor has a single optional argument that is either a 'serviceName' or a configuration object.");arguments.length===0?n={serviceName:""}:typeof n=="string"&&(n={serviceName:n}),pt(this,n,!0),this.entityChanged=new tt("entityChanged_entityManager",this),this.hasChangesChanged=new tt("hasChangesChanged_entityManager",this),this.clear()},t=a.prototype;return t._$typeName="EntityManager",tt.bubbleEvent(t,null),t.setProperties=function(n){pt(this,n,!1)},t.createEntity=function(t,i,r){n(t,"entityType").isString().or().isInstanceOf(e).check(),typeof t=="string"&&(t=this.metadataStore._getEntityType(t)),r=r||u.Added;var f;return ui(this,"isLoading",!0,function(){f=t.createEntity(i)}),r!==u.Detached&&this.attachEntity(f,r),f},a.importEntities=function(n,t){var i=new ar;return i.importEntities(n,t),i},t.exportEntities=function(n){var t=gi(this,n),i={metadataStore:this.metadataStore.exportMetadata(),dataService:this.dataService,saveOptions:this.saveOptions,queryOptions:this.queryOptions,validationOptions:this.validationOptions,tempKeys:t.tempKeys,entityGroupMap:t.entityGroupMap};return JSON.stringify(i,null,l.stringifyPad)},t.importEntities=function(n,t){var r,i,u;return t=t||{},v(t).whereParam("mergeStrategy").isEnumOf(et).isOptional().withDefault(this.queryOptions.mergeStrategy).applyAll(t),r=this,i=JSON.parse(n),this.metadataStore.importMetadata(i.metadataStore),this.dataService=i.dataService&&h.fromJSON(i.dataService)||new h({serviceName:i.serviceName}),this.saveOptions=new vt(i.saveOptions),this.queryOptions=rt.fromJSON(i.queryOptions),this.validationOptions=new kt(i.validationOptions),u={},i.tempKeys.forEach(function(n){var t=o.fromJSON(n,r.metadataStore);u[t.toString()]=r.keyGenerator.generateTempKeyValue(t.entityType,t.values[0])}),t.tempKeyMap=u,br(function(){r._pendingPubs=[]},function(){r._pendingPubs.forEach(function(n){n()}),r._pendingPubs=null},function(){d(i.entityGroupMap,function(n,i){var u=r.metadataStore._getEntityType(n,!0),f=st(r,u);ir(f,i,t)})}),this},t.clear=function(){d(this._entityGroupMap,function(n,t){t._clear()}),this._entityGroupMap={},this._unattachedChildrenMap=new r,this.keyGenerator=new this.keyGeneratorCtor,this.entityChanged.publish({entityAction:k.Clear}),this._hasChanges&&(this._hasChanges=!1,this.hasChangesChanged.publish({entityManager:this,hasChanges:!1}))},t.createEmptyCopy=function(){return new a({dataService:this.dataService,metadataStore:this.metadataStore,queryOptions:this.queryOptions,saveOptions:this.saveOptions,validationOptions:this.validationOptions,keyGeneratorCtor:this.keyGeneratorCtor})},t.addEntity=function(n){return this.attachEntity(n,u.Added)},t.attachEntity=function(t,i){var r,e,f;if(n(t,"entity").isRequired().check(),this.metadataStore._checkEntityType(t),i=n(i,"entityState").isEnumOf(u).isOptional().check(u.Unchanged),t.entityType.metadataStore!==this.metadataStore)throw new Error("Cannot attach this entity because the EntityType and MetadataStore associated with this entity does not match this EntityManager's MetadataStore.");if(r=t.entityAspect,r||(r=new ot(t),r._postInitialize(t)),e=r.entityManager,e){if(e===this)return t;throw new Error("This entity already belongs to another EntityManager");}return f=this,ui(this,"isLoading",!0,function(){i.isAdded()&&er(f,t),ti(f,t,i),sr(f,t,i)}),this.validationOptions.validateOnAttach&&t.entityAspect.validateEntity(),i.isUnchanged()||this._notifyStateChange(t,!0),this.entityChanged.publish({entityAction:k.Attach,entity:t}),t},t.detachEntity=function(t){var i,r;if((n(t,"entity").isEntity().check(),i=t.entityAspect,!i)||(r=i.entityGroup,!r))return!1;if(r.entityManager!==this)throw new Error("This entity does not belong to this EntityManager.");return r.detachEntity(t),i._removeFromRelations(),this.entityChanged.publish({entityAction:k.Detach,entity:t}),i._detach(),!0},t.fetchMetadata=function(t,i,r){typeof t=="function"?(r=i,i=t,t=null):(n(t,"dataService").isInstanceOf(h).isOptional().check(),n(i,"callback").isFunction().isOptional().check(),n(r,"errorCallback").isFunction().isOptional().check());var u=this.metadataStore.fetchMetadata(t||this.dataService);return gt(u,i,r)},t.executeQuery=function(t,i,r){var f,e,u,o;return n(t,"query").isInstanceOf(nt).or().isString().check(),n(i,"callback").isFunction().isOptional().check(),n(r,"errorCallback").isFunction().isOptional().check(),e=rt.resolve([t.queryOptions,this.queryOptions,rt.defaultInstance]),u=h.resolve([t.dataService,this.dataService]),!u.hasServerMetadata||this.metadataStore.hasMetadataFor(u.serviceName)?f=ri(this,t,e,u):(o=this,f=this.fetchMetadata(u).then(function(){return ri(o,t,e,u)})),gt(f,i,r)},t.executeQueryLocally=function(t){var u,i,f,e,o,s,c;n(t,"query").isInstanceOf(nt).check();var l=this.metadataStore,r=t._getFromEntityType(l,!0),a=nu(this,r),h=t._toFilterFunction(r);return u=h?function(n){return n&&!n.entityAspect.entityState.isDeleted()&&h(n)}:function(n){return n&&!n.entityAspect.entityState.isDeleted()},i=[],a.forEach(function(n){i.push.apply(i,n._entities.filter(u))}),f=t._toOrderByComparer(r),f&&i.sort(f),e=t.skipCount,e&&(i=i.slice(e)),o=t.takeCount,o&&(i=i.slice(0,o)),s=t.selectClause,s&&(c=s.toFunction(),i=i.map(function(n){return c(n)})),i},t.saveChanges=function(t,i,r,u){var p,f,c,w,l,a,o;if(n(t,"entities").isOptional().isArray().isEntity().check(),n(i,"saveOptions").isInstanceOf(vt).isOptional().check(),n(r,"callback").isFunction().isOptional().check(),n(u,"errorCallback").isFunction().isOptional().check(),i=i||this.saveOptions||vt.defaultInstance,p=t==null,f=rr(this,t),f.length===0)return c={entities:[],keyMappings:[]},r&&r(c),s.resolve(c);if(!i.allowConcurrentSaves&&(w=f.some(function(n){return n.entityAspect.isBeingSaved}),w))return l=new Error("Concurrent saves not allowed - SaveOptions.allowConcurrentSaves is false"),u&&u(l),s.reject(l);if(this.validationOptions.validateOnSave&&(a=f.filter(function(n){var t=n.entityAspect,i=t.entityState.isDeleted()||t.validateEntity();return!i}),a.length>0))return o=new Error("Validation error"),o.entitiesWithErrors=a,u&&u(o),s.reject(o);dr(f);var v=h.resolve([i.dataService,this.dataService]),b={entityManager:this,dataService:v,resourceName:i.resourceName||this.saveOptions.resourceName||"SaveChanges"},k={mergeStrategy:et.OverwriteChanges},d={entities:f,saveOptions:i},e=this;return v.adapterInstance.saveChanges(b,d).then(function(n){ur(e,n.keyMappings);var i={query:null,entityManager:e,queryOptions:k,dataService:v,refMap:{},deferredFns:[]},t=n.entities.map(function(n){return y(n,i,{nodeType:"root"})});return bt(f,!1),e._hasChanges=p&&di(f,t)?!1:e._hasChangesCore(),e._hasChanges||e.hasChangesChanged.publish({entityManager:e,hasChanges:!1}),n.entities=t,r&&r(n),s.resolve(n)},function(n){return bt(f,!1),u&&u(n),s.reject(n)})},t._findEntityGroup=function(n){return this._entityGroupMap[n.name]},t.getEntityByKey=function(){var t=wt(this,arguments).entityKey,n,r=t._subTypes,i,f,u;if(r){for(i=0,f=r.length;i<f;i++)if(n=this._findEntityGroup(r[i]),u=n&&n.findEntityByKey(t),u)return u}else return n=this._findEntityGroup(t.entityType),n&&n.findEntityByKey(t)},t.fetchEntityByKey=function(){var r=wt(this,arguments),t=r.entityKey,u=r.remainingArgs.length===0?!1:!!r.remainingArgs[0],n,i=!1;return u&&(n=this.getEntityByKey(t),i=n&&n.entityAspect.entityState.isDeleted(),i&&(n=null,this.queryOptions.mergeStrategy===et.OverwriteChanges&&(i=!1))),n||i?s.resolve({entity:n,entityKey:t,fromCache:!0}):nt.fromEntityKey(t).using(this).execute().then(function(i){return n=i.results.length===0?null:i.results[0],s.resolve({entity:n,entityKey:t,fromCache:!1})})},t.findEntityByKey=function(n){return this.getEntityByKey(n)},t.generateTempKeyValue=function(t){n(t,"entity").isEntity().check();var i=t.entityType,r=this.keyGenerator.generateTempKeyValue(i),u=i.keyProperties[0];return t.setProperty(u.name,r),t.entityAspect.hasTempKey=!0,r},t.hasChanges=function(n){return this._hasChanges?n===undefined?this._hasChanges:this._hasChangesCore(n):!1},t._hasChangesCore=function(n){n=p(this,n);var t=ni(this,n);return t.some(function(n){return n.hasChanges()})},t.getChanges=function(n){n=p(this,n);var t=[u.Added,u.Modified,u.Deleted];return w(this,n,t)},t.rejectChanges=function(){if(!this._hasChanges)return[];var t=[u.Added,u.Modified,u.Deleted],n=w(this,null,t);return this._hasChanges=!1,n.forEach(function(n){n.entityAspect.rejectChanges()}),this.hasChangesChanged.publish({entityManager:this,hasChanges:!1}),n},t.getEntities=function(t,i){return t=p(this,t),n(i,"entityStates").isOptional().isEnumOf(u).or().isNonEmptyArray().isEnumOf(u).check(),i&&(i=or(this,i)),w(this,t,i)},t._notifyStateChange=function(n,t){this.entityChanged.publish({entityAction:k.EntityStateChange,entity:n}),t?this._hasChanges||(this._hasChanges=!0,this.hasChangesChanged.publish({entityManager:this,hasChanges:!0})):this._hasChanges&&(this._hasChanges=this._hasChangesCore(),this._hasChanges||this.hasChangesChanged.publish({entityManager:this,hasChanges:!1}))},t._linkRelatedEntities=function(n){var t=this,i=n.entityAspect;ui(t,"isLoading",!0,function(){var r=t._unattachedChildrenMap,f=i.getKey(),e=r.getTuples(f);e&&e.forEach(function(t){var s=t.children.filter(function(n){return n.entityAspect.entityState!==u.Detached}),e=t.navigationProperty,o,i,c,h;e.inverse?(o=e,i=e.inverse,i.isScalar?(c=s[0],n.setProperty(i.name,c),c.setProperty(o.name,n)):(h=n.getProperty(i.name),s.forEach(function(t){h.push(t),t.setProperty(o.name,n)}))):e.parentType===n.entityType?(i=e,i.isScalar?n.setProperty(i.name,s[0]):(h=n.getProperty(i.name),s.forEach(function(n){h._push(n)}))):(o=e,s.forEach(function(t){t.setProperty(o.name,n)})),r.removeChildren(f,o)}),n.entityType.navigationProperties.forEach(function(u){var o,f,e;if((!u.isScalar||(o=n.getProperty(u.name),!o))&&(f=i.getParentKey(u),f)){if(f._isEmpty())return;e=t.findEntityByKey(f),e?n.setProperty(u.name,e):r.addChild(f,u,n)}}),n.entityType.foreignKeyProperties.forEach(function(i){var u=i.inverseNavigationProperty;if(u){var s=n.getProperty(i.name),e=new o(u.parentType,[s]),f=t.findEntityByKey(e);f?u.isScalar?f.setProperty(u.name,n):t.isLoading?f.getProperty(u.name)._push(n):f.getProperty(u.name).push(n):r.addChild(e,u,n)}})})},t.helper={unwrapInstance:ht,unwrapOriginalValues:lt,unwrapChangedValues:at,getEntityKeyFromRawEntity:ft},r.prototype.addChild=function(n,t,i){var r=this.getTuple(n,t);r||(r={navigationProperty:t,children:[]},pi(this.map,n.toString()).push(r)),r.children.push(i)},r.prototype.removeChildren=function(n,t){var i=this.map[n.toString()];i&&(fr(i,function(n){return n.navigationProperty===t}),i.length||delete this.map[n.toString()])},r.prototype.getChildren=function(n,t){var i=this.getTuple(n,t);return i?i.children.filter(function(n){return!n.entityAspect.entityState.isDetached()}):null},r.prototype.getTuple=function(n,t){var i=this.map[n.toString()],r;return i?r=b(i,function(n){return n.navigationProperty===t}):null},r.prototype.getTuples=function(n){return this.map[n.toString()]},a}(),t.EntityManager=ar,vt=function(){function i(n,t){return t&&v(t).whereParam("resourceName").isOptional().isString().whereParam("dataService").isOptional().isInstanceOf(h).whereParam("allowConcurrentSaves").isBoolean().isOptional().whereParam("tag").isOptional().applyAll(n),n}var n=function(n){i(this,n)},t=n.prototype;return t._$typeName="SaveOptions",t.setAsDefault=function(){return ri(this,n)},t.using=function(n){return i(this,n)},n.defaultInstance=new n({allowConcurrentSaves:!1}),n}(),t.SaveOptions=vt,t.AbstractDataServiceAdapter=function(){var i,n=function(){};return n.prototype.checkForRecomposition=function(n){n.interfaceName==="ajax"&&n.isDefault&&this.initialize()},n.prototype.initialize=function(){if(i=t.config.getAdapterInstance("ajax"),!i)throw new Error("Unable to initialize ajax for WebApi.");var n=i.ajax;if(!n)throw new Error("Breeze was unable to find an 'ajax' adapter");},n.prototype.fetchMetadata=function(n,t){var f=t.serviceName,u=t.makeUrl("Metadata"),r=s.defer(),e=this;return i.ajax({url:u,dataType:"json",success:function(i,e,o){var s,h;if(n.hasMetadataFor(f))return r.resolve("already fetched");if(h=typeof i=="string"?JSON.parse(i):i,h)try{n.importMetadata(h)}catch(c){s=new Error("Metadata import failed for "+u+"; Unable to process returned metadata:"+c.message)}else s=new Error("Metadata query failed for: "+u);if(s)return r.reject(s);n.hasMetadataFor(f)||n.addDataService(t),o.onreadystatechange=null,o.abort=null,r.resolve(h)},error:function(n){e._handleXHRError(r,n,"Metadata query failed for: "+u)}}),r.promise},n.prototype.executeQuery=function(n){var t=s.defer(),u=this,r={url:n.url,dataType:"json",success:function(n,i,r){var f,e;try{f=n.Results?{results:n.Results,inlineCount:n.InlineCount,XHR:r}:{results:n,XHR:r},t.resolve(f),r.onreadystatechange=null,r.abort=null}catch(o){e=o instanceof Error?o:u._createError(r),t.reject(e),r.onreadystatechange=null,r.abort=null}},error:function(n){u._handleXHRError(t,n)}};return n.dataService.useJsonp&&(r.dataType="jsonp",r.crossDomain=!0),i.ajax(r),t.promise},n.prototype.saveChanges=function(n,t){var r=s.defer(),t=this._prepareSaveBundle(t,n),f=JSON.stringify(t),e=n.dataService.makeUrl(n.resourceName),u=this;return i.ajax({url:e,type:"POST",dataType:"json",contentType:"application/json",data:f,success:function(t,i,f){var o=t.Error||t.error,e,s;o?(e=u._createError(f),e.message=o,r.reject(e)):(s=u._prepareSaveResult(n,t),r.resolve(s))},error:function(n){u._handleXHRError(r,n)}}),r.promise},n.prototype._prepareSaveBundle=function(){throw new Error("Need a concrete implementation of _prepareSaveBundle");},n.prototype._prepareSaveResult=function(){throw new Error("Need a concrete implementation of _prepareSaveResult");},n.prototype.jsonResultsAdapter=new si({name:"noop",visitNode:function(){return{}}}),n.prototype._handleXHRError=function(n,t,i){var r=this._createError(t);i&&(r.message=i+"; "+r.message),n.reject(r),t.onreadystatechange=null,t.abort=null},n.prototype._createError=function(n){var t=new Error,i,r;if(t.XHR=n,t.responseText=n.responseText,t.status=n.status,t.statusText=n.statusText,t.message=n.statusText,t.responseText)try{i=JSON.parse(n.responseText),t.detail=i,r=i.InnerException||i,t.message=r.ExceptionMessage||r.Message||n.responseText}catch(u){t.message=t.message+": "+t.responseText}return t},n}(),function(n){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?n(require("breeze")):typeof define=="function"&&define.amd?t?n(t):define(["breeze"],n):n(t)}(function(n){var t=n.core,i,r=function(){this.name="jQuery",this.defaultSettings={}};r.prototype.initialize=function(){i=t.requireLib("jQuery","needed for 'ajax_jQuery' pluggin")},r.prototype.ajax=function(n){if(t.isEmpty(this.defaultSettings))i.ajax(n);else{var r=t.extend({},this.defaultSettings);t.extend(r,n),i.ajax(r)}},n.config.registerAdapter("ajax",r)}),function(n){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?n(require("breeze")):typeof define=="function"&&define.amd&&!t?define(["breeze"],n):n(t)}(function(n){function f(n){return n==null?null:"'"+n+"'"}function e(){return(new t).toString()}var o=n.core,s=n.MetadataStore,r=n.JsonResultsAdapter,u=n.AbstractDataServiceAdapter,h,i=function(){this.name="mongo",n.DataType.MongoObjectId=n.DataType.addSymbol({defaultValue:"",fmtOData:f,getNext:e})},t;i.prototype=new u,i.prototype._prepareSaveBundle=function(n,t){var r=t.entityManager,f=r.metadataStore,u=r.helper,i={};return n.entities=n.entities.map(function(n){var e=u.unwrapInstance(n),o=n.entityType.name,t=i[o],r,s,h;return t||(t={},r=n.entityType,t.dataProperties=r.dataProperties.map(function(n){var t={name:n.nameOnServer,dataType:n.dataType.name};return n.relatedNavigationProperty!=null&&(t.isFk=!0),n.concurrencyMode&&n.concurrencyMode==="Fixed"&&(t.isConcurrencyProp=!0),t}),r.autoGeneratedKeyType!==it.None&&(t.autoGeneratedKey={propertyName:r.keyProperties[0].nameOnServer,autoGeneratedKeyType:r.autoGeneratedKeyType.name}),i[o]=t),s=u.unwrapOriginalValues(n,f),h={entityTypeName:n.entityType.name,defaultResourceName:n.entityType.defaultResourceName,entityState:n.entityAspect.entityState.name,originalValuesMap:s},e.entityAspect=h,e}),n.metadata=i,n.saveOptions={tag:n.saveOptions.tag},n},i.prototype._prepareSaveResult=function(n,t){var i=n.entityManager,r=t.insertedKeys.concat(t.updatedKeys,t.deletedKeys),u=r.map(function(n){return i.getEntityByKey(n.entityTypeName,n._id)});return{entities:u,keyMappings:t.keyMappings,XHR:t.XHR}},i.prototype.jsonResultsAdapter=new r({name:"mongo",visitNode:function(n,t){if(n==null)return{};var r={};return n.$type&&(r.entityType=t.entityManager.metadataStore._getEntityType(n.$type,!0)),r}}),t=function(){var r=0,o=Math.floor(Math.random()*32767),n=Math.floor(Math.random()*16777216),u,f,e,i;if(typeof localStorage!="undefined")u=parseInt(localStorage.mongoMachineId),u>=0&&u<=16777215&&(n=Math.floor(localStorage.mongoMachineId)),localStorage.mongoMachineId=n,document.cookie="mongoMachineId="+n+";expires=Tue, 19 Jan 2038 05:00:00 GMT";else{f=document.cookie.split("; ");for(e in f)if(i=f[e].split("="),i[0]=="mongoMachineId"&&i[1]>=0&&i[1]<=16777215){n=i[1];break}document.cookie="mongoMachineId="+n+";expires=Tue, 19 Jan 2038 05:00:00 GMT"}return function(){if(!(this instanceof t))return new t(arguments[0],arguments[1],arguments[2],arguments[3]).toString();typeof arguments[0]=="object"?(this.timestamp=arguments[0].timestamp,this.machine=arguments[0].machine,this.pid=arguments[0].pid,this.increment=arguments[0].increment):typeof arguments[0]=="string"&&arguments[0].length==24?(this.timestamp=Number("0x"+arguments[0].substr(0,8)),this.machine=Number("0x"+arguments[0].substr(8,6)),this.pid=Number("0x"+arguments[0].substr(14,4)),this.increment=Number("0x"+arguments[0].substr(18,6))):arguments.length==4&&arguments[0]!=null?(this.timestamp=arguments[0],this.machine=arguments[1],this.pid=arguments[2],this.increment=arguments[3]):(this.timestamp=Math.floor((new Date).valueOf()/1e3),this.machine=n,this.pid=o,r>16777215&&(r=0),this.increment=r++)}}(),t.prototype.getDate=function(){return new Date(this.timestamp*1e3)},t.prototype.toString=function(){var n=this.timestamp.toString(16),t=this.machine.toString(16),i=this.pid.toString(16),r=this.increment.toString(16);return"00000000".substr(0,6-n.length)+n+"000000".substr(0,6-t.length)+t+"0000".substr(0,4-i.length)+i+"000000".substr(0,6-r.length)+r},n.config.registerAdapter("dataService",i)}),function(n){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?n(require("breeze")):typeof define=="function"&&define.amd&&!t?define(["breeze"],n):n(t)}(function(n){function h(n,t){var r=[],u=[],e=[],o=n.dataService.serviceName,s=n.entityManager,h=s.helper,i=0;return t.entities.forEach(function(n){var c=n.entityAspect,t;if(i=i+1,t={headers:{"Content-ID":i,DataServiceVersion:"2.0"}},e[i]=n,c.entityState.isAdded())t.requestUri=n.entityType.defaultResourceName,t.method="POST",t.data=h.unwrapInstance(n,!0),u[i]=c.getKey();else if(c.entityState.isModified())f(t,c,o),t.method="MERGE",t.data=h.unwrapChangedValues(n,s.metadataStore,!0);else if(c.entityState.isDeleted())f(t,c,o),t.method="DELETE";else return;r.push(t)}),n.contentKeys=e,n.tempKeys=u,{__batchRequests:[{__changeRequests:r}]}}function f(n,t,i){var r=t.extraMetadata;uri=r.uri,lt(uri,i)&&(uri=uri.substring(i.length)),n.requestUri=uri,r.etag&&(n.headers["If-Match"]=r.etag)}function r(n,t){var i=new Error,u=n.response,f,r,e;if(i.message=u.statusText,i.statusText=u.statusText,i.status=u.statusCode,t&&(i.url=t),i.body=u.body,u.body)try{r=JSON.parse(u.body),i.body=r,e="";do f=r.error||r.innererror,f||(e=e+c(r)),f=f||r.internalexception,r=f||r;while(f);e.length>0&&(i.message=e)}catch(o){}return i}function c(n){var t=n.message;return t==null?"":(typeof t=="string"?t:t.value)+"; "}var u=n.core,e=n.MetadataStore,o=n.JsonResultsAdapter,t,i=function(){this.name="OData"};i.prototype.initialize=function(){t=u.requireLib("OData","Needed to support remote OData services"),t.jsonHandler.recognizeDates=!0},i.prototype.executeQuery=function(n){var i=s.defer();return t.read(n.url,function(n){return i.resolve({results:n.results,inlineCount:n.__count})},function(t){return i.reject(r(t,n.url))}),i.promise},i.prototype.fetchMetadata=function(n,i){var u=s.defer(),e=i.serviceName,f=i.makeUrl("$metadata");return t.read(f,function(t){var o,r;if(!t||!t.dataServices)return o=new Error("Metadata query failed for: "+f),u.reject(o);if(r=t.dataServices,!n.hasMetadataFor(e)){try{n.importMetadata(r)}catch(s){return u.reject(new Error("Metadata query failed for "+f+"; Unable to process returned metadata: "+s.message))}n.addDataService(i)}return u.resolve(r)},function(n){var t=r(n,f);return t.message="Metadata query failed for: "+f+"; "+(t.message||""),u.reject(t)},t.metadataHandler),u.promise},i.prototype.saveChanges=function(n,i){var u=s.defer(),e=n.entityManager.helper,f=n.dataService.makeUrl("$batch"),o=h(n,i),c=n.tempKeys,l=n.contentKeys;return t.request({headers:{DataServiceVersion:"2.0"},requestUri:f,method:"POST",data:o},function(n){var i=[],o=[],s={entities:i,keyMappings:o};return n.__batchResponses.forEach(function(n){n.__changeResponses.forEach(function(n){var p=n.response||n,v=p.statusCode,a,t,s,h,y;if(!v||v>=400)return u.reject(r(n,f));if(a=n.headers["Content-ID"],t=n.data,t){if(s=c[a],s&&(h=s.entityType,h.autoGeneratedKeyType!==it.None)){var w=s.values[0],b=e.getEntityKeyFromRawEntity(t,h,!1),k={entityTypeName:h.name,tempValue:w,realValue:b.values[0]};o.push(k)}i.push(t)}else y=l[a],i.push(y)})}),u.resolve(s)},function(n){return u.reject(r(n,f))},t.batchHandler),u.promise},i.prototype.jsonResultsAdapter=new o({name:"OData_default",visitNode:function(n,t,i){var r={},o,f,s;return n==null?r:(n.__metadata!=null&&(o=e.normalizeTypeName(n.__metadata.type),f=o&&t.entityManager.metadataStore.getEntityType(o,!0),f&&f._mappedPropertiesCount===Object.keys(n).length-1&&(r.entityType=f,r.extra=n.__metadata)),s=i.propertyName,r.ignore=n.__deferred!=null||s==="__metadata"||s==="EntityKey"&&n.$type&&u.stringStartsWith(n.$type,"System.Data"),r)}}),n.config.registerAdapter("dataService",i)}),function(n){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?n(require("breeze")):typeof define=="function"&&define.amd&&!t?define(["breeze"],n):n(t)}(function(n){var f=n.core,i=n.MetadataStore,r=n.JsonResultsAdapter,u=n.AbstractDataServiceAdapter,e,t=function(){this.name="webApi"};t.prototype=new u,t.prototype._prepareSaveBundle=function(n,t){var i=t.entityManager,u=i.metadataStore,r=i.helper;return n.entities=n.entities.map(function(n){var t=r.unwrapInstance(n),i=null,f;return n.entityType.autoGeneratedKeyType!==it.None&&(i={propertyName:n.entityType.keyProperties[0].nameOnServer,autoGeneratedKeyType:n.entityType.autoGeneratedKeyType.name}),f=r.unwrapOriginalValues(n,u),t.entityAspect={entityTypeName:n.entityType.name,defaultResourceName:n.entityType.defaultResourceName,entityState:n.entityAspect.entityState.name,originalValuesMap:f,autoGeneratedKey:i},t}),n.saveOptions={tag:n.saveOptions.tag},n},t.prototype._prepareSaveResult=function(n,t){var r=t.KeyMappings.map(function(n){var t=i.normalizeTypeName(n.EntityTypeName);return{entityTypeName:t,tempValue:n.TempValue,realValue:n.RealValue}});return{entities:t.Entities,keyMappings:r,XHR:t.XHR}},t.prototype.jsonResultsAdapter=new r({name:"webApi_default",visitNode:function(n,t,r){if(n==null)return{};var u=i.normalizeTypeName(n.$type),e=u&&t.entityManager.metadataStore._getEntityType(u,!0),f=r.propertyName,o=f&&f.substr(0,1)==="$";return{entityType:e,nodeId:n.$id,nodeRefId:n.$ref,ignore:o}}}),n.config.registerAdapter("dataService",t)}),function(n){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?n(require("breeze")):typeof define=="function"&&define.amd&&!t?define(["breeze"],n):n(t)}(function(n){var f=n.core,s=n.ComplexAspect,i,e,t,u,o=Object.prototype.hasOwnProperty,r=function(){this.name="backbone"};r.prototype.initialize=function(){i=f.requireLib("Backbone"),e=f.requireLib("_;underscore"),t=i.Model.prototype.set,u=i.Model.prototype.get},r.prototype.createCtor=function(t){var r={},u;return t.dataProperties.forEach(function(n){r[n.name]=n.defaultValue}),u=i.Model.extend({defaults:r,initialize:function(){if(t.navigationProperties){var r=this;t.navigationProperties.forEach(function(t){if(!t.isScalar){var u=n.makeRelationArray([],r,t);i.Model.prototype.set.call(r,t.name,u)}})}}})},r.prototype.getTrackablePropertyNames=function(n){var t=[],i;for(i in n.attributes)t.push(i);return t},r.prototype.initializeEntityPrototype=function(n){n.getProperty=function(n){return this.get(n)},n.setProperty=function(n,t){return this.set(n,t),this},n.set=function(n,i,r){var a=this.entityAspect||this.complexAspect,s,h,f,c,l;if(!a)return t.call(this,n,i,r);if(c=this,l=this.entityType||this.complexType,e.isObject(n)||n==null){if(s=n,r=i,!this._validate(s,r))return!1;for(f in s)if(o.call(s,f)){if(h=l.getProperty(f),h==null)throw new Error("Unknown property: "+n);this._$interceptor(h,s[f],function(n){return arguments.length===0?u.call(c,f):t.call(c,f,n,r)})}}else{if(s={},s[n]=i,r||(r={}),!this._validate(s,r))return!1;if(h=l.getProperty(n),h==null)throw new Error("Unknown property: "+n);f=n,this._$interceptor(h,i,function(n){return arguments.length===0?u.call(c,f):t.call(c,f,n,r)})}return this}},r.prototype.startTracking=function(r){if(!(r instanceof i.Model))throw new Error("This entity is not an Backbone.Model instance");var o=r.entityType||r.complexType,s=r.attributes;o.dataProperties.forEach(function(i){var f;i.isComplexProperty?(f=i.isScalar?i.dataType._createInstanceCore(r,i.name):n.makeComplexArray([],r,i),t.call(r,i.name,f)):i.name in s?u.call(r,i.name)===undefined&&i.defaultValue!==undefined&&t.call(r,i.name,i.defaultValue):t.call(r,i.name,i.defaultValue)}),o.navigationProperties&&o.navigationProperties.forEach(function(i){var o,e;if(i.name in s)if(e=u.call(r,i.name),i.isScalar){if(e&&!e.entityType){o=f.formatString("The value of the '%1' property for entityType: '%2' must be either null or another entity",i.name,r.entityType.name);throw new Error(o);}}else if(e){if(!e.parentEntity){o=f.formatString("The value of the '%1' property for entityType: '%2' must be either null or a Breeze relation array",i.name,r.entityType.name);throw new Error(o);}}else e=n.makeRelationArray([],r,i),t.call(r,i.name,e);else i.isScalar?t.call(r,i.name,null):(e=n.makeRelationArray([],r,i),t.call(r,i.name,e))})},n.config.registerAdapter("modelLibrary",r)}),function(n){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?n(require("breeze")):typeof define=="function"&&define.amd&&!t?define(["breeze"],n):n(t)}(function(n){function r(n){var t=n.entityType||n.complexType;t.getProperties().forEach(function(t){var i=t.name;n[i]||Object.defineProperty(n,i,f(t))})}function u(n){var t=Object.getPrototypeOf(n),i;return n._backingStore||(n._backingStore={}),i=t.entityType||t.complexType,i.getProperties().forEach(function(t){var i=t.name,r;n.hasOwnProperty(i)&&(r=n[i],delete n[i],n[i]=r)}),n._backingStore}function f(n){var t=n.name,i=function(n){return function(){if(arguments.length==0)return n[t];n[t]=arguments[0]}};return{get:function(){var n=this._backingStore;if(n||(this._pendingSets.process(),n=this._backingStore,n))return n[t]},set:function(r){var f=this._backingStore,u;if(!f){this._pendingSets.schedule(this,t,r);return}u=i(f),this._$interceptor?this._$interceptor(n,r,u):u(r)},enumerable:!0,configurable:!0}}var i=n.core,e=n.ComplexAspect,t=function(){this.name="backingStore"};t.prototype.initialize=function(){},t.prototype.getTrackablePropertyNames=function(n){var r=[],t,u;for(t in n)t!=="entityType"&&t!=="_$typeName"&&t!=="_pendingSets"&&t!=="_backingStore"&&(u=n[t],i.isFunction(u)||r.push(t));return r},t.prototype.initializeEntityPrototype=function(n){n.getProperty=function(n){return this[n]},n.setProperty=function(n,t){if(!this._backingStore.hasOwnProperty(n))throw new Error("Unknown property name:"+n);return this[n]=t,this},n.initializeFrom=function(n){var t=this;this.entityType.unmappedProperties.forEach(function(i){var r=i.name;n[r]=t[r]}),this._backingStore||(this._backingStore={})},n._pendingSets=[],n._pendingSets.schedule=function(n,t,i){if(this.push({entity:n,propName:t,value:i}),!this.isPending){this.isPending=!0;var r=this;setTimeout(function(){r.process()})}},n._pendingSets.process=function(){this.length!==0&&(this.forEach(function(n){n.entity._backingStore||(n.entity._backingStore={}),n.entity._backingStore[n.propName]=n.value}),this.length=0,this.isPending=!1)},r(n)},t.prototype.startTracking=function(t,i){i._pendingSets.process();var r=u(t),e=this,f=t.entityType||t.complexType;f.getProperties().forEach(function(i){var u=i.name,e=t[u],f;if(i.isDataProperty)i.isComplexProperty?(f=i.isScalar?i.dataType._createInstanceCore(t,i.name):n.makeComplexArray([],t,i),r[u]=f):e===undefined&&(r[u]=i.defaultValue);else if(i.isNavigationProperty){if(e!==undefined)throw new Error("Cannot assign a navigation property in an entity ctor.: "+i.Name);r[u]=i.isScalar?null:n.makeRelationArray([],t,i)}else throw new Error("unknown property: "+u);})},n.config.registerAdapter("modelLibrary",t)}),function(n){typeof require=="function"&&typeof exports=="object"&&typeof module=="object"?n(require("breeze")):typeof define=="function"&&define.amd&&!t?define(["breeze"],n):n(t)}(function(n){function u(n){n._koObj._suppressBreeze=!0}function f(n){var t=n.relationArray._koObj;t._suppressBreeze?t._suppressBreeze=!1:t.valueHasMutated()}var r=n.core,t,i=function(){this.name="ko"};i.prototype.initialize=function(){t=r.requireLib("ko","The Knockout library"),t.extenders.intercept=function(n,i){var u=i.instance,f=i.property,r;return r=n.splice?t.computed({read:n}):t.computed({read:n,write:function(t){return u._$interceptor(f,t,n),u}})}},i.prototype.getTrackablePropertyNames=function(n){var u=[],i,f;for(i in n)i!=="entityType"&&i!=="_$typeName"&&(f=n[i],t.isObservable(f)?u.push(i):r.isFunction(f)||u.push(i));return u},i.prototype.initializeEntityPrototype=function(n){n.getProperty=function(n){return this[n]()},n.setProperty=function(n,t){return this[n](t),this}},i.prototype.startTracking=function(i){var e=i.entityType||i.complexType;e.getProperties().sort(function(n,t){var i=n.isUnmapped?1:0,r=t.isUnmapped?1:0;return i-r}).forEach(function(r){var s=r.name,e=i[s],o,h;if(t.isObservable(e)){if(r.isNavigationProperty)throw new Error("Cannot assign a navigation property in an entity ctor.: "+r.Name);o=e}else if(r.isDataProperty)r.isComplexProperty?e=r.isScalar?r.dataType._createInstanceCore(i,r.name):n.makeComplexArray([],i,r):e===undefined&&(e=r.defaultValue),o=t.observable(e);else if(r.isNavigationProperty){if(e!==undefined)throw new Error("Cannot assign a navigation property in an entity ctor.: "+r.Name);r.isScalar?o=t.observable(null):(e=n.makeRelationArray([],i,r),o=t.observableArray(e),e._koObj=o,o.subscribe(u,null,"beforeChange"),e.arrayChanged.subscribe(f),o.equalityComparer=function(){throw new Error("Collection navigation properties may NOT be set.");})}else throw new Error("unknown property: "+s);r.isNavigationProperty&&!r.isScalar?i[s]=o:(h=o.extend({intercept:{instance:i,property:r}}),i[s]=h)})},n.config.registerAdapter("modelLibrary",i)}),t.config.initializeAdapterInstances({ajax:"jQuery",dataService:"webApi"}),ir=window.ko,!ir&&window.require&&(ir=window.require("ko")),ir?t.config.initializeAdapterInstance("modelLibrary","ko"):t.config.initializeAdapterInstance("modelLibrary","backingStore"),this.window.breeze=t,t}),!jQuery)throw new Error("Bootstrap requires jQuery");+function(n){"use strict";function t(){var i=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(void 0!==i.style[n])return{end:t[n]}}n.fn.emulateTransitionEnd=function(t){var i=!1,u=this,r;n(this).one(n.support.transition.end,function(){i=!0});return r=function(){i||n(u).trigger(n.support.transition.end)},setTimeout(r,t),this},n(function(){n.support.transition=t()})}(window.jQuery),+function(n){"use strict";var i='[data-dismiss="alert"]',t=function(t){n(t).on("click",i,this.close)},r;t.prototype.close=function(t){function f(){i.trigger("closed.bs.alert").remove()}var u=n(this),r=u.attr("data-target"),i;r||(r=u.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=n(r),t&&t.preventDefault(),i.length||(i=u.hasClass("alert")?u:u.parent()),i.trigger(t=n.Event("close.bs.alert")),t.isDefaultPrevented()||(i.removeClass("in"),n.support.transition&&i.hasClass("fade")?i.one(n.support.transition.end,f).emulateTransitionEnd(150):f())},r=n.fn.alert,n.fn.alert=function(i){return this.each(function(){var r=n(this),u=r.data("bs.alert");u||r.data("bs.alert",u=new t(this)),"string"==typeof i&&u[i].call(r)})},n.fn.alert.Constructor=t,n.fn.alert.noConflict=function(){return n.fn.alert=r,this},n(document).on("click.bs.alert.data-api",i,t.prototype.close)}(window.jQuery),+function(n){"use strict";var t=function(i,r){this.$element=n(i),this.options=n.extend({},t.DEFAULTS,r)},i;t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(n){var i="disabled",t=this.$element,r=t.is("input")?"val":"html",u=t.data();n+="Text",u.resetText||t.data("resetText",t[r]()),t[r](u[n]||this.options[n]),setTimeout(function(){"loadingText"==n?t.addClass(i).attr(i,i):t.removeClass(i).removeAttr(i)},0)},t.prototype.toggle=function(){var n=this.$element.closest('[data-toggle="buttons"]'),t;n.length&&(t=this.$element.find("input").prop("checked",!this.$element.hasClass("active")).trigger("change"),"radio"===t.prop("type")&&n.find(".active").removeClass("active")),this.$element.toggleClass("active")},i=n.fn.button,n.fn.button=function(i){return this.each(function(){var u=n(this),r=u.data("bs.button"),f="object"==typeof i&&i;r||u.data("bs.button",r=new t(this,f)),"toggle"==i?r.toggle():i&&r.setState(i)})},n.fn.button.Constructor=t,n.fn.button.noConflict=function(){return n.fn.button=i,this},n(document).on("click.bs.button.data-api","[data-toggle^=button]",function(t){var i=n(t.target);i.hasClass("btn")||(i=i.closest(".btn")),i.button("toggle"),t.preventDefault()})}(window.jQuery),+function(n){"use strict";var t=function(t,i){this.$element=n(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",n.proxy(this.pause,this)).on("mouseleave",n.proxy(this.cycle,this))},i;t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(n.proxy(this.next,this),this.options.interval)),this},t.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},t.prototype.to=function(t){var r=this,i=this.getActiveIndex();if(!(t>this.$items.length-1)&&!(0>t))return this.sliding?this.$element.one("slid",function(){r.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",n(this.$items[t]))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&n.support.transition.end&&(this.$element.trigger(n.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){if(!this.sliding)return this.slide("next")},t.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},t.prototype.slide=function(t,i){var u=this.$element.find(".item.active"),r=i||u[t](),s=this.interval,f="next"==t?"left":"right",h="next"==t?"first":"last",o=this,e;if(!r.length){if(!this.options.wrap)return;r=this.$element.find(".item")[h]()}if(this.sliding=!0,s&&this.pause(),e=n.Event("slide.bs.carousel",{relatedTarget:r[0],direction:f}),!r.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var t=n(o.$indicators.children()[o.getActiveIndex()]);t&&t.addClass("active")})),n.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(e),e.isDefaultPrevented())return;r.addClass(t),r[0].offsetWidth,u.addClass(f),r.addClass(f),u.one(n.support.transition.end,function(){r.removeClass([t,f].join(" ")).addClass("active"),u.removeClass(["active",f].join(" ")),o.sliding=!1,setTimeout(function(){o.$element.trigger("slid")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(e),e.isDefaultPrevented())return;u.removeClass("active"),r.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}},i=n.fn.carousel,n.fn.carousel=function(i){return this.each(function(){var u=n(this),r=u.data("bs.carousel"),f=n.extend({},t.DEFAULTS,u.data(),"object"==typeof i&&i),e="string"==typeof i?i:f.slide;r||u.data("bs.carousel",r=new t(this,f)),"number"==typeof i?r.to(i):e?r[e]():f.interval&&r.pause().cycle()})},n.fn.carousel.Constructor=t,n.fn.carousel.noConflict=function(){return n.fn.carousel=i,this},n(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(t){var f,i=n(this),r=n(i.attr("data-target")||(f=i.attr("href"))&&f.replace(/.*(?=#[^\s]+$)/,"")),e=n.extend({},r.data(),i.data()),u=i.attr("data-slide-to");u&&(e.interval=!1),r.carousel(e),(u=i.attr("data-slide-to"))&&r.data("bs.carousel").to(u),t.preventDefault()}),n(window).on("load",function(){n('[data-ride="carousel"]').each(function(){var t=n(this);t.carousel(t.data())})})}(window.jQuery),+function(n){"use strict";var t=function(i,r){this.$element=n(i),this.options=n.extend({},t.DEFAULTS,r),this.transitioning=null,this.options.parent&&(this.$parent=n(this.options.parent)),this.options.toggle&&this.toggle()},i;t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var n=this.$element.hasClass("width");return n?"width":"height"},t.prototype.show=function(){var u,t,r,i,f,e;if(!this.transitioning&&!this.$element.hasClass("in")&&(u=n.Event("show.bs.collapse"),this.$element.trigger(u),!u.isDefaultPrevented())){if(t=this.$parent&&this.$parent.find("> .panel > .in"),t&&t.length){if(r=t.data("bs.collapse"),r&&r.transitioning)return;t.collapse("hide"),r||t.data("bs.collapse",null)}if(i=this.dimension(),this.$element.removeClass("collapse").addClass("collapsing")[i](0),this.transitioning=1,f=function(){this.$element.removeClass("collapsing").addClass("in")[i]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")},!n.support.transition)return f.call(this);e=n.camelCase(["scroll",i].join("-")),this.$element.one(n.support.transition.end,n.proxy(f,this)).emulateTransitionEnd(350)[i](this.$element[0][e])}},t.prototype.hide=function(){var i,t,r;if(!this.transitioning&&this.$element.hasClass("in")&&(i=n.Event("hide.bs.collapse"),this.$element.trigger(i),!i.isDefaultPrevented()))return t=this.dimension(),this.$element[t](this.$element[t]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1,r=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")},n.support.transition?(this.$element[t](0).one(n.support.transition.end,n.proxy(r,this)).emulateTransitionEnd(350),void 0):r.call(this)},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},i=n.fn.collapse,n.fn.collapse=function(i){return this.each(function(){var r=n(this),u=r.data("bs.collapse"),f=n.extend({},t.DEFAULTS,r.data(),"object"==typeof i&&i);u||r.data("bs.collapse",u=new t(this,f)),"string"==typeof i&&u[i]()})},n.fn.collapse.Constructor=t,n.fn.collapse.noConflict=function(){return n.fn.collapse=i,this},n(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(t){var e,i=n(this),s=i.attr("data-target")||t.preventDefault()||(e=i.attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,""),r=n(s),u=r.data("bs.collapse"),h=u?"toggle":i.data(),f=i.attr("data-parent"),o=f&&n(f);u&&u.transitioning||(o&&o.find('[data-toggle=collapse][data-parent="'+f+'"]').not(i).addClass("collapsed"),i[r.hasClass("in")?"addClass":"removeClass"]("collapsed")),r.collapse(h)})}(window.jQuery),+function(n){"use strict";function r(){n(e).remove(),n(i).each(function(t){var i=u(n(this));i.hasClass("open")&&(i.trigger(t=n.Event("hide.bs.dropdown")),t.isDefaultPrevented()||i.removeClass("open").trigger("hidden.bs.dropdown"))})}function u(t){var i=t.attr("data-target"),r;return i||(i=t.attr("href"),i=i&&/#/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")),r=i&&n(i),r&&r.length?r:t.parent()}var e=".dropdown-backdrop",i="[data-toggle=dropdown]",t=function(t){n(t).on("click.bs.dropdown",this.toggle)},f;t.prototype.toggle=function(t){var f=n(this),i,e;if(!f.is(".disabled, :disabled")){if(i=u(f),e=i.hasClass("open"),r(),!e){if("ontouchstart"in document.documentElement&&!i.closest(".navbar-nav").length&&n('<div class="dropdown-backdrop"/>').insertAfter(n(this)).on("click",r),i.trigger(t=n.Event("show.bs.dropdown")),t.isDefaultPrevented())return;i.toggleClass("open").trigger("shown.bs.dropdown"),f.focus()}return!1}},t.prototype.keydown=function(t){var e,o,s,f,r;if(/(38|40|27)/.test(t.keyCode)&&(e=n(this),t.preventDefault(),t.stopPropagation(),!e.is(".disabled, :disabled"))){if(o=u(e),s=o.hasClass("open"),!s||s&&27==t.keyCode)return 27==t.which&&o.find(i).focus(),e.click();f=n("[role=menu] li:not(.divider):visible a",o),f.length&&(r=f.index(f.filter(":focus")),38==t.keyCode&&r>0&&r--,40==t.keyCode&&r<f.length-1&&r++,~r||(r=0),f.eq(r).focus())}},f=n.fn.dropdown,n.fn.dropdown=function(i){return this.each(function(){var r=n(this),u=r.data("dropdown");u||r.data("dropdown",u=new t(this)),"string"==typeof i&&u[i].call(r)})},n.fn.dropdown.Constructor=t,n.fn.dropdown.noConflict=function(){return n.fn.dropdown=f,this},n(document).on("click.bs.dropdown.data-api",r).on("click.bs.dropdown.data-api",".dropdown form",function(n){n.stopPropagation()}).on("click.bs.dropdown.data-api",i,t.prototype.toggle).on("keydown.bs.dropdown.data-api",i+", [role=menu]",t.prototype.keydown)}(window.jQuery),+function(n){"use strict";var t=function(t,i){this.options=i,this.$element=n(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)},i;t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(n){return this[this.isShown?"hide":"show"](n)},t.prototype.show=function(t){var i=this,r=n.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(r),this.isShown||r.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',n.proxy(this.hide,this)),this.backdrop(function(){var u=n.support.transition&&i.$element.hasClass("fade"),r;i.$element.parent().length||i.$element.appendTo(document.body),i.$element.show(),u&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus(),r=n.Event("shown.bs.modal",{relatedTarget:t}),u?i.$element.find(".modal-dialog").one(n.support.transition.end,function(){i.$element.focus().trigger(r)}).emulateTransitionEnd(300):i.$element.focus().trigger(r)}))},t.prototype.hide=function(t){t&&t.preventDefault(),t=n.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),n(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),n.support.transition&&this.$element.hasClass("fade")?this.$element.one(n.support.transition.end,n.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},t.prototype.enforceFocus=function(){n(document).off("focusin.bs.modal").on("focusin.bs.modal",n.proxy(function(n){this.$element[0]===n.target||this.$element.has(n.target).length||this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",n.proxy(function(n){27==n.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var n=this;this.$element.hide(),this.backdrop(function(){n.removeBackdrop(),n.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var r=this.$element.hasClass("fade")?"fade":"",i;if(this.isShown&&this.options.backdrop){if(i=n.support.transition&&r,this.$backdrop=n('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",n.proxy(function(n){n.target===n.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;i?this.$backdrop.one(n.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),n.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(n.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()},i=n.fn.modal,n.fn.modal=function(i,r){return this.each(function(){var f=n(this),u=f.data("bs.modal"),e=n.extend({},t.DEFAULTS,f.data(),"object"==typeof i&&i);u||f.data("bs.modal",u=new t(this,e)),"string"==typeof i?u[i](r):e.show&&u.show(r)})},n.fn.modal.Constructor=t,n.fn.modal.noConflict=function(){return n.fn.modal=i,this},n(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var i=n(this),r=i.attr("href"),u=n(i.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),f=u.data("modal")?"toggle":n.extend({remote:!/#/.test(r)&&r},u.data(),i.data());t.preventDefault(),u.modal(f,this).one("hide",function(){i.is(":visible")&&i.focus()})}),n(document).on("show.bs.modal",".modal",function(){n(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){n(document.body).removeClass("modal-open")})}(window.jQuery),+function(n){"use strict";var t=function(n,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",n,t)},i;t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"><\/div><div class="tooltip-inner"><\/div><\/div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,i,r){var f,e,u,o,s;for(this.enabled=!0,this.type=t,this.$element=n(i),this.options=this.getOptions(r),f=this.options.trigger.split(" "),e=f.length;e--;)if(u=f[e],"click"==u)this.$element.on("click."+this.type,this.options.selector,n.proxy(this.toggle,this));else"manual"!=u&&(o="hover"==u?"mouseenter":"focus",s="hover"==u?"mouseleave":"blur",this.$element.on(o+"."+this.type,this.options.selector,n.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,n.proxy(this.leave,this)));this.options.selector?this._options=n.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=n.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&n.each(this._options,function(n,r){i[n]!=r&&(t[n]=r)}),t},t.prototype.enter=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show),void 0):i.show()},t.prototype.leave=function(t){var i=t instanceof this.constructor?t:n(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide),void 0):i.hide()},t.prototype.show=function(){var o=n.Event("show.bs."+this.type),i,l;if(this.hasContent()&&this.enabled){if(this.$element.trigger(o),o.isDefaultPrevented())return;i=this.tip(),this.setContent(),this.options.animation&&i.addClass("fade");var t="function"==typeof this.options.placement?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,s=/\s?auto?\s?/i,h=s.test(t);h&&(t=t.replace(s,"")||"top"),i.detach().css({top:0,left:0,display:"block"}).addClass(t),this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);var r=this.getPosition(),u=i[0].offsetWidth,f=i[0].offsetHeight;if(h){var e=this.$element.parent(),a=t,c=document.documentElement.scrollTop||document.body.scrollTop,v="body"==this.options.container?window.innerWidth:e.outerWidth(),y="body"==this.options.container?window.innerHeight:e.outerHeight(),p="body"==this.options.container?0:e.offset().left;t="bottom"==t&&r.top+r.height+f-c>y?"top":"top"==t&&r.top-c-f<0?"bottom":"right"==t&&r.right+u>v?"left":"left"==t&&r.left-u<p?"right":t,i.removeClass(a).addClass(t)}l=this.getCalculatedOffset(t,r,u,f),this.applyPlacement(l,t),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(n,t){var h,i=this.tip(),c=i[0].offsetWidth,f=i[0].offsetHeight,e=parseInt(i.css("margin-top"),10),o=parseInt(i.css("margin-left"),10),u,r,s;isNaN(e)&&(e=0),isNaN(o)&&(o=0),n.top=n.top+e,n.left=n.left+o,i.offset(n).addClass("in"),u=i[0].offsetWidth,r=i[0].offsetHeight,("top"==t&&r!=f&&(h=!0,n.top=n.top+f-r),/bottom|top/.test(t))?(s=0,n.left<0&&(s=-2*n.left,n.left=0,i.offset(n),u=i[0].offsetWidth,r=i[0].offsetHeight),this.replaceArrow(s-c+u,u,"left")):this.replaceArrow(r-f,r,"top"),h&&i.offset(n)},t.prototype.replaceArrow=function(n,t,i){this.arrow().css(i,n?50*(1-n/t)+"%":"")},t.prototype.setContent=function(){var n=this.tip(),t=this.getTitle();n.find(".tooltip-inner")[this.options.html?"html":"text"](t),n.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function i(){"in"!=u.hoverState&&t.detach()}var u=this,t=this.tip(),r=n.Event("hide.bs."+this.type);return this.$element.trigger(r),r.isDefaultPrevented()?void 0:(t.removeClass("in"),n.support.transition&&this.$tip.hasClass("fade")?t.one(n.support.transition.end,i).emulateTransitionEnd(150):i(),this.$element.trigger("hidden.bs."+this.type),this)},t.prototype.fixTitle=function(){var n=this.$element;(n.attr("title")||"string"!=typeof n.attr("data-original-title"))&&n.attr("data-original-title",n.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return n.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(n,t,i,r){return"bottom"==n?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==n?{top:t.top-r,left:t.left+t.width/2-i/2}:"left"==n?{top:t.top+t.height/2-r/2,left:t.left-i}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getTitle=function(){var i,t=this.$element,n=this.options;return i=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},t.prototype.tip=function(){return this.$tip=this.$tip||n(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var i=t?n(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;i.tip().hasClass("in")?i.leave(i):i.enter(i)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)},i=n.fn.tooltip,n.fn.tooltip=function(i){return this.each(function(){var u=n(this),r=u.data("bs.tooltip"),f="object"==typeof i&&i;r||u.data("bs.tooltip",r=new t(this,f)),"string"==typeof i&&r[i]()})},n.fn.tooltip.Constructor=t,n.fn.tooltip.noConflict=function(){return n.fn.tooltip=i,this}}(window.jQuery),+function(n){"use strict";var t=function(n,t){this.init("popover",n,t)},i;if(!n.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=n.extend({},n.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"><\/div><h3 class="popover-title"><\/h3><div class="popover-content"><\/div><\/div>'}),t.prototype=n.extend({},n.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var n=this.tip(),t=this.getTitle(),i=this.getContent();n.find(".popover-title")[this.options.html?"html":"text"](t),n.find(".popover-content")[this.options.html?"html":"text"](i),n.removeClass("fade top bottom left right in"),n.find(".popover-title").html()||n.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var t=this.$element,n=this.options;return t.attr("data-content")||("function"==typeof n.content?n.content.call(t[0]):n.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=n(this.options.template)),this.$tip},i=n.fn.popover,n.fn.popover=function(i){return this.each(function(){var u=n(this),r=u.data("bs.popover"),f="object"==typeof i&&i;r||u.data("bs.popover",r=new t(this,f)),"string"==typeof i&&r[i]()})},n.fn.popover.Constructor=t,n.fn.popover.noConflict=function(){return n.fn.popover=i,this}}(window.jQuery),+function(n){"use strict";function t(i,r){var u,f=n.proxy(this.process,this);this.$element=n(i).is("body")?n(window):n(i),this.$body=n("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",f),this.options=n.extend({},t.DEFAULTS,r),this.selector=(this.options.target||(u=n(i).attr("href"))&&u.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=n([]),this.targets=n([]),this.activeTarget=null,this.refresh(),this.process()}t.DEFAULTS={offset:10},t.prototype.refresh=function(){var i=this.$element[0]==window?"offset":"position",t;this.offsets=n([]),this.targets=n([]),t=this,this.$body.find(this.selector).map(function(){var f=n(this),r=f.data("target")||f.attr("href"),u=/^#\w/.test(r)&&n(r);return u&&u.length&&[[u[i]().top+(!n.isWindow(t.$scrollElement.get(0))&&t.$scrollElement.scrollTop()),r]]||null}).sort(function(n,t){return n[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},t.prototype.process=function(){var n,i=this.$scrollElement.scrollTop()+this.options.offset,f=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,e=f-this.$scrollElement.height(),t=this.offsets,r=this.targets,u=this.activeTarget;if(i>=e)return u!=(n=r.last()[0])&&this.activate(n);for(n=t.length;n--;)u!=r[n]&&i>=t[n]&&(!t[n+1]||i<=t[n+1])&&this.activate(r[n])},t.prototype.activate=function(t){this.activeTarget=t,n(this.selector).parents(".active").removeClass("active");var r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=n(r).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate")};var i=n.fn.scrollspy;n.fn.scrollspy=function(i){return this.each(function(){var u=n(this),r=u.data("bs.scrollspy"),f="object"==typeof i&&i;r||u.data("bs.scrollspy",r=new t(this,f)),"string"==typeof i&&r[i]()})},n.fn.scrollspy.Constructor=t,n.fn.scrollspy.noConflict=function(){return n.fn.scrollspy=i,this},n(window).on("load",function(){n('[data-spy="scroll"]').each(function(){var t=n(this);t.scrollspy(t.data())})})}(window.jQuery),+function(n){"use strict";var t=function(t){this.element=n(t)},i;t.prototype.show=function(){var t=this.element,e=t.closest("ul:not(.dropdown-menu)"),i=t.attr("data-target"),r,u,f;(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),t.parent("li").hasClass("active"))||(r=e.find(".active:last a")[0],u=n.Event("show.bs.tab",{relatedTarget:r}),(t.trigger(u),u.isDefaultPrevented())||(f=n(i),this.activate(t.parent("li"),e),this.activate(f,f.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:r})})))},t.prototype.activate=function(t,i,r){function f(){u.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),e?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var u=i.find("> .active"),e=r&&n.support.transition&&u.hasClass("fade");e?u.one(n.support.transition.end,f).emulateTransitionEnd(150):f(),u.removeClass("in")},i=n.fn.tab,n.fn.tab=function(i){return this.each(function(){var u=n(this),r=u.data("bs.tab");r||u.data("bs.tab",r=new t(this)),"string"==typeof i&&r[i]()})},n.fn.tab.Constructor=t,n.fn.tab.noConflict=function(){return n.fn.tab=i,this},n(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),n(this).tab("show")})}(window.jQuery),+function(n){"use strict";var t=function(i,r){this.options=n.extend({},t.DEFAULTS,r),this.$window=n(window).on("scroll.bs.affix.data-api",n.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",n.proxy(this.checkPositionWithEventLoop,this)),this.$element=n(i),this.affixed=this.unpin=null,this.checkPosition()},i;t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0},t.prototype.checkPositionWithEventLoop=function(){setTimeout(n.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){var i;if(this.$element.is(":visible")){var s=n(document).height(),e=this.$window.scrollTop(),o=this.$element.offset(),r=this.options.offset,f=r.top,u=r.bottom;"object"!=typeof r&&(u=f=r),"function"==typeof f&&(f=r.top()),"function"==typeof u&&(u=r.bottom()),i=null!=this.unpin&&e+this.unpin<=o.top?!1:null!=u&&o.top+this.$element.height()>=s-u?"bottom":null!=f&&f>=e?"top":!1,this.affixed!==i&&(this.unpin&&this.$element.css("top",""),this.affixed=i,this.unpin="bottom"==i?o.top-e:null,this.$element.removeClass(t.RESET).addClass("affix"+(i?"-"+i:"")),"bottom"==i&&this.$element.offset({top:document.body.offsetHeight-u-this.$element.height()}))}},i=n.fn.affix,n.fn.affix=function(i){return this.each(function(){var u=n(this),r=u.data("bs.affix"),f="object"==typeof i&&i;r||u.data("bs.affix",r=new t(this,f)),"string"==typeof i&&r[i]()})},n.fn.affix.Constructor=t,n.fn.affix.noConflict=function(){return n.fn.affix=i,this},n(window).on("load",function(){n('[data-spy="affix"]').each(function(){var i=n(this),t=i.data();t.offset=t.offset||{},t.offsetBottom&&(t.offset.bottom=t.offsetBottom),t.offsetTop&&(t.offset.top=t.offsetTop),i.affix(t)})})}(window.jQuery),d3=function(){function ie(n){return null!=n&&!isNaN(n)}function aw(n){return n.length}function vw(n){for(var t=1;n*t%1;)t*=10;return t}function fc(n,t){try{for(var i in t)Object.defineProperty(n.prototype,i,{value:t[i],enumerable:!1})}catch(r){n.prototype=t}}function g(){}function re(){}function yw(n,t,i){return function(){var r=i.apply(t,arguments);return r===t?n:r}}function ue(n,t){var i,u,r;if(t in n)return t;for(t=t.charAt(0).toUpperCase()+t.substring(1),i=0,u=ds.length;u>i;++i)if(r=ds[i]+t,r in n)return r}function pw(n){for(var t=n.length,i=new Array(t);t--;)i[t]=n[t];return i}function ww(n){return Array.prototype.slice.call(n)}function s(){}function fe(){}function ec(n){function r(){for(var i,r=t,u=-1,f=r.length;++u<f;)(i=r[u].on)&&i.apply(this,arguments);return n}var t=[],i=new g;return r.on=function(r,u){var e,f=i.get(r);return arguments.length<2?f&&f.on:(f&&(f.on=null,t=t.slice(0,e=t.indexOf(f)).concat(t.slice(e+1)),i.remove(r)),u&&t.push(i.set(r,{on:u})),n)},r}function at(){n.event.preventDefault()}function oc(){for(var i,t=n.event;i=t.sourceEvent;)t=i;return t}function ee(t){for(var i=new fe,r=0,u=arguments.length;++r<u;)i[arguments[r]]=ec(i);return i.of=function(r,u){return function(f){try{var e=f.sourceEvent=n.event;f.target=t,n.event=f,i[f.type].apply(r,u)}finally{n.event=e}}},i}function vt(n){return yu(n,u),n}function oe(n){return"function"==typeof n?n:function(){return gs(n,this)}}function sc(n){return"function"==typeof n?n:function(){return nh(n,this)}}function hc(t,i){function r(){this.removeAttribute(t)}function u(){this.removeAttributeNS(t.space,t.local)}function f(){this.setAttribute(t,i)}function e(){this.setAttributeNS(t.space,t.local,i)}function o(){var n=i.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function s(){var n=i.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=n.ns.qualify(t),null==i?t.local?u:r:"function"==typeof i?t.local?s:o:t.local?e:f}function cc(n){return n.trim().replace(/\s+/g," ")}function lc(t){return new RegExp("(?:^|\\s+)"+n.requote(t)+"(?:\\s+|$)","g")}function ac(n,t){function r(){for(var r=-1;++r<i;)n[r](this,t)}function u(){for(var r=-1,u=t.apply(this,arguments);++r<i;)n[r](this,u)}n=n.trim().split(/\s+/).map(bw);var i=n.length;return"function"==typeof t?u:r}function bw(n){var t=lc(n);return function(i,r){if(u=i.classList)return r?u.add(n):u.remove(n);var u=i.getAttribute("class")||"";r?(t.lastIndex=0,t.test(u)||i.setAttribute("class",cc(u+" "+n))):i.setAttribute("class",cc(u.replace(t," ")))}}function vc(n,t,i){function r(){this.style.removeProperty(n)}function u(){this.style.setProperty(n,t,i)}function f(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,i)}return null==t?r:"function"==typeof t?f:u}function yc(n,t){function i(){delete this[n]}function r(){this[n]=t}function u(){var i=t.apply(this,arguments);null==i?delete this[n]:this[n]=i}return null==t?i:"function"==typeof t?u:r}function pc(t){return"function"==typeof t?t:(t=n.ns.qualify(t)).local?function(){return b.createElementNS(t.space,t.local)}:function(){return b.createElementNS(this.namespaceURI,t)}}function se(n){return{__data__:n}}function wc(n){return function(){return gy(this,n)}}function kw(t){return arguments.length||(t=n.ascending),function(n,i){return n&&i?t(n.__data__,i.__data__):!n-!i}}function yt(n,t){for(var i=0,u=n.length;u>i;i++)for(var f,e=n[i],r=0,o=e.length;o>r;r++)(f=e[r])&&t(f,r,i);return n}function bc(n){return yu(n,tt),n}function dw(n){var t,i;return function(r,u,f){var e,o=n[f].update,s=o.length;for(f!=i&&(i=f,t=0),u>=t&&(t=u+1);!(e=o[t])&&++t<s;);return e}}function kc(t,i,r){function o(){var n=this[u];n&&(this.removeEventListener(t,n,n.$),delete this[u])}function c(){var n=h(i,ht(arguments));o.call(this),this.addEventListener(t,this[u]=n,n.$=r),n._=i}function l(){var u,f=new RegExp("^__on([^.]+)"+n.requote(t)+"$"),i,r;for(i in this)(u=i.match(f))&&(r=this[i],this.removeEventListener(u[1],r,r.$),delete this[i])}var u="__on"+t,f=t.indexOf("."),h=dc,e;return f>0&&(t=t.substring(0,f)),e=wu.get(t),e&&(t=e,h=gw),f?i?c:o:i?s:l}function dc(t,i){return function(r){var u=n.event;n.event=r,i[0]=this.__data__;try{t.apply(this,i)}finally{n.event=u}}}function gw(n,t){var i=dc(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||i.call(t,n)}}function yr(){var t=".dragsuppress-"+ ++np,f="touchmove"+t,e="selectstart"+t,o="dragstart"+t,u="click"+t,i=n.select(c).on(f,at).on(e,at).on(o,at),r=wt.style,s=r[bu];return r[bu]="none",function(n){function f(){i.on(u,null)}i.on(t,null),r[bu]=s,n&&(i.on(u,function(){at(),f()},!0),setTimeout(f,0))}}function gc(t,i){var u=t.ownerSVGElement||t,r,f,e;return u.createSVGPoint?(r=u.createSVGPoint(),0>ku&&(c.scrollX||c.scrollY)&&(u=n.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"),f=u[0][0].getScreenCTM(),ku=!(f.f||f.e),u.remove()),ku?(r.x=i.pageX,r.y=i.pageY):(r.x=i.clientX,r.y=i.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]):(e=t.getBoundingClientRect(),[i.clientX-e.left-t.clientLeft,i.clientY-e.top-t.clientTop])}function vi(){}function yi(n,t,i){return new he(n,t,i)}function he(n,t,i){this.h=n,this.s=t,this.l=i}function ce(n,t,i){function e(n){return n>360?n-=360:0>n&&(n+=360),60>n?r+(u-r)*n/60:180>n?u:240>n?r+(u-r)*(240-n)/60:r}function f(n){return Math.round(255*e(n))}var r,u;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,i=0>i?0:i>1?1:i,u=.5>=i?i*(1+t):i+t-i*t,r=2*i-u,ut(f(n+120),f(n),f(n-120))}function nl(n){return n>0?1:0>n?-1:0}function tl(n){return n>1?0:-1>n?t:Math.acos(n)}function ri(n){return n>1?t/2:-1>n?-t/2:Math.asin(n)}function nb(n){return(Math.exp(n)-Math.exp(-n))/2}function tb(n){return(Math.exp(n)+Math.exp(-n))/2}function il(n){return(n=Math.sin(n/2))*n}function pi(n,t,i){return new pr(n,t,i)}function pr(n,t,i){this.h=n,this.c=t,this.l=i}function le(n,t,i){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),wi(i,Math.cos(n*=r)*t,Math.sin(n)*t)}function wi(n,t,i){return new wr(n,t,i)}function wr(n,t,i){this.l=n,this.a=t,this.b=i}function rl(n,t,i){var r=(n+16)/116,u=r+t/500,f=r-i/200;return u=ae(u)*rp,r=ae(r)*up,f=ae(f)*fp,ut(ye(3.2404542*u-1.5371385*r-.4985314*f),ye(-.969266*u+1.8760108*r+.041556*f),ye(.0556434*u-.2040259*r+1.0572252*f))}function ul(n,t,i){return n>0?pi(Math.atan2(i,t)*e,Math.sqrt(t*t+i*i),n):pi(NaN,NaN,n)}function ae(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function ve(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function ye(n){return Math.round(255*(.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function fl(n){return ut(n>>16,255&n>>8,255&n)}function br(n){return fl(n)+""}function ut(n,t,i){return new pe(n,t,i)}function pe(n,t,i){this.r=n,this.g=t,this.b=i}function bi(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function el(n,t,i){var s,r,o,u=0,f=0,e=0;if(s=/([a-z]+)\((.*)\)/i.exec(n))switch(r=s[2].split(","),s[1]){case"hsl":return i(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return t(be(r[0]),be(r[1]),be(r[2]))}return(o=sr.get(n))?t(o.r,o.g,o.b):(null!=n&&"#"===n.charAt(0)&&(4===n.length?(u=n.charAt(1),u+=u,f=n.charAt(2),f+=f,e=n.charAt(3),e+=e):7===n.length&&(u=n.substring(1,3),f=n.substring(3,5),e=n.substring(5,7)),u=parseInt(u,16),f=parseInt(f,16),e=parseInt(e,16)),t(u,f,e))}function ol(n,t,i){var f,s,e=Math.min(n/=255,t/=255,i/=255),r=Math.max(n,t,i),u=r-e,o=(r+e)/2;return u?(s=.5>o?u/(r+e):u/(2-r-e),f=n==r?(t-i)/u+(i>t?6:0):t==r?(i-n)/u+2:(n-t)/u+4,f*=60):(f=NaN,s=o>0&&1>o?0:f),yi(f,s,o)}function sl(n,t,i){n=we(n),t=we(t),i=we(i);var u=ve((.4124564*n+.3575761*t+.1804375*i)/rp),r=ve((.2126729*n+.7151522*t+.072175*i)/up),f=ve((.0193339*n+.119192*t+.9503041*i)/fp);return wi(116*r-16,500*(u-r),200*(r-f))}function we(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function be(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function f(n){return"function"==typeof n?n:function(){return n}}function a(n){return n}function ke(n){return function(t,i,r){return 2===arguments.length&&"function"==typeof i&&(r=i,i=null),de(t,i,n,r)}}function de(t,i,r,u){function l(){var t,n=e.status;if(!n&&e.responseText||n>=200&&300>n||304===n){try{t=r.call(f,e)}catch(i){return s.error.call(f,i),void 0}s.load.call(f,t)}else s.error.call(f,e)}var f={},s=n.dispatch("progress","load","error"),o={},e=new XMLHttpRequest,h=null;return!c.XDomainRequest||"withCredentials"in e||!/^(http(s)?:)?\/\//.test(t)||(e=new XDomainRequest),"onload"in e?e.onload=e.onerror=l:e.onreadystatechange=function(){e.readyState>3&&l()},e.onprogress=function(t){var i=n.event;n.event=t;try{s.progress.call(f,e)}finally{n.event=i}},f.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?o[n]:(null==t?delete o[n]:o[n]=t+"",f)},f.mimeType=function(n){return arguments.length?(i=null==n?null:n+"",f):i},f.responseType=function(n){return arguments.length?(h=n,f):h},f.response=function(n){return r=n,f},["get","post"].forEach(function(n){f[n]=function(){return f.send.apply(f,[n].concat(ht(arguments)))}}),f.send=function(n,r,u){if(2===arguments.length&&"function"==typeof r&&(u=r,r=null),e.open(n,t,!0),null==i||"accept"in o||(o.accept=i+",*/*"),e.setRequestHeader)for(var s in o)e.setRequestHeader(s,o[s]);return null!=i&&e.overrideMimeType&&e.overrideMimeType(i),null!=h&&(e.responseType=h),null!=u&&f.on("error",u).on("load",function(n){u(null,n)}),e.send(null==r?null:r),f},f.abort=function(){return e.abort(),f},n.rebind(f,s,"on"),null==u?f:f.get(ib(u))}function ib(n){return 1===n.length?function(t,i){n(null==t?i:null)}:n}function ge(){var t=cl(),n=ll()-t;n>24?(isFinite(n)&&(clearTimeout(ef),ef=setTimeout(ge,n)),ff=0):(ff=1,uh(ge))}function hl(n,t,i){var r=arguments.length;2>r&&(t=0),3>r&&(i=Date.now()),it.callback=n,it.time=i+t}function cl(){var n=Date.now();for(it=rf;it;)n>=it.time&&(it.flush=it.callback(n-it.time)),it=it.next;return n}function ll(){for(var t,n=rf,i=1/0;n;)n.flush?n=t?t.next=n.next:rf=n.next:(n.time<i&&(i=n.time),n=(t=n).next);return uf=t,i}function rb(n,t){var i=Math.pow(10,3*Math.abs(8-t));return{scale:t>8?function(n){return n/i}:function(n){return n*i},symbol:n}}function no(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function ub(n){return n+""}function to(){}function al(n,t,i){var r=i.s=n+t,u=r-n,f=r-u;i.t=n-f+(t-u)}function kr(n,t){n&&oh.hasOwnProperty(n.type)&&oh[n.type](n,t)}function io(n,t,i){var r,u=-1,f=n.length-i;for(t.lineStart();++u<f;)r=n[u],t.point(r[0],r[1]);t.lineEnd()}function vl(n,t){var i=-1,r=n.length;for(t.polygonStart();++i<r;)io(n[i],t,1);t.polygonEnd()}function fb(){function f(f,e){f*=r,e=e*r/2+t/4;var o=f-n,s=Math.cos(e),h=Math.sin(e),c=u*h,l=i*s+c*Math.cos(o),a=c*Math.sin(o);bt.add(Math.atan2(a,l)),n=f,i=s,u=h}var e,o,n,i,u;y.point=function(s,h){y.point=f,n=(e=s)*r,i=Math.cos(h=(o=h)*r/2+t/4),u=Math.sin(h)},y.lineEnd=function(){f(e,o)}}function ui(n){var t=n[0],i=n[1],r=Math.cos(i);return[r*Math.cos(t),r*Math.sin(t),Math.sin(i)]}function dr(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function ki(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function ro(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function gr(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function nu(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function tu(n){return[Math.atan2(n[1],n[0]),ri(n[2])]}function iu(n,t){return Math.abs(n[0]-t[0])<i&&Math.abs(n[1]-t[1])<i}function uo(n,t){n*=r;var i=Math.cos(t*=r);nr(i*Math.cos(n),i*Math.sin(n),Math.sin(t))}function nr(n,t,i){++cr,ci+=(n-ci)/cr,li+=(t-li)/cr,ct+=(i-ct)/cr}function yl(){function u(u,f){u*=r;var c=Math.cos(f*=r),o=c*Math.cos(u),s=c*Math.sin(u),h=Math.sin(f),e=Math.atan2(Math.sqrt((e=t*h-i*s)*e+(e=i*o-n*h)*e+(e=n*s-t*o)*e),n*o+t*s+i*h);hf+=e,kt+=e*(n+(n=o)),dt+=e*(t+(t=s)),rt+=e*(i+(i=h)),nr(n,t,i)}var n,t,i;k.point=function(f,e){f*=r;var o=Math.cos(e*=r);n=o*Math.cos(f),t=o*Math.sin(f),i=Math.sin(e),k.point=u,nr(n,t,i)}}function pl(){k.point=uo}function eb(){function u(u,f){u*=r;var p=Math.cos(f*=r),e=p*Math.cos(u),o=p*Math.sin(u),s=Math.sin(f),c=t*s-i*o,l=i*e-n*s,a=n*o-t*e,v=Math.sqrt(c*c+l*l+a*a),w=n*e+t*o+i*s,y=v&&-tl(w)/v,h=Math.atan2(v,w);di+=y*c,gi+=y*l,gt+=y*a,hf+=h,kt+=h*(n+(n=e)),dt+=h*(t+(t=o)),rt+=h*(i+(i=s)),nr(n,t,i)}var f,e,n,t,i;k.point=function(o,s){f=o,e=s,k.point=u,o*=r;var h=Math.cos(s*=r);n=h*Math.cos(o),t=h*Math.sin(o),i=Math.sin(s),nr(n,t,i)},k.lineEnd=function(){u(f,e),k.lineEnd=pl,k.point=uo}}function tr(){return!0}function wl(n,t,i,r,u){var h=[],o=[],f,s,c,l,e;if(n.forEach(function(n){var s,i,r,e,t,f;if(!((s=n.length-1)<=0)){if(i=n[0],r=n[s],iu(i,r)){for(u.lineStart(),e=0;s>e;++e)u.point((i=n[e])[0],i[1]);return u.lineEnd(),void 0}t={point:i,points:n,other:null,visited:!1,entry:!0,subject:!0},f={point:i,points:[i],other:t,visited:!1,entry:!1,subject:!1},t.other=f,h.push(t),o.push(f),t={point:r,points:[r],other:null,visited:!1,entry:!1,subject:!0},f={point:r,points:[r],other:t,visited:!1,entry:!0,subject:!1},t.other=f,h.push(t),o.push(f)}}),o.sort(t),bl(h),bl(o),h.length){if(i)for(var e=1,a=!i(o[0].point),v=o.length;v>e;++e)o[e].entry=a=!a;for(l=h[0];;){for(f=l;f.visited;)if((f=f.next)===l)return;s=f.points,u.lineStart();do{if(f.visited=f.other.visited=!0,f.entry){if(f.subject)for(e=0;e<s.length;e++)u.point((c=s[e])[0],c[1]);else r(f.point,f.next.point,1,u);f=f.next}else{if(f.subject)for(s=f.prev.points,e=s.length;--e>=0;)u.point((c=s[e])[0],c[1]);else r(f.point,f.prev.point,-1,u);f=f.prev}f=f.other,s=f.points}while(!f.visited);u.lineEnd()}}}function bl(n){if(r=n.length){for(var r,t,u=0,i=n[0];++u<r;)i.next=t=n[u],t.prev=i,i=t;i.next=t=n[0],t.prev=i}}function kl(t,i,r,u){return function(f){function l(n,i){t(n,i)&&f.point(n,i)}function b(n,t){a.point(n,t)}function v(){e.point=b,a.lineStart()}function y(){e.point=l,a.lineEnd()}function p(n,t){c.point(n,t),s.push([n,t])}function k(){c.lineStart(),s=[]}function d(){var e,t,r;p(s[0][0],s[0][1]),c.lineEnd();var i,u=c.clean(),n=w.buffer(),t=n.length;if(s.pop(),h.push(s),s=null,t){if(1&u){for(i=n[0],t=i.length-1,r=-1,f.lineStart();++r<t;)f.point((e=i[r])[0],e[1]);return f.lineEnd(),void 0}t>1&&2&u&&n.push(n.pop().concat(n.shift())),o.push(n.filter(ob))}}var o,h,s,a=i(f),e={point:l,lineStart:v,lineEnd:y,polygonStart:function(){e.point=p,e.lineStart=k,e.lineEnd=d,o=[],h=[],f.polygonStart()},polygonEnd:function(){e.point=l,e.lineStart=v,e.lineEnd=y,o=n.merge(o),o.length?wl(o,sb,null,r,f):u(h)&&(f.lineStart(),r(null,null,1,f),f.lineEnd()),f.polygonEnd(),o=h=null},sphere:function(){f.polygonStart(),f.lineStart(),r(null,null,1,f),f.lineEnd(),f.polygonEnd()}},w=dl(),c=i(w);return e}}function ob(n){return n.length>1}function dl(){var t,n=[];return{lineStart:function(){n.push(t=[])},point:function(n,i){t.push([n,i])},lineEnd:s,buffer:function(){var i=n;return n=[],t=null,i},rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))}}}function sb(n,r){return((n=n.point)[0]<0?n[1]-t/2-i:t/2-n[1])-((r=r.point)[0]<0?r[1]-t/2-i:t/2-r[1])}function gl(n,r){var f=n[0],st=n[1],ht=[Math.sin(f),-Math.cos(f),0],l=0,k=!1,d=!1,g=0,e,nt,o,a,w,b,ot;for(bt.reset(),e=0,nt=r.length;nt>e;++e)if(o=r[e],a=o.length,a){for(var s=o[0],v=s[0],tt=s[1]/2+t/4,it=Math.sin(tt),rt=Math.cos(tt),h=1;;){h===a&&(h=0),n=o[h];var y=n[0],p=n[1]/2+t/4,ut=Math.sin(p),ft=Math.cos(p),u=y-v,c=Math.abs(u)>t,et=it*ut;if((bt.add(Math.atan2(et*Math.sin(u),rt*ft+et*Math.cos(u))),Math.abs(p)<i&&(d=!0),l+=c?u+(u>=0?2:-2)*t:u,c^v>=f^y>=f)&&(w=ki(ui(s),ui(n)),nu(w),b=ki(ht,w),nu(b),ot=(c^u>=0?-1:1)*ri(b[2]),st>ot&&(g+=c^u>=0?1:-1)),!h++)break;v=y,it=ut,rt=ft,s=n}Math.abs(l)>i&&(k=!0)}return(!d&&!k&&0>bt||-i>l)^1&g}function hb(n){var e,u=NaN,r=NaN,f=NaN;return{lineStart:function(){n.lineStart(),e=1},point:function(o,s){var h=o>0?t:-t,c=Math.abs(o-u);Math.abs(c-t)<i?(n.point(u,r=(r+s)/2>0?t/2:-t/2),n.point(f,r),n.lineEnd(),n.lineStart(),n.point(h,r),n.point(o,r),e=0):f!==h&&c>=t&&(Math.abs(u-f)<i&&(u-=f*i),Math.abs(o-h)<i&&(o-=h*i),r=cb(u,r,o,s),n.point(f,r),n.lineEnd(),n.lineStart(),n.point(h,r),e=0),n.point(u=o,r=s),f=h},lineEnd:function(){n.lineEnd(),u=r=NaN},clean:function(){return 2-e}}}function cb(n,t,r,u){var f,e,o=Math.sin(n-r);return Math.abs(o)>i?Math.atan((Math.sin(t)*(e=Math.cos(u))*Math.sin(r)-Math.sin(u)*(f=Math.cos(t))*Math.sin(n))/(f*e*o)):(t+u)/2}function lb(n,r,u,f){var e,o;null==n?(e=u*t/2,f.point(-t,e),f.point(0,e),f.point(t,e),f.point(t,0),f.point(t,-e),f.point(0,-e),f.point(-t,-e),f.point(-t,0),f.point(-t,e)):Math.abs(n[0]-r[0])>i?(o=(n[0]<r[0]?1:-1)*t,e=u*o/2,f.point(-o,e),f.point(0,e),f.point(o,e)):f.point(r[0],r[1])}function ab(n){return gl(rit,n)}function vb(n){function o(n,t){return Math.cos(n)*Math.cos(t)>u}function h(n){var r,l,u,c,h;return{lineStart:function(){c=u=!1,h=1},point:function(v,y){var w,p=[v,y],b=o(v,y),d=e?b?0:s(v,y):b?s(v+(0>v?t:-t),y):0,k;(!r&&(c=u=b)&&n.lineStart(),b!==u&&(w=f(r,p),(iu(r,w)||iu(p,w))&&(p[0]+=i,p[1]+=i,b=o(p[0],p[1]))),b!==u)?(h=0,b?(n.lineStart(),w=f(p,r),n.point(w[0],w[1])):(w=f(r,p),n.point(w[0],w[1]),n.lineEnd()),r=w):a&&r&&e^b&&(d&l||!(k=f(p,r,!0))||(h=0,e?(n.lineStart(),n.point(k[0][0],k[0][1]),n.point(k[1][0],k[1][1]),n.lineEnd()):(n.point(k[1][0],k[1][1]),n.lineEnd(),n.lineStart(),n.point(k[0][0],k[0][1])))),!b||r&&iu(r,p)||n.point(p[0],p[1]),r=p,u=b,l=d},lineEnd:function(){u&&n.lineEnd(),r=null},clean:function(){return h|(c&&u)<<1}}}function f(n,r,f){var ft=ui(n),et=ui(r),it=[1,0,0],l=ki(ft,et),rt=dr(l,l),w=l[0],b=rt-w*w,d,e,tt;if(!b)return!f&&n;var ot=u*rt/b,st=-u*w/b,ht=ki(it,l),o=gr(it,ot),ct=gr(l,st);ro(o,ct);var a=ht,y=dr(o,a),k=dr(a,a),ut=y*y-k*(dr(o,o)-1);if(!(0>ut)){if(d=Math.sqrt(ut),e=gr(a,(-y-d)/k),ro(e,o),e=tu(e),!f)return e;var p,s=n[0],v=r[0],h=n[1],c=r[1];s>v&&(p=s,s=v,v=p);var g=v-s,nt=Math.abs(g-t)<i,lt=nt||i>g;if(!nt&&h>c&&(p=h,h=c,c=p),lt?nt?h+c>0^e[1]<(Math.abs(e[0]-s)<i?h:c):h<=e[1]&&e[1]<=c:g>t^(s<=e[0]&&e[0]<=v))return tt=gr(a,(-y+d)/k),ro(tt,o),[e,tu(tt)]}}function s(i,r){var f=e?n:t-n,u=0;return-f>i?u|=1:i>f&&(u|=2),-f>r?u|=4:r>f&&(u|=8),u}function c(n){return gl(l,n)}var u=Math.cos(n),e=u>0,l=[n,0],a=Math.abs(u)>i,v=so(n,6*r);return kl(o,h,v,c)}function yb(t,r,u,f){function e(n,f){return Math.abs(n[0]-t)<i?f>0?0:3:Math.abs(n[0]-u)<i?f>0?2:1:Math.abs(n[1]-r)<i?f>0?1:0:f>0?3:2}function s(n,t){return o(n.point,t.point)}function o(n,t){var i=e(n,1),r=e(t,1);return i!==r?i-r:0===i?t[1]-n[1]:1===i?n[0]-t[0]:2===i?n[1]-t[1]:t[0]-n[0]}function h(n,e){var s=e[0]-n[0],h=e[1]-n[1],o=[0,1];return Math.abs(s)<i&&Math.abs(h)<i?t<=n[0]&&n[0]<=u&&r<=n[1]&&n[1]<=f:ru(t-n[0],s,o)&&ru(n[0]-u,-s,o)&&ru(r-n[1],h,o)&&ru(n[1]-f,-h,o)?(o[1]<1&&(e[0]=n[0]+o[1]*s,e[1]=n[1]+o[1]*h),o[0]>0&&(n[0]+=o[0]*s,n[1]+=o[0]*h),!0):!1}return function(i){function ot(n){var i=e(n,-1);return d([0===i||3===i?t:u,i>1?f:r])}function d(n){for(var r=0,s=l.length,u=n[1],f=0;s>f;++f)for(var t,e=1,o=l[f],h=o.length,i=o[0];h>e;++e)t=o[e],i[1]<=u?t[1]>u&&g(i,t,n)>0&&++r:t[1]<=u&&g(i,t,n)<0&&--r,i=t;return 0!==r}function g(n,t,i){return(t[0]-n[0])*(i[1]-n[1])-(i[0]-n[0])*(t[1]-n[1])}function nt(n,i,s,h){var c=0,l=0;if(null==n||(c=e(n,s))!==(l=e(i,s))||o(n,i)<0^s>0){do h.point(0===c||3===c?t:u,c>1?f:r);while((c=(c+s+4)%4)!==l)}else h.point(i[0],i[1])}function tt(n,i){return n>=t&&u>=n&&i>=r&&f>=i}function it(n,t){tt(n,t)&&i.point(n,t)}function st(){k.point=rt,l&&l.push(v=[]),w=!0,a=!1,y=p=NaN}function ht(){c&&(rt(ut,ft),et&&a&&b.rejoin(),c.push(b.buffer())),k.point=it,a&&i.lineEnd()}function rt(n,t){var r,u,f;n=Math.max(-cf,Math.min(cf,n)),t=Math.max(-cf,Math.min(cf,t)),r=tt(n,t),(l&&v.push([n,t]),w)?(ut=n,ft=t,et=r,w=!1,r&&(i.lineStart(),i.point(n,t))):r&&a?i.point(n,t):(u=[y,p],f=[n,t],h(u,f)?(a||(i.lineStart(),i.point(u[0],u[1])),i.point(f[0],f[1]),r||i.lineEnd()):r&&(i.lineStart(),i.point(n,t))),y=n,p=t,a=r}var c,l,v,ut,ft,et,y,p,a,w,ct=i,b=dl(),k={point:it,lineStart:st,lineEnd:ht,polygonStart:function(){i=b,c=[],l=[]},polygonEnd:function(){i=ct,(c=n.merge(c)).length?(i.polygonStart(),wl(c,s,ot,nt,i),i.polygonEnd()):d([t,r])&&(i.polygonStart(),i.lineStart(),nt(null,null,1,i),i.lineEnd(),i.polygonEnd()),c=l=v=null}};return k}}function ru(n,t,r){if(Math.abs(t)<i)return 0>=n;var u=n/t;if(t>0){if(u>r[1])return!1;u>r[0]&&(r[0]=u)}else{if(u<r[0])return!1;u<r[1]&&(r[1]=u)}return!0}function na(n,t){function i(i,r){return i=n(i,r),t(i[0],i[1])}return n.invert&&t.invert&&(i.invert=function(i,r){return i=t.invert(i,r),i&&n.invert(i[0],i[1])}),i}function fo(n){var i=0,r=t/3,u=eo(n),f=u(i,r);return f.parallels=function(n){return arguments.length?u(i=n[0]*t/180,r=n[1]*t/180):[180*(i/t),180*(r/t)]},f}function ta(n,t){function f(n,t){var r=Math.sqrt(u-2*i*Math.sin(t))/i;return[r*Math.sin(n*=i),e-r*Math.cos(n)]}var r=Math.sin(n),i=(r+Math.sin(t))/2,u=1+r*(2*i-r),e=Math.sqrt(u)/i;return f.invert=function(n,t){var r=e-t;return[Math.atan2(n,r)/i,ri((u-(n*n+r*r)*i*i)/(2*i))]},f}function pb(){function i(i,r){hh+=t*i-n*r,n=i,t=r}var r,u,n,t;ni.point=function(f,e){ni.point=i,r=n=f,u=t=e},ni.lineEnd=function(){i(r,u)}}function wb(n,t){lf>n&&(lf=n),n>vf&&(vf=n),af>t&&(af=t),t>yf&&(yf=t)}function bb(){function i(n,i){t.push("M",n,",",i,u)}function f(i,r){t.push("M",i,",",r),n.point=e}function e(n,i){t.push("L",n,",",i)}function r(){n.point=i}function o(){t.push("Z")}var u=ia(4.5),t=[],n={point:i,lineStart:function(){n.point=f},lineEnd:r,polygonStart:function(){n.lineEnd=o},polygonEnd:function(){n.lineEnd=r,n.point=i},pointRadius:function(t){return u=ia(t),n},result:function(){if(t.length){var n=t.join("");return t=[],n}}};return n}function ia(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function fi(n,t){ci+=n,li+=t,++ct}function ra(){function i(i,r){var f=i-n,e=r-t,u=Math.sqrt(f*f+e*e);kt+=u*(n+i)/2,dt+=u*(t+r)/2,rt+=u,fi(n=i,t=r)}var n,t;d.point=function(r,u){d.point=i,fi(n=r,t=u)}}function ua(){d.point=fi}function kb(){function i(i,r){var f=i-n,e=r-t,u=Math.sqrt(f*f+e*e);kt+=u*(n+i)/2,dt+=u*(t+r)/2,rt+=u,u=t*i-n*r,di+=u*(n+i),gi+=u*(t+r),gt+=3*u,fi(n=i,t=r)}var r,u,n,t;d.point=function(f,e){d.point=i,fi(r=n=f,u=t=e)},d.lineEnd=function(){i(r,u)}}function db(n){function r(i,r){n.moveTo(i,r),n.arc(i,r,f,0,2*t)}function e(t,r){n.moveTo(t,r),i.point=o}function o(t,i){n.lineTo(t,i)}function u(){i.point=r}function h(){n.closePath()}var f=4.5,i={point:r,lineStart:function(){i.point=e},lineEnd:u,polygonStart:function(){i.lineEnd=h},polygonEnd:function(){i.lineEnd=u,i.point=r},pointRadius:function(n){return f=n,i},result:s};return i}function fa(n){function f(i){function y(t,r){t=n(t,r),i.point(t[0],t[1])}function c(){u=NaN,r.point=l,i.lineStart()}function l(r,c){var l=ui([r,c]),a=n(r,c);t(u,f,v,o,s,h,u=a[0],f=a[1],v=r,o=l[0],s=l[1],h=l[2],e,i),i.point(u,f)}function a(){r.point=y,i.lineEnd()}function nt(){c(),r.point=tt,r.lineEnd=it}function tt(n,t){l(p=n,rt=t),w=u,b=f,k=o,d=s,g=h,r.point=l}function it(){t(u,f,v,o,s,h,w,b,p,k,d,g,e,i),r.lineEnd=a,a()}var p,rt,w,b,k,d,g,v,u,f,o,s,h,r={point:y,lineStart:c,lineEnd:a,polygonStart:function(){i.polygonStart(),r.lineStart=nt},polygonEnd:function(){i.polygonEnd(),r.lineStart=c}};return r}function t(r,f,e,s,h,c,l,a,v,y,p,w,b,k){var tt=l-r,it=a-f,ft=tt*tt+it*it;if(ft>4*u&&b--){var g=s+y,nt=h+p,d=c+w,et=Math.sqrt(g*g+nt*nt+d*d),at=Math.asin(d/=et),ot=Math.abs(Math.abs(d)-1)<i?(e+v)/2:Math.atan2(nt,g),st=n(ot,at),rt=st[0],ut=st[1],ht=rt-r,ct=ut-f,lt=it*ht-tt*ct;(lt*lt/ft>u||Math.abs((tt*ht+it*ct)/ft-.5)>.3||o>s*y+h*p+c*w)&&(t(r,f,e,s,h,c,rt,ut,ot,g/=et,nt/=et,d,b,k),k.point(rt,ut),t(rt,ut,ot,g,nt,d,l,a,v,y,p,w,b,k))}}var u=.5,o=Math.cos(30*r),e=16;return f.precision=function(n){return arguments.length?(e=(u=n*n)>0&&16,f):Math.sqrt(u)},f}function gb(n){var t=fa(function(t,i){return n([t*e,i*e])});return function(n){return n=t(n),{point:function(t,i){n.point(t*r,i*r)},sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}}function pt(n){return eo(function(){return n})()}function eo(t){function i(n){return n=v(n[0]*r,n[1]*r),[n[0]*u+h,c-n[1]*u]}function et(n){return n=v.invert((n[0]-h)/u,(c-n[1])/u),n&&[n[0]*e,n[1]*e]}function o(){v=na(tt=oo(k,d,g),s);var n=s(w,b);return h=y-n[0]*u,c=p+n[1]*u,l()}function l(){return f&&(f.valid=!1,f=null),i}var s,tt,v,h,c,f,it=fa(function(n,t){return n=s(n,t),[n[0]*u+h,c-n[1]*u]}),u=150,y=480,p=250,w=0,b=0,k=0,d=0,g=0,rt=sp,ut=a,nt=null,ft=null;return i.stream=function(n){return f&&(f.valid=!1),f=nk(tt,rt(it(ut(n)))),f.valid=!0,f},i.clipAngle=function(n){return arguments.length?(rt=null==n?(nt=n,sp):vb((nt=+n)*r),l()):nt},i.clipExtent=function(n){return arguments.length?(ft=n,ut=null==n?a:yb(n[0][0],n[0][1],n[1][0],n[1][1]),l()):ft},i.scale=function(n){return arguments.length?(u=+n,o()):u},i.translate=function(n){return arguments.length?(y=+n[0],p=+n[1],o()):[y,p]},i.center=function(n){return arguments.length?(w=n[0]%360*r,b=n[1]%360*r,o()):[w*e,b*e]},i.rotate=function(n){return arguments.length?(k=n[0]%360*r,d=n[1]%360*r,g=n.length>2?n[2]%360*r:0,o()):[k*e,d*e,g*e]},n.rebind(i,it,"precision"),function(){return s=t.apply(this,arguments),i.invert=s.invert&&et,o()}}function nk(n,i){return{point:function(u,f){f=n(u*r,f*r),u=f[0],i.point(u>t?u-2*t:-t>u?u+2*t:u,f[1])},sphere:function(){i.sphere()},lineStart:function(){i.lineStart()},lineEnd:function(){i.lineEnd()},polygonStart:function(){i.polygonStart()},polygonEnd:function(){i.polygonEnd()}}}function ir(n,t){return[n,t]}function oo(n,t,i){return n?t||i?na(oa(n),sa(t,i)):oa(n):t||i?sa(t,i):ir}function ea(n){return function(i,r){return i+=n,[i>t?i-2*t:-t>i?i+2*t:i,r]}}function oa(n){var t=ea(n);return t.invert=ea(-n),t}function sa(n,t){function e(n,t){var e=Math.cos(t),o=Math.cos(n)*e,s=Math.sin(n)*e,h=Math.sin(t),c=h*i+o*r;return[Math.atan2(s*u-c*f,o*i-h*r),ri(c*u+s*f)]}var i=Math.cos(n),r=Math.sin(n),u=Math.cos(t),f=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),o=Math.cos(n)*e,s=Math.sin(n)*e,h=Math.sin(t),c=h*u-s*f;return[Math.atan2(s*u+h*f,o*i+c*r),ri(c*i-o*r)]},e}function so(n,i){var r=Math.cos(n),u=Math.sin(n);return function(f,e,o,s){null!=f?(f=ha(r,f),e=ha(r,e),(o>0?e>f:f>e)&&(f+=2*o*t)):(f=n+2*o*t,e=n);for(var c,l=o*i,h=f;o>0?h>e:e>h;h-=l)s.point((c=tu([r,-u*Math.cos(h),-u*Math.sin(h)]))[0],c[1])}}function ha(n,t){var r=ui(t),u;return r[0]-=n,nu(r),u=tl(-r[1]),((-r[2]<0?-u:u)+2*Math.PI-i)%(2*Math.PI)}function ca(t,r,u){var f=n.range(t,r-i,u).concat(r);return function(n){return f.map(function(t){return[n,t]})}}function la(t,r,u){var f=n.range(t,r-i,u).concat(r);return function(n){return f.map(function(t){return[t,n]})}}function ho(n){return n.source}function co(n){return n.target}function tk(n,t,i,r){var f=Math.cos(t),c=Math.sin(t),o=Math.cos(r),l=Math.sin(r),a=f*Math.cos(n),v=f*Math.sin(n),y=o*Math.cos(i),p=o*Math.sin(i),u=2*Math.asin(Math.sqrt(il(r-t)+f*o*il(i-n))),s=1/Math.sin(u),h=u?function(n){var t=Math.sin(n*=u)*s,i=Math.sin(u-n)*s,r=i*a+t*y,f=i*v+t*p,o=i*c+t*l;return[Math.atan2(f,r)*e,Math.atan2(o,Math.sqrt(r*r+f*f))*e]}:function(){return[n*e,t*e]};return h.distance=u,h}function ik(){function u(u,f){var s=Math.sin(f*=r),o=Math.cos(f),e=Math.abs((u*=r)-i),h=Math.cos(e);ch+=Math.atan2(Math.sqrt((e=o*Math.sin(e))*e+(e=t*s-n*o*h)*e),n*s+t*o*h),i=u,n=s,t=o}var i,n,t;ai.point=function(f,e){i=f*r,n=Math.sin(e*=r),t=Math.cos(e),ai.point=u},ai.lineEnd=function(){ai.point=ai.lineEnd=s}}function rr(n,t){function i(t,i){var f=Math.cos(t),r=Math.cos(i),u=n(f*r);return[u*r*Math.sin(t),u*Math.sin(i)]}return i.invert=function(n,i){var r=Math.sqrt(n*n+i*i),u=t(r),f=Math.sin(u),e=Math.cos(u);return[Math.atan2(n*f,r*e),Math.asin(r&&i*f/r)]},i}function aa(n,r){function o(n,r){var o=Math.abs(Math.abs(r)-t/2)<i?0:e/Math.pow(f(r),u);return[o*Math.sin(u*n),e-o*Math.cos(u*n)]}var s=Math.cos(n),f=function(n){return Math.tan(t/4+n/2)},u=n===r?Math.sin(n):Math.log(s/Math.cos(r))/Math.log(f(r)/f(n)),e=s*Math.pow(f(n),u)/u;return u?(o.invert=function(n,i){var r=e-i,f=nl(u)*Math.sqrt(n*n+r*r);return[Math.atan2(n,r)/u,2*Math.atan(Math.pow(e/f,1/u))-t/2]},o):uu}function va(n,t){function f(n,t){var i=u-t;return[i*Math.sin(r*n),u-i*Math.cos(r*n)]}var e=Math.cos(n),r=n===t?Math.sin(n):(e-Math.cos(t))/(t-n),u=e/r+n;return Math.abs(r)<i?ir:(f.invert=function(n,t){var i=u-t;return[Math.atan2(n,i)/r,u-nl(r)*Math.sqrt(n*n+i*i)]},f)}function uu(n,i){return[n,Math.log(Math.tan(t/4+i/2))]}function ya(n){var r,i=pt(n),u=i.scale,f=i.translate,e=i.clipExtent;return i.scale=function(){var n=u.apply(i,arguments);return n===i?r?i.clipExtent(null):i:n},i.translate=function(){var n=f.apply(i,arguments);return n===i?r?i.clipExtent(null):i:n},i.clipExtent=function(n){var h=e.apply(i,arguments),o,s;return h===i?(r=null==n)&&(o=t*u(),s=f(),e([[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]])):r&&(h=null),h},i.clipExtent(null)}function lo(n,t){var i=Math.cos(t)*Math.sin(n);return[Math.log((1+i)/(1-i))/2,Math.atan2(Math.tan(t),Math.cos(n))]}function pa(n){function t(t){function a(){l.push("M",i(n(s),o))}for(var c,l=[],s=[],h=-1,v=t.length,y=f(r),p=f(u);++h<v;)e.call(this,c=t[h],h)?s.push([+y.call(this,c,h),+p.call(this,c,h)]):s.length&&(a(),s=[]);return s.length&&a(),l.length?l.join(""):null}var r=nt,u=ft,e=tr,i=p,s=i.key,o=.7;return t.x=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(u=n,t):u},t.defined=function(n){return arguments.length?(e=n,t):e},t.interpolate=function(n){return arguments.length?(s="function"==typeof n?i=n:(i=pf.get(n)||p).key,t):s},t.tension=function(n){return arguments.length?(o=n,t):o},t}function nt(n){return n[0]}function ft(n){return n[1]}function p(n){return n.join("L")}function rk(n){return p(n)+"Z"}function uk(n){for(var r=0,u=n.length,t=n[0],i=[t[0],",",t[1]];++r<u;)i.push("H",(t[0]+(t=n[r])[0])/2,"V",t[1]);return u>1&&i.push("H",t[0]),i.join("")}function ao(n){for(var i=0,u=n.length,t=n[0],r=[t[0],",",t[1]];++i<u;)r.push("V",(t=n[i])[1],"H",t[0]);return r.join("")}function vo(n){for(var i=0,u=n.length,t=n[0],r=[t[0],",",t[1]];++i<u;)r.push("H",(t=n[i])[0],"V",t[1]);return r.join("")}function fk(n,t){return n.length<4?p(n):n[1]+fu(n.slice(1,n.length-1),yo(n,t))}function ek(n,t){return n.length<3?p(n):n[0]+fu((n.push(n[0]),n),yo([n[n.length-2]].concat(n,[n[1]]),t))}function ok(n,t){return n.length<3?p(n):n[0]+fu(n,yo(n,t))}function fu(n,t){var o,h;if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return p(n);var c=n.length!=t.length,f="",s=n[0],i=n[1],e=t[0],r=e,u=1;if(c&&(f+="Q"+(i[0]-2*e[0]/3)+","+(i[1]-2*e[1]/3)+","+i[0]+","+i[1],s=n[1],u=2),t.length>1)for(r=t[1],i=n[u],u++,f+="C"+(s[0]+e[0])+","+(s[1]+e[1])+","+(i[0]-r[0])+","+(i[1]-r[1])+","+i[0]+","+i[1],o=2;o<t.length;o++,u++)i=n[u],r=t[o],f+="S"+(i[0]-r[0])+","+(i[1]-r[1])+","+i[0]+","+i[1];return c&&(h=n[u],f+="Q"+(i[0]+2*r[0]/3)+","+(i[1]+2*r[1]/3)+","+h[0]+","+h[1]),f}function yo(n,t){for(var r,u=[],f=(1-t)/2,e=n[0],i=n[1],o=1,s=n.length;++o<s;)r=e,e=i,i=n[o],u.push([f*(i[0]-r[0]),f*(i[1]-r[1])]);return u}function wa(n){if(n.length<3)return p(n);var o=1,s=n.length,t=n[0],i=t[0],r=t[1],u=[i,i,i,(t=n[1])[0]],f=[r,r,r,t[1]],e=[i,",",r,"L",w(ti,u),",",w(ti,f)];for(n.push(n[s-1]);++o<=s;)t=n[o],u.shift(),u.push(t[0]),f.shift(),f.push(t[1]),po(e,u,f);return n.pop(),e.push("L",t),e.join("")}function sk(n){if(n.length<4)return p(n);for(var t,f=[],i=-1,e=n.length,r=[0],u=[0];++i<3;)t=n[i],r.push(t[0]),u.push(t[1]);for(f.push(w(ti,r)+","+w(ti,u)),--i;++i<e;)t=n[i],r.shift(),r.push(t[0]),u.shift(),u.push(t[1]),po(f,r,u);return f.join("")}function hk(n){for(var f,t,i=-1,e=n.length,o=e+4,r=[],u=[];++i<4;)t=n[i%e],r.push(t[0]),u.push(t[1]);for(f=[w(ti,r),",",w(ti,u)],--i;++i<o;)t=n[i%e],r.shift(),r.push(t[0]),u.shift(),u.push(t[1]),po(f,r,u);return f.join("")}function ck(n,t){var i=n.length-1;if(i)for(var r,u,e=n[0][0],o=n[0][1],s=n[i][0]-e,h=n[i][1]-o,f=-1;++f<=i;)r=n[f],u=f/i,r[0]=t*r[0]+(1-t)*(e+u*s),r[1]=t*r[1]+(1-t)*(o+u*h);return wa(n)}function w(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function po(n,t,i){n.push("C",w(hp,t),",",w(hp,i),",",w(cp,t),",",w(cp,i),",",w(ti,t),",",w(ti,i))}function wo(n,t){return(t[1]-n[1])/(t[0]-n[0])}function lk(n){for(var t=0,e=n.length-1,i=[],f=n[0],r=n[1],u=i[0]=wo(f,r);++t<e;)i[t]=(u+(u=wo(f=r,r=n[t+1])))/2;return i[t]=u,i}function ak(n){for(var u,f,e,i,s=[],r=lk(n),t=-1,o=n.length-1;++t<o;)u=wo(n[t],n[t+1]),Math.abs(u)<1e-6?r[t]=r[t+1]=0:(f=r[t]/u,e=r[t+1]/u,i=f*f+e*e,i>9&&(i=3*u/Math.sqrt(i),r[t]=i*f,r[t+1]=i*e));for(t=-1;++t<=o;)i=(n[Math.min(o,t+1)][0]-n[Math.max(0,t-1)][0])/(6*(1+r[t]*r[t])),s.push([i||0,r[t]*i||0]);return s}function vk(n){return n.length<3?p(n):n[0]+fu(n,ak(n))}function yk(n,t,i,r){var u,f,e,o,s,h,c;return u=r[n],f=u[0],e=u[1],u=r[t],o=u[0],s=u[1],u=r[i],h=u[0],c=u[1],(c-e)*(o-f)-(s-e)*(h-f)>0}function bo(n,t,i){return(i[0]-t[0])*(n[1]-t[1])<(i[1]-t[1])*(n[0]-t[0])}function ba(n,t,i,r){var u=n[0],e=i[0],o=t[0]-u,s=r[0]-e,f=n[1],h=i[1],c=t[1]-f,l=r[1]-h,a=(s*(f-h)-l*(u-e))/(l*o-s*c);return[u+a*o,f+a*c]}function ka(n){var t=n[0],i=n[n.length-1];return!(t[0]-i[0]||t[1]-i[1])}function ko(n,t){var l={list:n.map(function(n,t){return{index:t,x:n[0],y:n[1]}}).sort(function(n,t){return n.y<t.y?-1:n.y>t.y?1:n.x<t.x?-1:n.x>t.x?1:0}),bottomSite:null},i={list:[],leftEnd:null,rightEnd:null,init:function(){i.leftEnd=i.createHalfEdge(null,"l"),i.rightEnd=i.createHalfEdge(null,"l"),i.leftEnd.r=i.rightEnd,i.rightEnd.l=i.leftEnd,i.list.unshift(i.leftEnd,i.rightEnd)},createHalfEdge:function(n,t){return{edge:n,side:t,vertex:null,l:null,r:null}},insert:function(n,t){t.l=n,t.r=n.r,n.r.l=t,n.r=t},leftBound:function(n){var t=i.leftEnd;do t=t.r;while(t!=i.rightEnd&&e.rightOf(t,n));return t=t.l},del:function(n){n.l.r=n.r,n.r.l=n.l,n.edge=null},right:function(n){return n.r},left:function(n){return n.l},leftRegion:function(n){return null==n.edge?l.bottomSite:n.edge.region[n.side]},rightRegion:function(n){return null==n.edge?l.bottomSite:n.edge.region[wf[n.side]]}},e={bisect:function(n,t){var u={region:{l:n,r:t},ep:{l:null,r:null}},i=t.x-n.x,r=t.y-n.y,f=i>0?i:-i,e=r>0?r:-r;return u.c=n.x*i+n.y*r+.5*(i*i+r*r),f>e?(u.a=1,u.b=r/i,u.c/=i):(u.b=1,u.a=i/r,u.c/=r),u},intersect:function(n,t){var i=n.edge,r=t.edge,u,h;if(!i||!r||i.region.r==r.region.r||(u=i.a*r.b-i.b*r.a,Math.abs(u)<1e-10))return null;var f,e,c=(i.c*r.b-r.c*i.b)/u,l=(r.c*i.a-i.c*r.a)/u,o=i.region.r,s=r.region.r;return o.y<s.y||o.y==s.y&&o.x<s.x?(f=n,e=i):(f=t,e=r),h=c>=e.region.r.x,h&&"l"===f.side||!h&&"r"===f.side?null:{x:c,y:l}},rightOf:function(n,t){var i=n.edge,u=i.region.r,f=t.x>u.x,h;if(f&&"l"===n.side)return 1;if(!f&&"r"===n.side)return 0;if(1===i.a){var e=t.y-u.y,o=t.x-u.x,s=0,r=0;(!f&&i.b<0||f&&i.b>=0?r=s=e>=i.b*o:(r=t.x+t.y*i.b>i.c,i.b<0&&(r=!r),r||(s=1)),s)||(h=u.x-i.region.l.x,r=i.b*(o*o-e*e)<h*e*(1+2*o/h+i.b*i.b),i.b<0&&(r=!r))}else{var c=i.c-i.a*t.x,l=t.y-c,a=t.x-u.x,v=c-u.y;r=l*l>a*a+v*v}return"l"===n.side?r:!r},endPoint:function(n,i,r){n.ep[i]=r,n.ep[wf[i]]&&t(n)},distance:function(n,t){var i=n.x-t.x,r=n.y-t.y;return Math.sqrt(i*i+r*r)}},u={list:[],insert:function(n,t,i){var f;n.vertex=t,n.ystar=t.y+i;for(var r=0,e=u.list,o=e.length;o>r;r++)if(f=e[r],!(n.ystar>f.ystar||n.ystar==f.ystar&&t.x>f.vertex.x))break;e.splice(r,0,n)},del:function(n){for(var t=0,i=u.list,r=i.length;r>t&&i[t]!=n;++t);i.splice(t,1)},empty:function(){return 0===u.list.length},nextEvent:function(n){for(var t=0,i=u.list,r=i.length;r>t;++t)if(i[t]==n)return i[t+1];return null},min:function(){var n=u.list[0];return{x:n.vertex.x,y:n.ystar}},extractMin:function(){return u.list.shift()}},p,r,h,v,k,o,c,y,d,f,w,a,b,s;for(i.init(),l.bottomSite=l.list.shift(),s=l.list.shift();;)if(u.empty()||(p=u.min()),s&&(u.empty()||s.y<p.y||s.y==p.y&&s.x<p.x))r=i.leftBound(s),h=i.right(r),c=i.rightRegion(r),a=e.bisect(c,s),o=i.createHalfEdge(a,"l"),i.insert(r,o),f=e.intersect(r,o),f&&(u.del(r),u.insert(r,f,e.distance(f,s))),r=o,o=i.createHalfEdge(a,"r"),i.insert(r,o),f=e.intersect(o,h),f&&u.insert(o,f,e.distance(f,s)),s=l.list.shift();else{if(u.empty())break;r=u.extractMin(),v=i.left(r),h=i.right(r),k=i.right(h),c=i.leftRegion(r),y=i.rightRegion(h),w=r.vertex,e.endPoint(r.edge,r.side,w),e.endPoint(h.edge,h.side,w),i.del(r),u.del(h),i.del(h),b="l",c.y>y.y&&(d=c,c=y,y=d,b="r"),a=e.bisect(c,y),o=i.createHalfEdge(a,b),i.insert(v,o),e.endPoint(a,wf[b],w),f=e.intersect(v,o),f&&(u.del(v),u.insert(v,f,e.distance(f,c))),f=e.intersect(o,k),f&&u.insert(o,f,e.distance(f,c))}for(r=i.right(i.leftEnd);r!=i.rightEnd;r=i.right(r))t(r.edge)}function pk(n){return n.x}function wk(n){return n.y}function da(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function ur(n,t,i,r,u,f){if(!n(t,i,r,u,f)){var o=.5*(i+u),s=.5*(r+f),e=t.nodes;e[0]&&ur(n,e[0],i,r,o,s),e[1]&&ur(n,e[1],o,r,u,s),e[2]&&ur(n,e[2],i,s,o,f),e[3]&&ur(n,e[3],o,s,u,f)}}function go(t,i){t=n.rgb(t),i=n.rgb(i);var r=t.r,u=t.g,f=t.b,e=i.r-r,o=i.g-u,s=i.b-f;return function(n){return"#"+bi(Math.round(r+e*n))+bi(Math.round(u+o*n))+bi(Math.round(f+s*n))}}function ga(n,t){var i,u={},r={};for(i in n)i in t?u[i]=ei(n[i],t[i]):r[i]=n[i];for(i in t)i in n||(r[i]=t[i]);return function(n){for(i in u)r[i]=u[i](n);return r}}function et(n,t){return t-=n=+n,function(i){return n+t*i}}function nv(n,t){var s,u,f,o,i,h=0,c=0,r=[],e=[];for(n+="",t+="",ar.lastIndex=0,u=0;s=ar.exec(t);++u)s.index&&r.push(t.substring(h,c=s.index)),e.push({i:r.length,x:s[0]}),r.push(null),h=ar.lastIndex;for(h<t.length&&r.push(t.substring(h)),u=0,o=e.length;(s=ar.exec(n))&&o>u;++u)if(i=e[u],i.x==s[0]){if(i.i)if(null==r[i.i+1])for(r[i.i-1]+=i.x,r.splice(i.i,1),f=u+1;o>f;++f)e[f].i--;else for(r[i.i-1]+=i.x+r[i.i+1],r.splice(i.i,2),f=u+1;o>f;++f)e[f].i-=2;else if(null==r[i.i+1])r[i.i]=i.x;else for(r[i.i]=i.x+r[i.i+1],r.splice(i.i+1,1),f=u+1;o>f;++f)e[f].i--;e.splice(u,1),o--,u--}else i.x=et(parseFloat(s[0]),parseFloat(i.x));for(;o>u;)i=e.pop(),null==r[i.i+1]?r[i.i]=i.x:(r[i.i]=i.x+r[i.i+1],r.splice(i.i+1,1)),o--;return 1===r.length?null==r[0]?(i=e[0].x,function(n){return i(n)+""}):function(){return t}:function(n){for(u=0;o>u;++u)r[(i=e[u]).i]=i.x(n);return r.join("")}}function ei(t,i){for(var r,u=n.interpolators.length;--u>=0&&!(r=n.interpolators[u](t,i)););return r}function tv(n,t){for(var u=[],r=[],e=n.length,o=t.length,f=Math.min(n.length,t.length),i=0;f>i;++i)u.push(ei(n[i],t[i]));for(;e>i;++i)r[i]=n[i];for(;o>i;++i)r[i]=t[i];return function(n){for(i=0;f>i;++i)r[i]=u[i](n);return r}}function bk(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function iv(n){return function(t){return 1-n(1-t)}}function rv(n){return function(t){return.5*(.5>t?n(2*t):2-n(2-2*t))}}function kk(n){return n*n}function dk(n){return n*n*n}function gk(n){if(0>=n)return 0;if(n>=1)return 1;var t=n*n,i=t*n;return 4*(.5>n?i:3*(n-t)+i-.75)}function nd(n){return function(t){return Math.pow(t,n)}}function td(n){return 1-Math.cos(n*t/2)}function id(n){return Math.pow(2,10*(n-1))}function rd(n){return 1-Math.sqrt(1-n*n)}function ud(n,i){var r;return arguments.length<2&&(i=.45),arguments.length?r=i/(2*t)*Math.asin(1/n):(n=1,r=i/4),function(u){return 1+n*Math.pow(2,10*-u)*Math.sin(2*(u-r)*t/i)}}function fd(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function ed(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function od(t,i){t=n.hcl(t),i=n.hcl(i);var u=t.h,f=t.c,o=t.l,r=i.h-u,e=i.c-f,s=i.l-o;return isNaN(e)&&(e=0,f=isNaN(f)?i.c:f),isNaN(r)?(r=0,u=isNaN(u)?i.h:u):r>180?r-=360:-180>r&&(r+=360),function(n){return le(u+r*n,f+e*n,o+s*n)+""}}function sd(t,i){t=n.hsl(t),i=n.hsl(i);var u=t.h,f=t.s,o=t.l,r=i.h-u,e=i.s-f,s=i.l-o;return isNaN(e)&&(e=0,f=isNaN(f)?i.s:f),isNaN(r)?(r=0,u=isNaN(u)?i.h:u):r>180?r-=360:-180>r&&(r+=360),function(n){return ce(u+r*n,f+e*n,o+s*n)+""}}function hd(t,i){t=n.lab(t),i=n.lab(i);var r=t.l,u=t.a,f=t.b,e=i.l-r,o=i.a-u,s=i.b-f;return function(n){return rl(r+e*n,u+o*n,f+s*n)+""}}function uv(n,t){return t-=n,function(i){return Math.round(n+t*i)}}function fv(n){var t=[n.a,n.b],i=[n.c,n.d],r=ov(t),u=ev(t,i),f=ov(cd(i,t,-u))||0;t[0]*i[1]<i[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,u*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-i[0],i[1]))*e,this.translate=[n.e,n.f],this.scale=[r,f],this.skew=f?Math.atan2(u,f)*e:0}function ev(n,t){return n[0]*t[0]+n[1]*t[1]}function ov(n){var t=Math.sqrt(ev(n,n));return t&&(n[0]/=t,n[1]/=t),t}function cd(n,t,i){return n[0]+=i*t[0],n[1]+=i*t[1],n}function sv(t,i){var s,r=[],o=[],c=n.transform(t),l=n.transform(i),a=c.translate,u=l.translate,h=c.rotate,f=l.rotate,p=c.skew,v=l.skew,y=c.scale,e=l.scale;return a[0]!=u[0]||a[1]!=u[1]?(r.push("translate(",null,",",null,")"),o.push({i:1,x:et(a[0],u[0])},{i:3,x:et(a[1],u[1])})):u[0]||u[1]?r.push("translate("+u+")"):r.push(""),h!=f?(h-f>180?f+=360:f-h>180&&(h+=360),o.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:et(h,f)})):f&&r.push(r.pop()+"rotate("+f+")"),p!=v?o.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:et(p,v)}):v&&r.push(r.pop()+"skewX("+v+")"),y[0]!=e[0]||y[1]!=e[1]?(s=r.push(r.pop()+"scale(",null,",",null,")"),o.push({i:s-4,x:et(y[0],e[0])},{i:s-2,x:et(y[1],e[1])})):(1!=e[0]||1!=e[1])&&r.push(r.pop()+"scale("+e+")"),s=o.length,function(n){for(var t,i=-1;++i<s;)r[(t=o[i]).i]=t.x(n);return r.join("")}}function ld(n,t){return t=t-(n=+n)?1/(t-n):0,function(i){return(i-n)*t}}function ad(n,t){return t=t-(n=+n)?1/(t-n):0,function(i){return Math.max(0,Math.min(1,(i-n)*t))}}function vd(n){for(var f,t=n.source,i=n.target,u=yd(t,i),r=[t];t!==u;)t=t.parent,r.push(t);for(f=r.length;i!==u;)r.splice(f,0,i),i=i.parent;return r}function hv(n){for(var i=[],t=n.parent;null!=t;)i.push(n),n=t,t=t.parent;return i.push(n),i}function yd(n,t){if(n===t)return n;for(var r=hv(n),u=hv(t),i=r.pop(),f=u.pop(),e=null;i===f;)e=i,i=r.pop(),f=u.pop();return e}function pd(n){n.fixed|=2}function wd(n){n.fixed&=-7}function bd(n){n.fixed|=4,n.px=n.x,n.py=n.y}function kd(n){n.fixed&=-5}function cv(n,t,i){var f=0,e=0,u;if(n.charge=0,!n.leaf)for(var r,o=n.nodes,h=o.length,s=-1;++s<h;)r=o[s],null!=r&&(cv(r,t,i),n.charge+=r.charge,f+=r.charge*r.cx,e+=r.charge*r.cy);n.point&&(n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5),u=t*i[n.point.index],n.charge+=n.pointCharge=u,f+=u*n.point.x,e+=u*n.point.y),n.cx=f/n.charge,n.cy=e/n.charge}function fr(t,i){return n.rebind(t,i,"sort","children","value"),t.nodes=t,t.links=tg,t}function dd(n){return n.children}function gd(n){return n.value}function ng(n,t){return t.value-n.value}function tg(t){return n.merge(t.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function ig(n){return n.x}function rg(n){return n.y}function ug(n,t,i){n.y0=t,n.y=i}function ns(t){return n.range(t.length)}function ts(n){for(var t=-1,r=n[0].length,i=[];++t<r;)i[t]=0;return i}function fg(n){for(var i,t=1,r=0,u=n[0][1],f=n.length;f>t;++t)(i=n[t][1])>u&&(r=t,u=i);return r}function eg(n){return n.reduce(og,0)}function og(n,t){return n+t[1]}function sg(n,t){return lv(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function lv(n,t){for(var i=-1,r=+n[0],f=(n[1]-r)/t,u=[];++i<=t;)u[i]=f*i+r;return u}function hg(t){return[n.min(t),n.max(t)]}function av(n,t){return n.parent==t.parent?1:2}function is(n){var t=n.children;return t&&t.length?t[0]:n._tree.thread}function rs(n){var i,t=n.children;return t&&(i=t.length)?t[i-1]:n._tree.thread}function eu(n,t){var i=n.children,u,f,r;if(i&&(f=i.length))for(r=-1;++r<f;)t(u=eu(i[r],t),n)>0&&(n=u);return n}function cg(n,t){return n.x-t.x}function lg(n,t){return t.x-n.x}function ag(n,t){return n.depth-t.depth}function ot(n,t){function i(n,r){var u=n.children,f,s,e,o;if(u&&(s=u.length))for(e=null,o=-1;++o<s;)f=u[o],i(f,e),e=f;t(n,r)}i(n,null)}function vg(n){for(var t,i=0,f=0,r=n.children,u=r.length;--u>=0;)t=r[u]._tree,t.prelim+=i,t.mod+=i,i+=t.shift+(f+=t.change)}function yg(n,t,i){n=n._tree,t=t._tree;var r=i/(t.number-n.number);n.change+=r,t.change-=r,t.shift+=i,t.prelim+=i,t.mod+=i}function pg(n,t,i){return n._tree.ancestor.parent==t.parent?n._tree.ancestor:i}function wg(n,t){return n.value-t.value}function us(n,t){var i=n._pack_next;n._pack_next=t,t._pack_prev=n,t._pack_next=i,i._pack_prev=t}function vv(n,t){n._pack_next=t,t._pack_prev=n}function yv(n,t){var i=t.x-n.x,r=t.y-n.y,u=n.r+t.r;return.999*u*u>i*i+r*r}function pv(n){function h(n){c=Math.min(n.x-n.r,c),l=Math.max(n.x+n.r,l),a=Math.min(n.y-n.r,a),v=Math.max(n.y+n.r,v)}if((u=n.children)&&(s=u.length)){var u,i,r,t,f,e,o,s,c=1/0,l=-1/0,a=1/0,v=-1/0;if(u.forEach(bg),i=u[0],i.x=-i.r,i.y=0,h(i),s>1&&(r=u[1],r.x=r.r,r.y=0,h(r),s>2))for(t=u[2],bv(i,r,t),h(t),us(i,t),i._pack_prev=t,us(t,r),r=i._pack_next,f=3;s>f;f++){bv(i,r,t=u[f]);var y=0,p=1,w=1;for(e=r._pack_next;e!==r;e=e._pack_next,p++)if(yv(e,t)){y=1;break}if(1==y)for(o=i._pack_prev;o!==e._pack_prev&&!yv(o,t);o=o._pack_prev,w++);y?(w>p||p==w&&r.r<i.r?vv(i,r=e):vv(i=o,r),f--):(us(i,t),r=t,h(t))}var k=(c+l)/2,d=(a+v)/2,b=0;for(f=0;s>f;f++)t=u[f],t.x-=k,t.y-=d,b=Math.max(b,t.r+Math.sqrt(t.x*t.x+t.y*t.y));n.r=b,u.forEach(kg)}}function bg(n){n._pack_next=n._pack_prev=n}function kg(n){delete n._pack_next,delete n._pack_prev}function wv(n,t,i,r){var u=n.children,f,e;if(n.x=t+=r*n.x,n.y=i+=r*n.y,n.r*=r,u)for(f=-1,e=u.length;++f<e;)wv(u[f],t,i,r)}function bv(n,t,i){var r=n.r+i.r,f=t.x-n.x,e=t.y-n.y,u,o,s,h;r&&(f||e)?(u=t.r+i.r,o=f*f+e*e,u*=u,r*=r,s=.5+(r-u)/(2*o),h=Math.sqrt(Math.max(0,2*u*(r+o)-(r-=o)*r-u*u))/(2*o),i.x=n.x+s*f+h*e,i.y=n.y+s*e-h*f):(i.x=n.x+r,i.y=n.y)}function dg(t){return 1+n.max(t,function(n){return n.y})}function gg(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function kv(n){var t=n.children;return t&&t.length?kv(t[0]):n}function dv(n){var i,t=n.children;return t&&(i=t.length)?dv(t[i-1]):n}function fs(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function gv(n,t){var u=n.x+t[3],f=n.y+t[0],i=n.dx-t[1]-t[3],r=n.dy-t[0]-t[2];return 0>i&&(u+=i/2,i=0),0>r&&(f+=r/2,r=0),{x:u,y:f,dx:i,dy:r}}function oi(n){var t=n[0],i=n[n.length-1];return i>t?[t,i]:[i,t]}function ou(n){return n.rangeExtent?n.rangeExtent():oi(n.range())}function nn(n,t,i,r){var u=i(n[0],n[1]),f=r(t[0],t[1]);return function(n){return f(u(n))}}function es(n,t){var i,r=0,u=n.length-1,f=n[r],e=n[u];return f>e&&(i=r,r=u,u=i,i=f,f=e,e=i),n[r]=t.floor(f),n[u]=t.ceil(e),n}function tn(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:bp}function rn(t,i,r,u){var o=[],s=[],f=0,e=Math.min(t.length,i.length)-1;for(t[e]<t[0]&&(t=t.slice().reverse(),i=i.slice().reverse());++f<=e;)o.push(r(t[f-1],t[f])),s.push(u(i[f-1],i[f]));return function(i){var r=n.bisect(t,i,1,e)-1;return s[r](o[r](i))}}function ny(n,t,i,r){function f(){var f=Math.min(n.length,t.length)>2?rn:nn,s=r?ad:ld;return e=f(n,t,s,i),o=f(t,n,s,ei),u}function u(n){return e(n)}var e,o;return u.invert=function(n){return o(n)},u.domain=function(t){return arguments.length?(n=t.map(Number),f()):n},u.range=function(n){return arguments.length?(t=n,f()):t},u.rangeRound=function(n){return u.range(n).interpolate(uv)},u.clamp=function(n){return arguments.length?(r=n,f()):r},u.interpolate=function(n){return arguments.length?(i=n,f()):i},u.ticks=function(t){return hs(n,t)},u.tickFormat=function(t,i){return cs(n,t,i)},u.nice=function(t){return ty(n,t),f()},u.copy=function(){return ny(n,t,i,r)},f()}function os(t,i){return n.rebind(t,i,"range","rangeRound","interpolate","clamp")}function ty(n,t){return es(n,tn(t?ss(n,t)[2]:un(n)))}function un(n){var t=oi(n),i=t[1]-t[0];return Math.pow(10,Math.round(Math.log(i)/Math.LN10)-1)}function ss(n,t){var r=oi(n),f=r[1]-r[0],i=Math.pow(10,Math.floor(Math.log(f/t)/Math.LN10)),u=t/f*i;return.15>=u?i*=10:.35>=u?i*=5:.75>=u&&(i*=2),r[0]=Math.ceil(r[0]/i)*i,r[1]=Math.floor(r[1]/i)*i+.5*i,r[2]=i,r}function hs(t,i){return n.range.apply(n,ss(t,i))}function cs(t,i,r){var u=-Math.floor(Math.log(ss(t,i)[2])/Math.LN10+.01);return n.format(r?r.replace(ep,function(n,t,i,r,f,e,o,s,h,c){return[t,i,r,f,e,o,s,h||"."+(u-2*("%"===c)),c].join("")}):",."+u+"f")}function iy(t,i,r,u){function e(n){return(r?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(i)}function o(n){return r?Math.pow(i,n):-Math.pow(i,-n)}function f(n){return t(e(n))}return f.invert=function(n){return o(t.invert(n))},f.domain=function(n){return arguments.length?(r=n[0]>=0,t.domain((u=n.map(Number)).map(e)),f):u},f.base=function(n){return arguments.length?(i=+n,t.domain(u.map(e)),f):i},f.nice=function(){var n=es(u.map(e),r?Math:kp);return t.domain(n),u=n.map(o),f},f.ticks=function(){var h=oi(u),t=[],c=h[0],l=h[1],n=Math.floor(e(c)),s=Math.ceil(e(l)),a=i%1?2:i,f;if(isFinite(s-n)){if(r){for(;s>n;n++)for(f=1;a>f;f++)t.push(o(n)*f);t.push(o(n))}else for(t.push(o(n));n++<s;)for(f=a-1;f>0;f--)t.push(o(n)*f);for(n=0;t[n]<c;n++);for(s=t.length;t[s-1]>l;s--);t=t.slice(n,s)}return t},f.tickFormat=function(t,i){if(!arguments.length)return bh;arguments.length<2?i=bh:"function"!=typeof i&&(i=n.format(i));var u,s=Math.max(.1,t/f.ticks().length),h=r?(u=1e-12,Math.ceil):(u=-1e-12,Math.floor);return function(n){return n/o(h(e(n)+u))<=s?i(n):""}},f.copy=function(){return iy(t.copy(),i,r,u)},os(f,t)}function ry(n,t,i){function r(t){return n(u(t))}var u=su(t),f=su(1/t);return r.invert=function(t){return f(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((i=t.map(Number)).map(u)),r):i},r.ticks=function(n){return hs(i,n)},r.tickFormat=function(n,t){return cs(i,n,t)},r.nice=function(n){return r.domain(ty(i,n))},r.exponent=function(e){return arguments.length?(u=su(t=e),f=su(1/t),n.domain(i.map(u)),r):t},r.copy=function(){return ry(n.copy(),t,i)},os(r,n)}function su(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function uy(t,i){function r(n){return u[((f.get(n)||f.set(n,t.push(n)))-1)%u.length]}function o(i,r){return n.range(t.length).map(function(n){return i+r*n})}var f,u,e;return r.domain=function(n){if(!arguments.length)return t;t=[],f=new g;for(var u,e=-1,o=n.length;++e<o;)f.has(u=n[e])||f.set(u,t.push(u));return r[i.t].apply(r,i.a)},r.range=function(n){return arguments.length?(u=n,e=0,i={t:"range",a:arguments},r):u},r.rangePoints=function(n,f){arguments.length<2&&(f=0);var s=n[0],h=n[1],c=(h-s)/(Math.max(1,t.length-1)+f);return u=o(t.length<2?(s+h)/2:s+c*f/2,c),e=0,i={t:"rangePoints",a:arguments},r},r.rangeBands=function(n,f,s){arguments.length<2&&(f=0),arguments.length<3&&(s=f);var h=n[1]<n[0],l=n[+h],a=n[1-h],c=(a-l)/(t.length-f+2*s);return u=o(l+c*s,c),h&&u.reverse(),e=c*(1-f),i={t:"rangeBands",a:arguments},r},r.rangeRoundBands=function(n,f,s){arguments.length<2&&(f=0),arguments.length<3&&(s=f);var h=n[1]<n[0],c=n[+h],a=n[1-h],l=Math.floor((a-c)/(t.length-f+2*s)),v=a-c-(t.length-f)*l;return u=o(c+Math.round(v/2),l),h&&u.reverse(),e=Math.round(l*(1-f)),i={t:"rangeRoundBands",a:arguments},r},r.rangeBand=function(){return e},r.rangeExtent=function(){return oi(i.a[0])},r.copy=function(){return uy(t,i)},r.domain(t)}function fy(t,i){function f(){var f=0,e=i.length;for(r=[];++f<e;)r[f-1]=n.quantile(t,f/e);return u}function u(t){if(!isNaN(t=+t))return i[n.bisect(r,t)]}var r;return u.domain=function(i){return arguments.length?(t=i.filter(function(n){return!isNaN(n)}).sort(n.ascending),f()):t},u.range=function(n){return arguments.length?(i=n,f()):i},u.quantiles=function(){return r},u.invertExtent=function(n){return n=i.indexOf(n),0>n?[NaN,NaN]:[n>0?r[n-1]:t[0],n<r.length?r[n]:t[t.length-1]]},u.copy=function(){return fy(t,i)},f()}function ey(n,t,i){function r(t){return i[Math.max(0,Math.min(e,Math.floor(u*(t-n))))]}function f(){return u=i.length/(t-n),e=i.length-1,r}var u,e;return r.domain=function(i){return arguments.length?(n=+i[0],t=+i[i.length-1],f()):[n,t]},r.range=function(n){return arguments.length?(i=n,f()):i},r.invertExtent=function(t){return t=i.indexOf(t),t=0>t?NaN:t/u+n,[t,t+1/u]},r.copy=function(){return ey(n,t,i)},f()}function oy(t,i){function r(r){if(r>=r)return i[n.bisect(t,r)]}return r.domain=function(n){return arguments.length?(t=n,r):t},r.range=function(n){return arguments.length?(i=n,r):i},r.invertExtent=function(n){return n=i.indexOf(n),[t[n-1],t[n]]},r.copy=function(){return oy(t,i)},r}function sy(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(i){return arguments.length?(n=i.map(t),t):n},t.ticks=function(t){return hs(n,t)},t.tickFormat=function(t,i){return cs(n,t,i)},t.copy=function(){return sy(n)},t}function fn(n){return n.innerRadius}function en(n){return n.outerRadius}function hy(n){return n.startAngle}function cy(n){return n.endAngle}function ly(n){for(var t,i,r,u=-1,f=n.length;++u<f;)t=n[u],i=t[0],r=t[1]+ii,t[0]=i*Math.cos(r),t[1]=i*Math.sin(r);return n}function ay(n){function t(t){function b(){p.push("M",i(n(w),s),a,l(n(y.reverse()),s),"Z")}for(var v,k,d,p=[],y=[],w=[],c=-1,g=t.length,nt=f(e),tt=f(o),it=e===r?function(){return k}:f(r),rt=o===u?function(){return d}:f(u);++c<g;)h.call(this,v=t[c],c)?(y.push([k=+nt.call(this,v,c),d=+tt.call(this,v,c)]),w.push([+it.call(this,v,c),+rt.call(this,v,c)])):y.length&&(b(),y=[],w=[]);return y.length&&b(),p.length?p.join(""):null}var e=nt,r=nt,o=0,u=ft,h=tr,i=p,c=i.key,l=i,a="L",s=.7;return t.x=function(n){return arguments.length?(e=r=n,t):r},t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(o=u=n,t):u},t.y0=function(n){return arguments.length?(o=n,t):o},t.y1=function(n){return arguments.length?(u=n,t):u},t.defined=function(n){return arguments.length?(h=n,t):h},t.interpolate=function(n){return arguments.length?(c="function"==typeof n?i=n:(i=pf.get(n)||p).key,l=i.reverse||i,a=i.closed?"M":"L",t):c},t.tension=function(n){return arguments.length?(s=n,t):s},t}function on(n){return n.radius}function vy(n){return[n.x,n.y]}function sn(n){return function(){var t=n.apply(this,arguments),i=t[0],r=t[1]+ii;return[i*Math.cos(r),i*Math.sin(r)]}}function hn(){return 64}function cn(){return"circle"}function yy(n){var i=Math.sqrt(n/t);return"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z"}function er(n,t){return yu(n,h),n.id=t,n}function ls(n,t,i,r){var u=n.id;return yt(n,"function"==typeof i?function(n,f,e){n.__transition__[u].tween.set(t,r(i.call(n,n.__data__,f,e)))}:(i=r(i),function(n){n.__transition__[u].tween.set(t,i)}))}function ln(n){return null==n&&(n=""),function(){this.textContent=n}}function hu(t,i,r,u){var e=t.__transition__||(t.__transition__={active:0,count:0}),f=e[r],o;f||(o=u.time,f=e[r]={tween:new g,time:o,ease:u.ease,delay:u.delay,duration:u.duration},++e.count,n.timer(function(n){function l(n){return e.active>r?u():(e.active=r,f.event&&f.event.start.call(t,s,i),f.tween.forEach(function(n,r){(r=r.call(t,s,i))&&c.push(r)}),a(n)?1:(hl(a,0,o),void 0))}function a(n){if(e.active!==r)return u();for(var o=(n-h)/y,a=v(o),l=c.length;l>0;)c[--l].call(t,a);if(o>=1)return u(),f.event&&f.event.end.call(t,s,i),1}function u(){return--e.count?delete e[r]:delete t.__transition__,1}var s=t.__data__,v=f.ease,h=f.delay,y=f.duration,c=[];return n>=h?l(n):(hl(l,h,o),void 0)},0,o))}function py(n,t){n.attr("transform",function(n){return"translate("+t(n)+",0)"})}function wy(n,t){n.attr("transform",function(n){return"translate(0,"+t(n)+")"})}function an(n,t,i){if(u=[],i&&t.length>1){for(var u,r,f,o=oi(n.domain()),e=-1,h=t.length,s=(t[1]-t[0])/++i;++e<h;)for(r=i;--r>0;)(f=+t[e]-r*s)>=o[0]&&u.push(f);for(--e,r=0;++r<i&&(f=+t[e]+r*s)<o[1];)u.push(f)}return u}function si(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function hi(n,t,i){function e(t){var i=n(t),r=f(i,1);return r-t>t-i?i:r}function u(i){return t(i=n(new l(i-1)),1),i}function f(n,i){return t(n=new l(+n),i),n}function o(n,r,f){var e=u(n),o=[];if(f>1)for(;r>e;)i(e)%f||o.push(new Date(+e)),t(e,1);else for(;r>e;)o.push(new Date(+e)),t(e,1);return o}function s(n,t,i){try{l=si;var r=new si;return r._=n,o(r,t,i)}finally{l=Date}}n.floor=n,n.round=e,n.ceil=u,n.offset=f,n.range=o;var r=n.utc=cu(n);return r.floor=r,r.round=cu(e),r.ceil=cu(u),r.offset=cu(f),r.range=s,n}function cu(n){return function(t,i){try{l=si;var r=new si;return r._=t,n(r,i)._}finally{l=Date}}}function lu(n,t,i,r){for(var u,f,e=0,o=t.length,s=i.length;o>e;){if(r>=s)return-1;if(u=t.charCodeAt(e++),37===u){if(f=dit[t.charAt(e++)],!f||(r=f(n,i,r))<0)return-1}else if(u!=i.charCodeAt(r++))return-1}return r}function au(t){return new RegExp("^(?:"+t.map(n.requote).join("|")+")","i")}function vu(n){for(var i=new g,t=-1,r=n.length;++t<r;)i.set(n[t].toLowerCase(),t);return i}function v(n,t,i){var u=0>n?"-":"",r=(u?-n:n)+"",f=r.length;return u+(i>f?new Array(i-f+1).join(t)+r:r)}function vn(n,t,i){fw.lastIndex=0;var r=fw.exec(t.substring(i));return r?(n.w=pit.get(r[0].toLowerCase()),i+r[0].length):-1}function yn(n,t,i){uw.lastIndex=0;var r=uw.exec(t.substring(i));return r?(n.w=yit.get(r[0].toLowerCase()),i+r[0].length):-1}function pn(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i,i+1));return r?(n.w=+r[0],i+r[0].length):-1}function wn(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i));return r?(n.U=+r[0],i+r[0].length):-1}function bn(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i));return r?(n.W=+r[0],i+r[0].length):-1}function kn(n,t,i){ow.lastIndex=0;var r=ow.exec(t.substring(i));return r?(n.m=bit.get(r[0].toLowerCase()),i+r[0].length):-1}function dn(n,t,i){ew.lastIndex=0;var r=ew.exec(t.substring(i));return r?(n.m=wit.get(r[0].toLowerCase()),i+r[0].length):-1}function gn(n,t,i){return lu(n,gf.c.toString(),t,i)}function ntt(n,t,i){return lu(n,gf.x.toString(),t,i)}function ttt(n,t,i){return lu(n,gf.X.toString(),t,i)}function itt(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i,i+4));return r?(n.y=+r[0],i+r[0].length):-1}function rtt(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i,i+2));return r?(n.y=utt(+r[0]),i+r[0].length):-1}function utt(n){return n+(n>68?1900:2e3)}function ftt(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i,i+2));return r?(n.m=r[0]-1,i+r[0].length):-1}function by(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i,i+2));return r?(n.d=+r[0],i+r[0].length):-1}function ett(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i,i+3));return r?(n.j=+r[0],i+r[0].length):-1}function ky(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i,i+2));return r?(n.H=+r[0],i+r[0].length):-1}function ott(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i,i+2));return r?(n.M=+r[0],i+r[0].length):-1}function stt(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i,i+2));return r?(n.S=+r[0],i+r[0].length):-1}function htt(n,t,i){o.lastIndex=0;var r=o.exec(t.substring(i,i+3));return r?(n.L=+r[0],i+r[0].length):-1}function ctt(n,t,i){var r=git.get(t.substring(i,i+=2).toLowerCase());return null==r?-1:(n.p=r,i)}function ltt(n){var t=n.getTimezoneOffset(),i=t>0?"-":"+",r=~~(Math.abs(t)/60),u=Math.abs(t)%60;return i+v(r,"0",2)+v(u,"0",2)}function att(n,t,i){sw.lastIndex=0;var r=sw.exec(t.substring(i,i+1));return r?i+r[0].length:-1}function as(n){return n.toISOString()}function vs(t,i,r){function u(n){return t(n)}return u.invert=function(n){return ys(t.invert(n))},u.domain=function(n){return arguments.length?(t.domain(n),u):t.domain().map(ys)},u.nice=function(n){return u.domain(es(u.domain(),n))},u.ticks=function(r,f){var o=oi(u.domain());if("function"!=typeof r){var h=o[1]-o[0],s=h/r,e=n.bisect(ne,s);if(e==ne.length)return i.year(o,r);if(!e)return t.ticks(r).map(ys);s/ne[e-1]<ne[e]/s&&--e,r=i[e],f=r[1],r=r[0].range}return r(o[0],new Date(+o[1]+1),f)},u.tickFormat=function(){return r},u.copy=function(){return vs(t.copy(),i,r)},os(u,t)}function ys(n){return new Date(n)}function dy(n){return function(t){for(var r=n.length-1,i=n[r];!i[1](t);)i=n[--r];return i[0](t)}}function ps(n){var t=new Date(n,0,1);return t.setFullYear(n),t}function vtt(n){var t=n.getFullYear(),i=ps(t),r=ps(t+1);return t+(n-i)/(r-i)}function ws(n){var t=new Date(Date.UTC(n,0,1));return t.setUTCFullYear(n),t}function ytt(n){var t=n.getUTCFullYear(),i=ws(t),r=ws(t+1);return t+(n-i)/(r-i)}function ptt(n){return JSON.parse(n.responseText)}function wtt(n){var t=b.createRange();return t.selectNode(b.body),t.createContextualFragment(n.responseText)}var n={version:"3.2.8"},bs,st,ks,ds,ht,u,pu,tt,th,wu,bu,np,ku,du,ih,tp,gu,nf,or,sr,rf,uf,ff,ef,it,uh,op,hr,eh,oh,sf,bt,y,ch,ai,lh,ah,vh,yh,ph,pf,lr,wf,ar,ap,vp,yp,wh,pp,wp,bp,bh,kp,ii,dp,kh,dh,tw,iw,df,l,rw,rc;Date.now||(Date.now=function(){return+new Date});var b=document,wt=b.documentElement,c=window;try{b.createElement("div").style.setProperty("opacity",0,"")}catch(ort){var te=c.Element.prototype,ert=te.setAttribute,frt=te.setAttributeNS,lw=c.CSSStyleDeclaration.prototype,urt=lw.setProperty;te.setAttribute=function(n,t){ert.call(this,n,t+"")},te.setAttributeNS=function(n,t,i){frt.call(this,n,t,i+"")},lw.setProperty=function(n,t,i){urt.call(this,n,t+"",i)}}n.ascending=function(n,t){return t>n?-1:n>t?1:n>=t?0:NaN},n.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:NaN},n.min=function(n,t){var i,u,r=-1,f=n.length;if(1===arguments.length){for(;++r<f&&!(null!=(i=n[r])&&i>=i);)i=void 0;for(;++r<f;)null!=(u=n[r])&&i>u&&(i=u)}else{for(;++r<f&&!(null!=(i=t.call(n,n[r],r))&&i>=i);)i=void 0;for(;++r<f;)null!=(u=t.call(n,n[r],r))&&i>u&&(i=u)}return i},n.max=function(n,t){var i,u,r=-1,f=n.length;if(1===arguments.length){for(;++r<f&&!(null!=(i=n[r])&&i>=i);)i=void 0;for(;++r<f;)null!=(u=n[r])&&u>i&&(i=u)}else{for(;++r<f&&!(null!=(i=t.call(n,n[r],r))&&i>=i);)i=void 0;for(;++r<f;)null!=(u=t.call(n,n[r],r))&&u>i&&(i=u)}return i},n.extent=function(n,t){var i,r,f,u=-1,e=n.length;if(1===arguments.length){for(;++u<e&&!(null!=(i=f=n[u])&&i>=i);)i=f=void 0;for(;++u<e;)null!=(r=n[u])&&(i>r&&(i=r),r>f&&(f=r))}else{for(;++u<e&&!(null!=(i=f=t.call(n,n[u],u))&&i>=i);)i=void 0;for(;++u<e;)null!=(r=t.call(n,n[u],u))&&(i>r&&(i=r),r>f&&(f=r))}return[i,f]},n.sum=function(n,t){var r,u=0,f=n.length,i=-1;if(1===arguments.length)for(;++i<f;)isNaN(r=+n[i])||(u+=r);else for(;++i<f;)isNaN(r=+t.call(n,n[i],i))||(u+=r);return u},n.mean=function(n,t){var u,e=n.length,i=0,r=-1,f=0;if(1===arguments.length)for(;++r<e;)ie(u=n[r])&&(i+=(u-i)/++f);else for(;++r<e;)ie(u=t.call(n,n[r],r))&&(i+=(u-i)/++f);if(f)return i},n.quantile=function(n,t){var u=(n.length-1)*t+1,i=Math.floor(u),r=+n[i-1],f=u-i;return f?r+f*(n[i]-r):r},n.median=function(t,i){return arguments.length>1&&(t=t.map(i)),t=t.filter(ie),t.length?n.quantile(t.sort(n.ascending),.5):void 0},n.bisector=function(n){return{left:function(t,i,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var f=r+u>>>1;n.call(t,t[f],f)<i?r=f+1:u=f}return r},right:function(t,i,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var f=r+u>>>1;i<n.call(t,t[f],f)?u=f:r=f+1}return r}}},bs=n.bisector(function(n){return n}),n.bisectLeft=bs.left,n.bisect=n.bisectRight=bs.right,n.shuffle=function(n){for(var r,i,t=n.length;t;)i=0|Math.random()*t--,r=n[t],n[t]=n[i],n[i]=r;return n},n.permute=function(n,t){for(var i=t.length,r=new Array(i);i--;)r[i]=n[t[i]];return r},n.zip=function(){var r,t,e;if(!(r=arguments.length))return[];for(var i=-1,u=n.min(arguments,aw),f=new Array(u);++i<u;)for(t=-1,e=f[i]=new Array(r);++t<r;)e[t]=arguments[t][i];return f},n.transpose=function(t){return n.zip.apply(n,t)},n.keys=function(n){var t=[],i;for(i in n)t.push(i);return t},n.values=function(n){var t=[],i;for(i in n)t.push(n[i]);return t},n.entries=function(n){var i=[],t;for(t in n)i.push({key:t,value:n[t]});return i},n.merge=function(n){return Array.prototype.concat.apply([],n)},n.range=function(n,t,i){if(arguments.length<3&&(i=1,arguments.length<2&&(t=n,n=0)),1/0==(t-n)/i)throw new Error("infinite range");var u,f=[],r=vw(Math.abs(i)),e=-1;if(n*=r,t*=r,i*=r,0>i)for(;(u=n+i*++e)>t;)f.push(u/r);else for(;(u=n+i*++e)<t;)f.push(u/r);return f},n.map=function(n){var t=new g,i;if(n instanceof g)n.forEach(function(n,i){t.set(n,i)});else for(i in n)t.set(i,n[i]);return t},fc(g,{has:function(n){return st+n in this},get:function(n){return this[st+n]},set:function(n,t){return this[st+n]=t},remove:function(n){return n=st+n,n in this&&delete this[n]},keys:function(){var n=[];return this.forEach(function(t){n.push(t)}),n},values:function(){var n=[];return this.forEach(function(t,i){n.push(i)}),n},entries:function(){var n=[];return this.forEach(function(t,i){n.push({key:t,value:i})}),n},forEach:function(n){for(var t in this)t.charCodeAt(0)===ks&&n.call(this,t.substring(1),this[t])}}),st="\0",ks=st.charCodeAt(0),n.nest=function(){function r(n,e,o){if(o>=i.length)return f?f.call(t,e):u?e.sort(u):e;for(var l,s,h,a,v=-1,y=e.length,p=i[o++],c=new g;++v<y;)(a=c.get(l=p(s=e[v])))?a.push(s):c.set(l,[s]);return n?(s=n(),h=function(t,i){s.set(t,r(n,i,o))}):(s={},h=function(t,i){s[t]=r(n,i,o)}),c.forEach(h),s}function e(n,t){if(t>=i.length)return n;var r=[],u=o[t++];return n.forEach(function(n,i){r.push({key:n,values:e(i,t)})}),u?r.sort(function(n,t){return u(n.key,t.key)}):r}var u,f,t={},i=[],o=[];return t.map=function(n,t){return r(t,n,0)},t.entries=function(t){return e(r(n.map,t,0),0)},t.key=function(n){return i.push(n),t},t.sortKeys=function(n){return o[i.length-1]=n,t},t.sortValues=function(n){return u=n,t},t.rollup=function(n){return f=n,t},t},n.set=function(n){var i=new re,t,r;if(n)for(t=0,r=n.length;r>t;++t)i.add(n[t]);return i},fc(re,{has:function(n){return st+n in this},add:function(n){return this[st+n]=!0,n},remove:function(n){return n=st+n,n in this&&delete this[n]},values:function(){var n=[];return this.forEach(function(t){n.push(t)}),n},forEach:function(n){for(var t in this)t.charCodeAt(0)===ks&&n.call(this,t.substring(1))}}),n.behavior={},n.rebind=function(n,t){for(var i,r=1,u=arguments.length;++r<u;)n[i=arguments[r]]=yw(n,t,t[i]);return n},ds=["webkit","ms","moz","Moz","o","O"],ht=ww;try{ht(wt.childNodes)[0].nodeType}catch(srt){ht=pw}n.dispatch=function(){for(var n=new fe,t=-1,i=arguments.length;++t<i;)n[arguments[t]]=ec(n);return n},fe.prototype.on=function(n,t){var r=n.indexOf("."),i="";if(r>=0&&(i=n.substring(r+1),n=n.substring(0,r)),n)return arguments.length<2?this[n].on(i):this[n].on(i,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(i,null);return this}},n.event=null,n.requote=function(n){return n.replace(btt,"\\$&")};var btt=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,yu={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var i in t)n[i]=t[i]},gs=function(n,t){return t.querySelector(n)},nh=function(n,t){return t.querySelectorAll(n)},ktt=wt[ue(wt,"matchesSelector")],gy=function(n,t){return ktt.call(n,t)};"function"==typeof Sizzle&&(gs=function(n,t){return Sizzle(n,t)[0]||null},nh=function(n,t){return Sizzle.uniqueSort(Sizzle(n,t))},gy=Sizzle.matchesSelector),n.selection=function(){return th},u=n.selection.prototype=[],u.select=function(n){var i,f,e,t,o=[],r,s,u,h;for(n=oe(n),r=-1,s=this.length;++r<s;)for(o.push(i=[]),i.parentNode=(e=this[r]).parentNode,u=-1,h=e.length;++u<h;)(t=e[u])?(i.push(f=n.call(t,t.__data__,u,r)),f&&"__data__"in t&&(f.__data__=t.__data__)):i.push(null);return vt(o)},u.selectAll=function(n){var u,t,f=[],i,e;for(n=sc(n),i=-1,e=this.length;++i<e;)for(var o=this[i],r=-1,s=o.length;++r<s;)(t=o[r])&&(f.push(u=ht(n.call(t,t.__data__,r,i))),u.parentNode=t);return vt(f)},pu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},n.ns={prefix:pu,qualify:function(n){var t=n.indexOf(":"),i=n;return t>=0&&(i=n.substring(0,t),n=n.substring(t+1)),pu.hasOwnProperty(i)?{space:pu[i],local:n}:n}},u.attr=function(t,i){if(arguments.length<2){if("string"==typeof t){var r=this.node();return t=n.ns.qualify(t),t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}for(i in t)this.each(hc(i,t[i]));return this}return this.each(hc(t,i))},u.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var r=this.node(),u=(n=n.trim().split(/^|\s+/g)).length,i=-1;if(t=r.classList){for(;++i<u;)if(!t.contains(n[i]))return!1}else for(t=r.getAttribute("class");++i<u;)if(!lc(n[i]).test(t))return!1;return!0}for(t in n)this.each(ac(t,n[t]));return this}return this.each(ac(n,t))},u.style=function(n,t,i){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t="");for(i in n)this.each(vc(i,n[i],t));return this}if(2>r)return c.getComputedStyle(this.node(),null).getPropertyValue(n);i=""}return this.each(vc(n,t,i))},u.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(yc(t,n[t]));return this}return this.each(yc(n,t))},u.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},u.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},u.append=function(n){return n=pc(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},u.insert=function(n,t){return n=pc(n),t=oe(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments))})},u.remove=function(){return this.each(function(){var n=this.parentNode;n&&n.removeChild(this)})},u.data=function(n,t){function e(n,i){var r,u,o,l=n.length,a=i.length,k=Math.min(l,a),v=new Array(a),c=new Array(a),y=new Array(l);if(t){var e,p=new g,w=new g,b=[];for(r=-1;++r<l;)e=t.call(u=n[r],u.__data__,r),p.has(e)?y[r]=u:p.set(e,u),b.push(e);for(r=-1;++r<a;)e=t.call(i,o=i[r],r),(u=p.get(e))?(v[r]=u,u.__data__=o):w.has(e)||(c[r]=se(o)),w.set(e,o),p.remove(e);for(r=-1;++r<l;)p.has(b[r])&&(y[r]=n[r])}else{for(r=-1;++r<k;)u=n[r],o=i[r],u?(u.__data__=o,v[r]=u):c[r]=se(o);for(;a>r;++r)c[r]=se(i[r]);for(;l>r;++r)y[r]=n[r]}c.update=v,c.parentNode=v.parentNode=y.parentNode=n.parentNode,s.push(c),f.push(v),h.push(y)}var r,o,i=-1,u=this.length;if(!arguments.length){for(n=new Array(u=(r=this[0]).length);++i<u;)(o=r[i])&&(n[i]=o.__data__);return n}var s=bc([]),f=vt([]),h=vt([]);if("function"==typeof n)for(;++i<u;)e(r=this[i],n.call(r,r.parentNode.__data__,i));else for(;++i<u;)e(r=this[i],n);return f.enter=function(){return s},f.exit=function(){return h},f},u.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},u.filter=function(n){var u,f,i,e=[],r,o,t,s;for("function"!=typeof n&&(n=wc(n)),r=0,o=this.length;o>r;r++)for(e.push(u=[]),u.parentNode=(f=this[r]).parentNode,t=0,s=f.length;s>t;t++)(i=f[t])&&n.call(i,i.__data__,t)&&u.push(i);return vt(e)},u.order=function(){for(var i=-1,f=this.length;++i<f;)for(var t,r=this[i],u=r.length-1,n=r[u];--u>=0;)(t=r[u])&&(n&&n!==t.nextSibling&&n.parentNode.insertBefore(t,n),n=t);return this},u.sort=function(n){n=kw.apply(this,arguments);for(var t=-1,i=this.length;++t<i;)this[t].sort(n);return this.order()},u.each=function(n){return yt(this,function(t,i,r){n.call(t,t.__data__,i,r)})},u.call=function(n){var t=ht(arguments);return n.apply(t[0]=this,t),this},u.empty=function(){return!this.node()},u.node=function(){for(var i,n=0,r=this.length;r>n;n++)for(var u=this[n],t=0,f=u.length;f>t;t++)if(i=u[t],i)return i;return null},u.size=function(){var n=0;return this.each(function(){++n}),n},tt=[],n.selection.enter=bc,n.selection.enter.prototype=tt,tt.append=u.append,tt.empty=u.empty,tt.node=u.node,tt.call=u.call,tt.size=u.size,tt.select=function(n){for(var i,h,r,e,o,t,u,s=[],f=-1,c=this.length;++f<c;)for(o=(t=this[f]).update,s.push(r=[]),r.parentNode=t.parentNode,i=-1,h=t.length;++i<h;)(u=t[i])?(r.push(o[i]=e=n.call(t.parentNode,u.__data__,i,f)),e.__data__=u.__data__):r.push(null);return vt(s)},tt.insert=function(n,t){return arguments.length<2&&(t=dw(this)),u.insert.call(this,n,t)},u.transition=function(){for(var i,n,r=vr||++nw,u=[],o=bf||{time:Date.now(),ease:gk,delay:0,duration:250},f=-1,s=this.length;++f<s;){u.push(i=[]);for(var e=this[f],t=-1,h=e.length;++t<h;)(n=e[t])&&hu(n,t,r,o),i.push(n)}return er(u,r)},n.select=function(n){var t=["string"==typeof n?gs(n,b):n];return t.parentNode=wt,vt([t])},n.selectAll=function(n){var t=ht("string"==typeof n?nh(n,b):n);return t.parentNode=wt,vt([t])},th=n.select(wt),u.on=function(n,t,i){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(i in n)this.each(kc(i,n[i],t));return this}if(2>r)return(r=this.node()["__on"+n])&&r._;i=!1}return this.each(kc(n,t,i))},wu=n.map({mouseenter:"mouseover",mouseleave:"mouseout"}),wu.forEach(function(n){"on"+n in b&&wu.remove(n)}),bu=ue(wt.style,"userSelect"),np=0,n.mouse=function(n){return gc(n,oc())},ku=/WebKit/.test(c.navigator.userAgent)?-1:0,n.touches=function(n,t){return arguments.length<2&&(t=oc().touches),t?ht(t).map(function(t){var i=gc(n,t);return i.identifier=t.identifier,i}):[]},n.behavior.drag=function(){function t(){this.on("mousedown.drag",o).on("touchstart.drag",h)}function f(){return n.event.changedTouches[0].identifier}function e(t,i){return n.touches(t).filter(function(n){return n.identifier===i})[0]}function r(t,r,f,e){return function(){function b(){if(!v)return p();var n=r(v,h),t=n[0]-s[0],i=n[1]-s[1];w|=t|i,s=n,y({type:"drag",x:n[0]+o[0],y:n[1]+o[1],dx:t,dy:i})}function p(){d.on(f+"."+l,null).on(e+"."+l,null),g(w&&n.event.target===k),y({type:"dragend"})}var o,a=this,v=a.parentNode,y=u.of(a,arguments),k=n.event.target,h=t(),l=null==h?"drag":"drag-"+h,s=r(v,h),w=0,d=n.select(c).on(f+"."+l,b).on(e+"."+l,p),g=yr();i?(o=i.apply(a,arguments),o=[o.x-s[0],o.y-s[1]]):o=[0,0],y({type:"dragstart"})}}var u=ee(t,"drag","dragstart","dragend"),i=null,o=r(s,n.mouse,"mousemove","mouseup"),h=r(f,e,"touchmove","touchend");return t.origin=function(n){return arguments.length?(i=n,t):i},n.rebind(t,u,"on")},n.behavior.zoom=function(){function r(){this.on(k,nt).on(tp+".zoom",ot).on(d,it).on("dblclick.zoom",st).on(g,tt)}function o(n){return[(n[0]-i[0])/t,(n[1]-i[1])/t]}function et(n){return[n[0]*t+i[0],n[1]*t+i[1]]}function s(n){t=Math.max(v[0],Math.min(v[1],n))}function u(n,t){t=et(t),i[0]+=n[0]-t[0],i[1]+=n[1]-t[1]}function y(){l&&l.domain(w.range().map(function(n){return(n-i[0])/t}).map(w.invert)),a&&a.domain(b.range().map(function(n){return(n-i[1])/t}).map(b.invert))}function f(n){y(),n({type:"zoom",scale:t,translate:i})}function nt(){function r(){i=1,u(n.mouse(t),v),f(h)}function s(){a.on(d,c===t?it:null).on(rt,null),y(i&&n.event.target===l)}var t=this,h=e.of(t,arguments),l=n.event.target,i=0,a=n.select(c).on(d,r).on(rt,s),v=o(n.mouse(t)),y=yr()}function tt(){function l(){var u=n.touches(r);return v=t,i={},u.forEach(function(n){i[n.identifier]=o(n)}),u}function a(){var e=Date.now(),n=l(),r,o;if(1===n.length)500>e-p&&(r=n[0],o=i[r.identifier],s(2*t),u(r,o),at(),f(y)),p=e;else if(n.length>1){var r=n[0],c=n[1],a=r[0]-c[0],v=r[1]-c[1];h=a*a+v*v}}function w(){var w=n.touches(r),t=w[0],c=i[t.identifier],e,a,l,o;(e=w[1])&&(a=i[e.identifier],l=n.event.scale,null==l&&(o=(o=e[0]-t[0])*o+(o=e[1]-t[1])*o,l=h&&Math.sqrt(o/h)),t=[(t[0]+e[0])/2,(t[1]+e[1])/2],c=[(c[0]+a[0])/2,(c[1]+a[1])/2],s(l*v)),p=null,u(t,c),f(y)}function b(){n.event.touches.length?l():(d.on(ut,null).on(ft,null),it.on(k,nt).on(g,tt),rt())}var i,v,r=this,y=e.of(r,arguments),h=0,d=n.select(c).on(ut,w).on(ft,b),it=n.select(r).on(k,null).on(g,a),rt=yr();a()}function ot(){at(),h||(h=o(n.mouse(this))),s(Math.pow(2,.002*du())*t),u(n.mouse(this),h),f(e.of(this,arguments))}function it(){h=null}function st(){var i=n.mouse(this),h=o(i),r=Math.log(t)/Math.LN2;s(Math.pow(2,n.event.shiftKey?Math.ceil(r)-1:Math.floor(r)+1)),u(i,h),f(e.of(this,arguments))}var h,p,w,l,b,a,i=[0,0],t=1,v=ih,k="mousedown.zoom",d="mousemove.zoom",rt="mouseup.zoom",g="touchstart.zoom",ut="touchmove.zoom",ft="touchend.zoom",e=ee(r,"zoom");return r.translate=function(n){return arguments.length?(i=n.map(Number),y(),r):i},r.scale=function(n){return arguments.length?(t=+n,y(),r):t},r.scaleExtent=function(n){return arguments.length?(v=null==n?ih:n.map(Number),r):v},r.x=function(n){return arguments.length?(l=n,w=n.copy(),i=[0,0],t=1,r):l},r.y=function(n){return arguments.length?(a=n,b=n.copy(),i=[0,0],t=1,r):a},n.rebind(r,e,"on")},ih=[0,1/0],tp="onwheel"in b?(du=function(){return-n.event.deltaY*(n.event.deltaMode?120:1)},"wheel"):"onmousewheel"in b?(du=function(){return n.event.wheelDelta},"mousewheel"):(du=function(){return-n.event.detail},"MozMousePixelScroll"),vi.prototype.toString=function(){return this.rgb()+""},n.hsl=function(n,t,i){return 1===arguments.length?n instanceof he?yi(n.h,n.s,n.l):el(""+n,ol,yi):yi(+n,+t,+i)},gu=he.prototype=new vi,gu.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),yi(this.h,this.s,this.l/n)},gu.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),yi(this.h,this.s,n*this.l)},gu.rgb=function(){return ce(this.h,this.s,this.l)};var t=Math.PI,i=1e-6,ip=i*i,r=t/180,e=180/t;n.hcl=function(t,i,r){return 1===arguments.length?t instanceof pr?pi(t.h,t.c,t.l):t instanceof wr?ul(t.l,t.a,t.b):ul((t=sl((t=n.rgb(t)).r,t.g,t.b)).l,t.a,t.b):pi(+t,+i,+r)},nf=pr.prototype=new vi,nf.brighter=function(n){return pi(this.h,this.c,Math.min(100,this.l+tf*(arguments.length?n:1)))},nf.darker=function(n){return pi(this.h,this.c,Math.max(0,this.l-tf*(arguments.length?n:1)))},nf.rgb=function(){return le(this.h,this.c,this.l).rgb()},n.lab=function(t,i,r){return 1===arguments.length?t instanceof wr?wi(t.l,t.a,t.b):t instanceof pr?le(t.l,t.c,t.h):sl((t=n.rgb(t)).r,t.g,t.b):wi(+t,+i,+r)};var tf=18,rp=.95047,up=1,fp=1.08883,rh=wr.prototype=new vi;rh.brighter=function(n){return wi(Math.min(100,this.l+tf*(arguments.length?n:1)),this.a,this.b)},rh.darker=function(n){return wi(Math.max(0,this.l-tf*(arguments.length?n:1)),this.a,this.b)},rh.rgb=function(){return rl(this.l,this.a,this.b)},n.rgb=function(n,t,i){return 1===arguments.length?n instanceof pe?ut(n.r,n.g,n.b):el(""+n,ut,ce):ut(~~n,~~t,~~i)},or=pe.prototype=new vi,or.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var i=this.r,r=this.g,u=this.b,t=30;return i||r||u?(i&&t>i&&(i=t),r&&t>r&&(r=t),u&&t>u&&(u=t),ut(Math.min(255,~~(i/n)),Math.min(255,~~(r/n)),Math.min(255,~~(u/n)))):ut(t,t,t)},or.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),ut(~~(n*this.r),~~(n*this.g),~~(n*this.b))},or.hsl=function(){return ol(this.r,this.g,this.b)},or.toString=function(){return"#"+bi(this.r)+bi(this.g)+bi(this.b)},sr=n.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074}),sr.forEach(function(n,t){sr.set(n,fl(t))}),n.functor=f,n.xhr=ke(a),n.dsv=function(t,i){function r(t,r,u){arguments.length<3&&(u=r,r=null);var o=n.xhr(t,i,u);return o.row=function(n){return arguments.length?o.response(null==(r=n)?f:e(n)):r},o.row(r)}function f(n){return r.parse(n.responseText)}function e(n){return function(t){return r.parse(t.responseText,n)}}function o(n){return n.map(u).join(t)}function u(n){return s.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var s=new RegExp('["'+t+"\n]"),h=t.charCodeAt(0);return r.parse=function(n,t){var i;return r.parseRows(n,function(n,r){if(i)return i(n,r-1);var u=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");i=t?function(n,i){return t(u(n),i)}:u})},r.parseRows=function(n,t){function s(){var f,t,u,s;if(i>=o)return e;if(r)return r=!1,c;if(f=i,34===n.charCodeAt(f)){for(t=f;t++<o;)if(34===n.charCodeAt(t)){if(34!==n.charCodeAt(t+1))break;++t}return i=t+2,u=n.charCodeAt(t+1),13===u?(r=!0,10===n.charCodeAt(t+2)&&++i):10===u&&(r=!0),n.substring(f+1,t).replace(/""/g,'"')}for(;o>i;){if(u=n.charCodeAt(i++),s=1,10===u)r=!0;else if(13===u)r=!0,10===n.charCodeAt(i)&&(++i,++s);else if(u!==h)continue;return n.substring(f,i-s)}return n.substring(f)}for(var f,u,r,c={},e={},l=[],o=n.length,i=0,a=0;(u=s())!==e;){for(f=[];u!==c&&u!==e;)f.push(u),u=s();(!t||(f=t(f,a++)))&&l.push(f)}return l},r.format=function(n){if(Array.isArray(n[0]))return r.formatRows(n);var f=new re,i=[];return n.forEach(function(n){for(var t in n)f.has(t)||i.push(f.add(t))}),[i.map(u).join(t)].concat(n.map(function(n){return i.map(function(t){return u(n[t])}).join(t)})).join("\n")},r.formatRows=function(n){return n.map(o).join("\n")},r},n.csv=n.dsv(",","text/csv"),n.tsv=n.dsv("\t","text/tab-separated-values"),uh=c[ue(c,"requestAnimationFrame")]||function(n){setTimeout(n,17)},n.timer=function(n,t,i){var u=arguments.length,f,r;2>u&&(t=0),3>u&&(i=Date.now()),f=i+t,r={callback:n,time:f,next:null},uf?uf.next=r:rf=r,uf=r,ff||(ef=clearTimeout(ef),ff=1,uh(ge))},n.timer.flush=function(){cl(),ll()};var dtt=".",gtt=",",of=[3,3],nit="$",tit=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(rb);n.formatPrefix=function(t,i){var r=0;return t&&(0>t&&(t*=-1),i&&(t=n.round(t,no(t,i))),r=1+Math.floor(1e-12+Math.log(t)/Math.LN10),r=Math.max(-24,Math.min(24,3*Math.floor((0>=r?r+1:r-1)/3)))),tit[8+r/3]},n.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)},n.format=function(t){var u=ep.exec(t),v=u[1]||" ",e=u[2]||">",p=u[3]||"",f=u[4]||"",s=u[5],h=+u[6],c=u[7],r=u[8],i=u[9],o=1,l="",y=!1,a;switch(r&&(r=+r.substring(1)),(s||"0"===v&&"="===e)&&(s=v="0",e="=",c&&(h-=Math.floor((h-1)/4))),i){case"n":c=!0,i="g";break;case"%":o=100,l="%",i="f";break;case"p":o=100,l="%",i="r";break;case"b":case"o":case"x":case"X":"#"===f&&(f="0"+i.toLowerCase());case"c":case"d":y=!0,r=0;break;case"s":o=-1,i="r"}return"#"===f?f="":"$"===f&&(f=nit),"r"!=i||r||(i="g"),null!=r&&("g"==i?r=Math.max(1,Math.min(21,r)):("e"==i||"f"==i)&&(r=Math.max(0,Math.min(20,r)))),i=iit.get(i)||ub,a=s&&c,function(t){var u,g,k,w;if(y&&t%1)return"";u=0>t||0===t&&0>1/t?(t=-t,"-"):p,0>o?(g=n.formatPrefix(t,r),t=g.scale(t),l=g.symbol):t*=o,t=i(t,r);var d=t.lastIndexOf("."),b=0>d?t:t.substring(0,d),nt=0>d?"":dtt+t.substring(d+1);return!s&&c&&(b=fh(b)),k=f.length+b.length+nt.length+(a?0:u.length),w=h>k?new Array(k=h-k+1).join(v):"",a&&(b=fh(w+b)),u+=f,t=b+nt,("<"===e?u+t+w:">"===e?w+u+t:"^"===e?w.substring(0,k>>=1)+u+t+w.substring(k):u+(a?t:w+t))+l}};var ep=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,iit=n.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(t,i){return(t=n.round(t,no(t,i))).toFixed(Math.max(0,Math.min(20,no(t*(1+1e-15),i))))}}),fh=a;of&&(op=of.length,fh=function(n){for(var i=n.length,r=[],u=0,t=of[0];i>0&&t>0;)r.push(n.substring(i-=t,i+t)),t=of[u=(u+1)%op];return r.reverse().join(gtt)}),n.geo={},to.prototype={s:0,t:0,add:function(n){al(n,this.t,hr),al(hr.s,this.s,this),this.s?this.t+=hr.t:this.s=hr.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}},hr=new to,n.geo.stream=function(n,t){n&&eh.hasOwnProperty(n.type)?eh[n.type](n,t):kr(n,t)},eh={Feature:function(n,t){kr(n.geometry,t)},FeatureCollection:function(n,t){for(var i=n.features,r=-1,u=i.length;++r<u;)kr(i[r].geometry,t)}},oh={Sphere:function(n,t){t.sphere()},Point:function(n,t){var i=n.coordinates;t.point(i[0],i[1])},MultiPoint:function(n,t){for(var i,r=n.coordinates,u=-1,f=r.length;++u<f;)i=r[u],t.point(i[0],i[1])},LineString:function(n,t){io(n.coordinates,t,0)},MultiLineString:function(n,t){for(var i=n.coordinates,r=-1,u=i.length;++r<u;)io(i[r],t,0)},Polygon:function(n,t){vl(n.coordinates,t)},MultiPolygon:function(n,t){for(var i=n.coordinates,r=-1,u=i.length;++r<u;)vl(i[r],t)},GeometryCollection:function(n,t){for(var i=n.geometries,r=-1,u=i.length;++r<u;)kr(i[r],t)}},n.geo.area=function(t){return sf=0,n.geo.stream(t,y),sf},bt=new to,y={sphere:function(){sf+=4*t},point:s,lineStart:s,lineEnd:s,polygonStart:function(){bt.reset(),y.lineStart=fb},polygonEnd:function(){var n=2*bt;sf+=0>n?4*t+n:n,y.lineStart=y.lineEnd=y.point=s}},n.geo.bounds=function(){function w(n,i){a.push(c=[t=n,u=n]),o>i&&(o=i),i>s&&(s=i)}function b(n,i){var k=ui([n*r,i*r]),a;if(v){var p=ki(v,k),g=[p[1],-p[0],0],h=ki(g,p);nu(h),h=tu(h);var d=n-l,y=d>0?1:-1,c=h[0]*e*y,b=Math.abs(d)>180;b^(c>y*l&&y*n>c)?(a=h[1]*e,a>s&&(s=a)):(c=(c+360)%360-180,b^(c>y*l&&y*n>c))?(a=-h[1]*e,o>a&&(o=a)):(o>i&&(o=i),i>s&&(s=i)),b?l>n?f(t,n)>f(t,u)&&(u=n):f(n,u)>f(t,u)&&(t=n):u>=t?(t>n&&(t=n),n>u&&(u=n)):n>l?f(t,n)>f(t,u)&&(u=n):f(n,u)>f(t,u)&&(t=n)}else w(n,i);v=k,l=n}function k(){h.point=b}function d(){c[0]=t,c[1]=u,h.point=w,v=null}function g(n,t){if(v){var i=n-l;p+=Math.abs(i)>180?i+(i>0?360:-360):i}else tt=n,it=t;y.point(n,t),b(n,t)}function rt(){y.lineStart()}function ut(){g(tt,it),y.lineEnd(),Math.abs(p)>i&&(t=-(u=180)),c[0]=t,c[1]=u,v=null}function f(n,t){return(t-=n)<0?t+360:t}function ft(n,t){return n[0]-t[0]}function nt(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var t,o,u,s,l,tt,it,v,p,a,c,h={point:w,lineStart:k,lineEnd:d,polygonStart:function(){h.point=g,h.lineStart=rt,h.lineEnd=ut,p=0,y.polygonStart()},polygonEnd:function(){y.polygonEnd(),h.point=w,h.lineStart=k,h.lineEnd=d,0>bt?(t=-(u=180),o=-(s=90)):p>i?s=90:-i>p&&(o=-90),c[0]=t,c[1]=u}};return function(i){var v;if(s=u=-(t=o=1/0),a=[],n.geo.stream(i,h),v=a.length,v){a.sort(ft);for(var e,l=1,r=a[0],y=[r];v>l;++l)e=a[l],nt(e[0],r)||nt(e[1],r)?(f(r[0],e[1])>f(r[0],r[1])&&(r[1]=e[1]),f(e[0],r[1])>f(r[0],r[1])&&(r[0]=e[0])):y.push(r=e);for(var p,e,w=-1/0,v=y.length-1,l=0,r=y[v];v>=l;r=e,++l)e=y[l],(p=f(r[1],e[0]))>w&&(w=p,t=e[0],u=r[1])}return a=c=null,1/0===t||1/0===o?[[NaN,NaN],[NaN,NaN]]:[[t,o],[u,s]]}}(),n.geo.centroid=function(t){cr=hf=ci=li=ct=kt=dt=rt=di=gi=gt=0,n.geo.stream(t,k);var r=di,u=gi,f=gt,o=r*r+u*u+f*f;return ip>o&&(r=kt,u=dt,f=rt,i>hf&&(r=ci,u=li,f=ct),o=r*r+u*u+f*f,ip>o)?[NaN,NaN]:[Math.atan2(u,r)*e,ri(f/Math.sqrt(o))*e]};var cr,hf,ci,li,ct,kt,dt,rt,di,gi,gt,k={sphere:s,point:uo,lineStart:yl,lineEnd:pl,polygonStart:function(){k.lineStart=eb},polygonEnd:function(){k.lineStart=yl}},sp=kl(tr,hb,lb,ab),rit=[-t,0],cf=1e9;(n.geo.conicEqualArea=function(){return fo(ta)}).raw=ta,n.geo.albers=function(){return n.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},n.geo.albersUsa=function(){function r(n){var t=n[0],i=n[1];return u=null,s(t,i),u||(h(t,i),u)||c(t,i),u}var u,s,h,c,t=n.geo.albers(),f=n.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),e=n.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o={point:function(n,t){u=[n,t]}};return r.invert=function(n){var u=t.scale(),o=t.translate(),i=(n[0]-o[0])/u,r=(n[1]-o[1])/u;return(r>=.12&&.234>r&&i>=-.425&&-.214>i?f:r>=.166&&.234>r&&i>=-.214&&-.115>i?e:t).invert(n)},r.stream=function(n){var i=t.stream(n),r=f.stream(n),u=e.stream(n);return{point:function(n,t){i.point(n,t),r.point(n,t),u.point(n,t)},sphere:function(){i.sphere(),r.sphere(),u.sphere()},lineStart:function(){i.lineStart(),r.lineStart(),u.lineStart()},lineEnd:function(){i.lineEnd(),r.lineEnd(),u.lineEnd()},polygonStart:function(){i.polygonStart(),r.polygonStart(),u.polygonStart()},polygonEnd:function(){i.polygonEnd(),r.polygonEnd(),u.polygonEnd()}}},r.precision=function(n){return arguments.length?(t.precision(n),f.precision(n),e.precision(n),r):t.precision()},r.scale=function(n){return arguments.length?(t.scale(n),f.scale(.35*n),e.scale(n),r.translate(t.translate())):t.scale()},r.translate=function(n){if(!arguments.length)return t.translate();var u=t.scale(),l=+n[0],a=+n[1];return s=t.translate(n).clipExtent([[l-.455*u,a-.238*u],[l+.455*u,a+.238*u]]).stream(o).point,h=f.translate([l-.307*u,a+.201*u]).clipExtent([[l-.425*u+i,a+.12*u+i],[l-.214*u-i,a+.234*u-i]]).stream(o).point,c=e.translate([l-.205*u,a+.212*u]).clipExtent([[l-.214*u+i,a+.166*u+i],[l-.115*u-i,a+.234*u-i]]).stream(o).point,r},r.scale(1070)};var sh,hh,lf,af,vf,yf,ni={point:s,lineStart:s,lineEnd:s,polygonStart:function(){hh=0,ni.lineStart=pb},polygonEnd:function(){ni.lineStart=ni.lineEnd=ni.point=s,sh+=Math.abs(hh/2)}},uit={point:wb,lineStart:s,lineEnd:s,polygonStart:s,polygonEnd:s},d={point:fi,lineStart:ra,lineEnd:ua,polygonStart:function(){d.lineStart=kb},polygonEnd:function(){d.point=fi,d.lineStart=ra,d.lineEnd=ua}};n.geo.path=function(){function t(t){return t&&("function"==typeof r&&i.pointRadius(+r.apply(this,arguments)),f&&f.valid||(f=u(i)),n.geo.stream(t,f)),i.result()}function e(){return f=null,t}var o,s,u,i,f,r=4.5;return t.area=function(t){return sh=0,n.geo.stream(t,u(ni)),sh},t.centroid=function(t){return ci=li=ct=kt=dt=rt=di=gi=gt=0,n.geo.stream(t,u(d)),gt?[di/gt,gi/gt]:rt?[kt/rt,dt/rt]:ct?[ci/ct,li/ct]:[NaN,NaN]},t.bounds=function(t){return vf=yf=-(lf=af=1/0),n.geo.stream(t,u(uit)),[[lf,af],[vf,yf]]},t.projection=function(n){return arguments.length?(u=(o=n)?n.stream||gb(n):a,e()):o},t.context=function(n){return arguments.length?(i=null==(s=n)?new bb:new db(n),"function"!=typeof r&&i.pointRadius(r),e()):s},t.pointRadius=function(n){return arguments.length?(r="function"==typeof n?n:(i.pointRadius(+n),+n),t):r},t.projection(n.geo.albersUsa()).context(null)},n.geo.projection=pt,n.geo.projectionMutator=eo,(n.geo.equirectangular=function(){return pt(ir)}).raw=ir.invert=ir,n.geo.rotation=function(n){function t(t){return t=n(t[0]*r,t[1]*r),t[0]*=e,t[1]*=e,t}return n=oo(n[0]%360*r,n[1]*r,n.length>2?n[2]*r:0),t.invert=function(t){return t=n.invert(t[0]*r,t[1]*r),t[0]*=e,t[1]*=e,t},t},n.geo.circle=function(){function n(){var n="function"==typeof t?t.apply(this,arguments):t,f=oo(-n[0]*r,-n[1]*r,0).invert,i=[];return u(null,null,1,{point:function(n,t){i.push(n=f(n,t)),n[0]*=e,n[1]*=e}}),{type:"Polygon",coordinates:[i]}}var i,u,t=[0,0],f=6;return n.origin=function(i){return arguments.length?(t=i,n):t},n.angle=function(t){return arguments.length?(u=so((i=+t)*r,f*r),n):i},n.precision=function(t){return arguments.length?(u=so(i*r,(f=+t)*r),n):f},n.angle(90)},n.geo.distance=function(n,t){var i,f=(t[0]-n[0])*r,e=n[1]*r,o=t[1]*r,a=Math.sin(f),s=Math.cos(f),h=Math.sin(e),c=Math.cos(e),l=Math.sin(o),u=Math.cos(o);return Math.atan2(Math.sqrt((i=u*a)*i+(i=c*l-h*u*s)*i),h*l+c*u*s)},n.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:k()}}function k(){return n.range(Math.ceil(u/a)*a,r,a).map(w).concat(n.range(Math.ceil(e/v)*v,f,v).map(b)).concat(n.range(Math.ceil(s/l)*l,o,l).filter(function(n){return Math.abs(n%a)>i}).map(d)).concat(n.range(Math.ceil(c/p)*p,h,p).filter(function(n){return Math.abs(n%v)>i}).map(g))}var o,s,r,u,h,c,f,e,d,g,w,b,l=10,p=l,a=90,v=360,y=2.5;return t.lines=function(){return k().map(function(n){return{type:"LineString",coordinates:n}})},t.outline=function(){return{type:"Polygon",coordinates:[w(u).concat(b(f).slice(1),w(r).reverse().slice(1),b(e).reverse().slice(1))]}},t.extent=function(n){return arguments.length?t.majorExtent(n).minorExtent(n):t.minorExtent()},t.majorExtent=function(n){return arguments.length?(u=+n[0][0],r=+n[1][0],e=+n[0][1],f=+n[1][1],u>r&&(n=u,u=r,r=n),e>f&&(n=e,e=f,f=n),t.precision(y)):[[u,e],[r,f]]},t.minorExtent=function(n){return arguments.length?(s=+n[0][0],o=+n[1][0],c=+n[0][1],h=+n[1][1],s>o&&(n=s,s=o,o=n),c>h&&(n=c,c=h,h=n),t.precision(y)):[[s,c],[o,h]]},t.step=function(n){return arguments.length?t.majorStep(n).minorStep(n):t.minorStep()},t.majorStep=function(n){return arguments.length?(a=+n[0],v=+n[1],t):[a,v]},t.minorStep=function(n){return arguments.length?(l=+n[0],p=+n[1],t):[l,p]},t.precision=function(n){return arguments.length?(y=+n,d=ca(c,h,90),g=la(s,o,y),w=ca(e,f,90),b=la(u,r,y),t):y},t.majorExtent([[-180,-90+i],[180,90-i]]).minorExtent([[-180,-80-i],[180,80+i]])},n.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[u||i.apply(this,arguments),f||r.apply(this,arguments)]}}var u,f,i=ho,r=co;return t.distance=function(){return n.geo.distance(u||i.apply(this,arguments),f||r.apply(this,arguments))},t.source=function(n){return arguments.length?(i=n,u="function"==typeof n?null:n,t):i},t.target=function(n){return arguments.length?(r=n,f="function"==typeof n?null:n,t):r},t.precision=function(){return arguments.length?t:0},t},n.geo.interpolate=function(n,t){return tk(n[0]*r,n[1]*r,t[0]*r,t[1]*r)},n.geo.length=function(t){return ch=0,n.geo.stream(t,ai),ch},ai={sphere:s,point:s,lineStart:ik,lineEnd:s,polygonStart:s,polygonEnd:s},lh=rr(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)}),(n.geo.azimuthalEqualArea=function(){return pt(lh)}).raw=lh,ah=rr(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},a),(n.geo.azimuthalEquidistant=function(){return pt(ah)}).raw=ah,(n.geo.conicConformal=function(){return fo(aa)}).raw=aa,(n.geo.conicEquidistant=function(){return fo(va)}).raw=va,vh=rr(function(n){return 1/n},Math.atan),(n.geo.gnomonic=function(){return pt(vh)}).raw=vh,uu.invert=function(n,i){return[n,2*Math.atan(Math.exp(i))-t/2]},(n.geo.mercator=function(){return ya(uu)}).raw=uu,yh=rr(function(){return 1},Math.asin),(n.geo.orthographic=function(){return pt(yh)}).raw=yh,ph=rr(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)}),(n.geo.stereographic=function(){return pt(ph)}).raw=ph,lo.invert=function(n,t){return[Math.atan2(nb(n),Math.cos(t)),ri(Math.sin(t)/tb(n))]},(n.geo.transverseMercator=function(){return ya(lo)}).raw=lo,n.geom={},n.svg={},n.svg.line=function(){return pa(a)},pf=n.map({linear:p,"linear-closed":rk,step:uk,"step-before":ao,"step-after":vo,basis:wa,"basis-open":sk,"basis-closed":hk,bundle:ck,cardinal:ok,"cardinal-open":fk,"cardinal-closed":ek,monotone:vk}),pf.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var hp=[0,2/3,1/3,0],cp=[0,1/3,2/3,0],ti=[0,1/6,2/3,1/6];n.geom.hull=function(n){function t(n){var d;if(n.length<3)return[];var u,g,t,o,l,a,p,w,b,v,k,c,tt=f(r),rt=f(i),y=n.length,it=y-1,e=[],h=[],s=0;if(tt===nt&&i===ft)u=n;else for(t=0,u=[];y>t;++t)u.push([+tt.call(this,g=n[t],t),+rt.call(this,g,t)]);for(t=1;y>t;++t)(u[t][1]<u[s][1]||u[t][1]==u[s][1]&&u[t][0]<u[s][0])&&(s=t);for(t=0;y>t;++t)t!==s&&(a=u[t][1]-u[s][1],l=u[t][0]-u[s][0],e.push({angle:Math.atan2(a,l),index:t}));for(e.sort(function(n,t){return n.angle-t.angle}),k=e[0].angle,v=e[0].index,b=0,t=1;it>t;++t){if(o=e[t].index,k==e[t].angle){if(l=u[v][0]-u[s][0],a=u[v][1]-u[s][1],p=u[o][0]-u[s][0],w=u[o][1]-u[s][1],l*l+a*a>=p*p+w*w){e[t].index=-1;continue}e[b].index=-1}k=e[t].angle,b=t,v=o}for(h.push(s),t=0,o=0;2>t;++o)e[o].index>-1&&(h.push(e[o].index),t++);for(c=h.length;it>o;++o)if(!(e[o].index<0)){for(;!yk(h[c-2],h[c-1],e[o].index,u);)--c;h[c++]=e[o].index}for(d=[],t=c-1;t>=0;--t)d.push(n[h[t]]);return d}var r=nt,i=ft;return arguments.length?t(n):(t.x=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(i=n,t):i},t)},n.geom.polygon=function(n){return yu(n,lr),n},lr=n.geom.polygon.prototype=[],lr.area=function(){for(var t,i=-1,r=this.length,n=this[r-1],u=0;++i<r;)t=n,n=this[i],u+=t[1]*n[0]-t[0]*n[1];return.5*u},lr.centroid=function(n){var i,r,u=-1,f=this.length,e=0,o=0,t=this[f-1];for(arguments.length||(n=-1/(6*this.area()));++u<f;)i=t,t=this[u],r=i[0]*t[1]-t[0]*i[1],e+=(i[0]+t[0])*r,o+=(i[1]+t[1])*r;return[e*n,o*n]},lr.clip=function(n){for(var f,e,o,t,i,r,s=ka(n),h=-1,c=this.length-ka(this),u=this[c-1];++h<c;){for(f=n.slice(),n.length=0,t=this[h],i=f[(o=f.length-s)-1],e=-1;++e<o;)r=f[e],bo(r,u,t)?(bo(i,u,t)||n.push(ba(i,r,u,t)),n.push(r)):bo(i,u,t)&&n.push(ba(i,r,u,t)),i=r;s&&n.push(n[0]),u=t}return n},n.geom.delaunay=function(n){var t=n.map(function(){return[]}),i=[];return ko(n,function(i){t[i.region.l.index].push(n[i.region.r.index])}),t.forEach(function(t,r){var f=n[r],o=f[0],s=f[1],u,e;for(t.forEach(function(n){n.angle=Math.atan2(n[0]-o,n[1]-s)}),t.sort(function(n,t){return n.angle-t.angle}),u=0,e=t.length-1;e>u;u++)i.push([f,t[u],t[u+1]])}),i},n.geom.voronoi=function(t){function r(t){var c,a,s,h=t.map(function(){return[]}),v=f(e),y=f(o),l=t.length,r=1e6;if(v===nt&&y===ft)c=t;else for(c=new Array(l),s=0;l>s;++s)c[s]=[+v.call(this,a=t[s],s),+y.call(this,a,s)];if(ko(c,function(n){var t,i,u,f,e,o,s,c;1===n.a&&n.b>=0?(t=n.ep.r,i=n.ep.l):(t=n.ep.l,i=n.ep.r),1===n.a?(e=t?t.y:-r,u=n.c-n.b*e,o=i?i.y:r,f=n.c-n.b*o):(u=t?t.x:-r,e=n.c-n.a*u,f=i?i.x:r,o=n.c-n.a*f),s=[u,e],c=[f,o],h[n.region.l.index].push(s,c),h[n.region.r.index].push(s,c)}),h=h.map(function(t,r){var e=c[r][0],o=c[r][1],u=t.map(function(n){return Math.atan2(n[0]-e,n[1]-o)}),f=n.range(t.length).sort(function(n,t){return u[n]-u[t]});return f.filter(function(n,t){return!t||u[n]-u[f[t-1]]>i}).map(function(n){return t[n]})}),h.forEach(function(n,t){var l=n.length,s,u,h;if(!l)return n.push([-r,-r],[-r,r],[r,r],[r,-r]);if(!(l>2)){var a=c[t],v=n[0],y=n[1],p=a[0],w=a[1],f=v[0],e=v[1],b=y[0],k=y[1],d=Math.abs(b-f),o=k-e;Math.abs(o)<i?(u=e>w?-r:r,n.push([-r,u],[r,u])):i>d?(s=f>p?-r:r,n.push([s,-r],[s,r])):(u=(f-p)*(k-e)>(b-f)*(e-w)?r:-r,h=Math.abs(o)-d,Math.abs(h)<i?n.push([0>o?u:-u,u]):(h>0&&(u*=-1),n.push([-r,u],[r,u])))}}),u)for(s=0;l>s;++s)u.clip(h[s]);for(s=0;l>s;++s)h[s].point=t[s];return h}var e=nt,o=ft,u=null;return arguments.length?r(t):(r.x=function(n){return arguments.length?(e=n,r):e},r.y=function(n){return arguments.length?(o=n,r):o},r.clipExtent=function(t){if(!arguments.length)return u&&[u[0],u[2]];if(null==t)u=null;else{var i=+t[0][0],f=+t[0][1],e=+t[1][0],o=+t[1][1];u=n.geom.polygon([[i,f],[i,o],[e,o],[e,f]])}return r},r.size=function(n){return arguments.length?r.clipExtent(n&&[[0,0],n]):u&&u[2]},r.links=function(n){var i,u,t,r=n.map(function(){return[]}),s=[],h=f(e),c=f(o),l=n.length;if(h===nt&&c===ft)i=n;else for(i=new Array(l),t=0;l>t;++t)i[t]=[+h.call(this,u=n[t],t),+c.call(this,u,t)];return ko(i,function(t){var i=t.region.l.index,u=t.region.r.index;r[i][u]||(r[i][u]=r[u][i]=!0,s.push({source:n[i],target:n[u]}))}),s},r.triangles=function(t){if(e===nt&&o===ft)return n.geom.delaunay(t);for(var r,u=new Array(s),h=f(e),c=f(o),i=-1,s=t.length;++i<s;)(u[i]=[+h.call(this,r=t[i],i),+c.call(this,r,i)]).data=r;return n.geom.delaunay(u).map(function(n){return n.map(function(n){return n.data})})},r)},wf={l:"r",r:"l"},n.geom.quadtree=function(n,t,i,r,u){function e(n){function tt(n,t,i,r,u,f,e,o){var s,h,c;isNaN(i)||isNaN(r)||(n.leaf?(s=n.x,h=n.y,null!=s?Math.abs(s-i)+Math.abs(h-r)<.01?g(n,t,i,r,u,f,e,o):(c=n.point,n.x=n.y=n.point=null,g(n,c,s,h,u,f,e,o),g(n,t,i,r,u,f,e,o)):(n.x=i,n.y=r,n.point=t)):g(n,t,i,r,u,f,e,o))}function g(n,t,i,r,u,f,e,o){var s=.5*(u+e),h=.5*(f+o),c=i>=s,l=r>=h,a=(l<<1)+c;n.leaf=!1,n=n.nodes[a]||(n.nodes[a]=da()),c?u=s:e=s,l?f=h:o=h,tt(n,t,i,r,u,f,e,o)}var c,k,d,e,nt,l,a,v,y,ut=f(o),ft=f(s),w,b,it,rt,p;if(null!=t)l=t,a=i,v=r,y=u;else if(v=y=-(l=a=1/0),k=[],d=[],nt=n.length,h)for(e=0;nt>e;++e)c=n[e],c.x<l&&(l=c.x),c.y<a&&(a=c.y),c.x>v&&(v=c.x),c.y>y&&(y=c.y),k.push(c.x),d.push(c.y);else for(e=0;nt>e;++e)w=+ut(c=n[e],e),b=+ft(c,e),l>w&&(l=w),a>b&&(a=b),w>v&&(v=w),b>y&&(y=b),k.push(w),d.push(b);if(it=v-l,rt=y-a,it>rt?y=a+it:v=l+rt,p=da(),p.add=function(n){tt(p,n,+ut(n,++e),+ft(n,e),l,a,v,y)},p.visit=function(n){ur(n,p,l,a,v,y)},e=-1,null==t){for(;++e<nt;)tt(p,n[e],k[e],d[e],l,a,v,y);--e}else n.forEach(p.add);return k=d=n=c=null,p}var h,o=nt,s=ft;return(h=arguments.length)?(o=pk,s=wk,3===h&&(u=i,r=t,i=t=0),e(n)):(e.x=function(n){return arguments.length?(o=n,e):o},e.y=function(n){return arguments.length?(s=n,e):s},e.extent=function(n){return arguments.length?(null==n?t=i=r=u=null:(t=+n[0][0],i=+n[0][1],r=+n[1][0],u=+n[1][1]),e):null==t?null:[[t,i],[r,u]]},e.size=function(n){return arguments.length?(null==n?t=i=r=u=null:(t=i=0,r=+n[0],u=+n[1]),e):null==t?null:[r-t,u-i]},e)},n.interpolateRgb=go,n.interpolateObject=ga,n.interpolateNumber=et,n.interpolateString=nv,ar=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,n.interpolate=ei,n.interpolators=[function(n,t){var i=typeof t;return("string"===i?sr.has(t)||/^(#|rgb\(|hsl\()/.test(t)?go:nv:t instanceof vi?go:"object"===i?Array.isArray(t)?tv:ga:et)(n,t)}],n.interpolateArray=tv;var lp=function(){return a},fit=n.map({linear:lp,poly:nd,quad:function(){return kk},cubic:function(){return dk},sin:function(){return td},exp:function(){return id},circle:function(){return rd},elastic:ud,back:fd,bounce:function(){return ed}}),eit=n.map({"in":a,out:iv,"in-out":rv,"out-in":function(n){return rv(iv(n))}});n.ease=function(n){var t=n.indexOf("-"),i=t>=0?n.substring(0,t):n,r=t>=0?n.substring(t+1):"in";return i=fit.get(i)||lp,r=eit.get(r)||a,bk(r(i.apply(null,Array.prototype.slice.call(arguments,1))))},n.interpolateHcl=od,n.interpolateHsl=sd,n.interpolateLab=hd,n.interpolateRound=uv,n.transform=function(t){var i=b.createElementNS(n.ns.prefix.svg,"g");return(n.transform=function(n){if(null!=n){i.setAttribute("transform",n);var t=i.transform.baseVal.consolidate()}return new fv(t?t.matrix:ap)})(t)},fv.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"},ap={a:1,b:0,c:0,d:1,e:0,f:0},n.interpolateTransform=sv,n.layout={},n.layout.bundle=function(){return function(n){for(var t=[],i=-1,r=n.length;++i<r;)t.push(vd(n[i]));return t}},n.layout.chord=function(){function l(){var y,i,k,l,v,d={},g=[],it=n.range(u),nt=[],w,b;for(r=[],f=[],y=0,l=-1;++l<u;){for(i=0,v=-1;++v<u;)i+=e[l][v];g.push(i),nt.push(n.range(u)),y+=i}for(o&&it.sort(function(n,t){return o(g[n],g[t])}),s&&nt.forEach(function(n,t){n.sort(function(n,i){return s(e[t][n],e[t][i])})}),y=(2*t-c*u)/y,i=0,l=-1;++l<u;){for(k=i,v=-1;++v<u;){var p=it[l],tt=nt[p][v],rt=e[p][tt],ut=i,ft=i+=rt*y;d[p+"-"+tt]={index:p,subindex:tt,startAngle:ut,endAngle:ft,value:rt}}f[p]={index:p,startAngle:k,endAngle:i,value:(i-k)/y},i+=c}for(l=-1;++l<u;)for(v=l-1;++v<u;)w=d[l+"-"+v],b=d[v+"-"+l],(w.value||b.value)&&r.push(w.value<b.value?{source:b,target:w}:{source:w,target:b});h&&a()}function a(){r.sort(function(n,t){return h((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var r,f,e,u,o,s,h,i={},c=0;return i.matrix=function(n){return arguments.length?(u=(e=n)&&e.length,r=f=null,i):e},i.padding=function(n){return arguments.length?(c=n,r=f=null,i):c},i.sortGroups=function(n){return arguments.length?(o=n,r=f=null,i):o},i.sortSubgroups=function(n){return arguments.length?(s=n,r=null,i):s},i.sortChords=function(n){return arguments.length?(h=n,r&&a(),i):h},i.chords=function(){return r||l(),r},i.groups=function(){return f||l(),f},i},n.layout.force=function(){function k(n){return function(t,i,r,u){var e;if(t.point!==n){var o=t.cx-n.x,s=t.cy-n.y,f=1/Math.sqrt(o*o+s*s);if(b>(u-i)*f)return e=t.charge*f*f,n.px-=o*e,n.py-=s*e,!0;t.point&&isFinite(f)&&(e=t.pointCharge*f*f,n.px-=o*e,n.py-=s*e)}return!t.charge}}function d(i){i.px=n.event.x,i.py=n.event.y,t.resume()}var h,r,c,l,v,t={},y=n.dispatch("start","tick","end"),f=[1,1],p=.9,o=vp,s=yp,e=-30,w=.1,b=.8,i=[],u=[];return t.tick=function(){if((r*=.99)<.005)return y.end({type:"end",alpha:r=0}),!0;for(var tt,t,b,g,d,s,h,a,nt=i.length,it=u.length,o=0;it>o;++o)t=u[o],b=t.source,g=t.target,h=g.x-b.x,a=g.y-b.y,(d=h*h+a*a)&&(d=r*l[o]*((d=Math.sqrt(d))-c[o])/d,h*=d,a*=d,g.x-=h*(s=b.weight/(g.weight+b.weight)),g.y-=a*s,b.x+=h*(s=1-s),b.y+=a*s);if((s=r*w)&&(h=f[0]/2,a=f[1]/2,o=-1,s))for(;++o<nt;)t=i[o],t.x+=(h-t.x)*s,t.y+=(a-t.y)*s;if(e)for(cv(tt=n.geom.quadtree(i),r,v),o=-1;++o<nt;)(t=i[o]).fixed||tt.visit(k(t));for(o=-1;++o<nt;)t=i[o],t.fixed?(t.x=t.px,t.y=t.py):(t.x-=(t.px-(t.px=t.x))*p,t.y-=(t.py-(t.py=t.y))*p);y.tick({type:"tick",alpha:r})},t.nodes=function(n){return arguments.length?(i=n,t):i},t.links=function(n){return arguments.length?(u=n,t):u},t.size=function(n){return arguments.length?(f=n,t):f},t.linkDistance=function(n){return arguments.length?(o="function"==typeof n?n:+n,t):o},t.distance=t.linkDistance,t.linkStrength=function(n){return arguments.length?(s="function"==typeof n?n:+n,t):s},t.friction=function(n){return arguments.length?(p=+n,t):p},t.charge=function(n){return arguments.length?(e="function"==typeof n?n:+n,t):e},t.gravity=function(n){return arguments.length?(w=+n,t):w},t.theta=function(n){return arguments.length?(b=+n,t):b},t.alpha=function(i){return arguments.length?(i=+i,r?r=i>0?i:0:i>0&&(y.start({type:"start",alpha:r=i}),n.timer(t.tick)),t):r},t.start=function(){function w(t,i){for(var r,u=b(n),f=-1,e=u.length;++f<e;)if(!isNaN(r=u[f][t]))return r;return Math.random()*i}function b(){if(!a){for(a=[],h=0;p>h;++h)a[h]=[];for(h=0;y>h;++h){var t=u[h];a[t.source.index].push(t.target),a[t.target.index].push(t.source)}}return a[n]}for(var h,a,r,p=i.length,y=u.length,k=f[0],d=f[1],n=0;p>n;++n)(r=i[n]).index=n,r.weight=0;for(n=0;y>n;++n)r=u[n],"number"==typeof r.source&&(r.source=i[r.source]),"number"==typeof r.target&&(r.target=i[r.target]),++r.source.weight,++r.target.weight;for(n=0;p>n;++n)r=i[n],isNaN(r.x)&&(r.x=w("x",k)),isNaN(r.y)&&(r.y=w("y",d)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(c=[],"function"==typeof o)for(n=0;y>n;++n)c[n]=+o.call(this,u[n],n);else for(n=0;y>n;++n)c[n]=o;if(l=[],"function"==typeof s)for(n=0;y>n;++n)l[n]=+s.call(this,u[n],n);else for(n=0;y>n;++n)l[n]=s;if(v=[],"function"==typeof e)for(n=0;p>n;++n)v[n]=+e.call(this,i[n],n);else for(n=0;p>n;++n)v[n]=e;return t.resume()},t.resume=function(){return t.alpha(.1)},t.stop=function(){return t.alpha(0)},t.drag=function(){return h||(h=n.behavior.drag().origin(a).on("dragstart.force",pd).on("drag.force",d).on("dragend.force",wd)),arguments.length?(this.on("mouseover.force",bd).on("mouseout.force",kd).call(h),void 0):h},n.rebind(t,y,"on")},vp=20,yp=1,n.layout.hierarchy=function(){function u(f,e,o){var h=r.call(n,f,e);if(f.depth=e,o.push(f),h&&(c=h.length)){for(var c,s,l=-1,a=f.children=[],v=0,y=e+1;++l<c;)s=u(h[l],y,o),s.parent=f,a.push(s),v+=s.value;i&&a.sort(i),t&&(f.value=v)}else t&&(f.value=+t.call(n,f,e)||0);return f}function f(i,r){var e=i.children,u=0,s,o,h;if(e&&(s=e.length))for(o=-1,h=r+1;++o<s;)u+=f(e[o],h);else t&&(u=+t.call(n,i,r)||0);return t&&(i.value=u),u}function n(n){var t=[];return u(n,0,t),t}var i=ng,r=dd,t=gd;return n.sort=function(t){return arguments.length?(i=t,n):i},n.children=function(t){return arguments.length?(r=t,n):r},n.value=function(i){return arguments.length?(t=i,n):t},n.revalue=function(n){return f(n,0),n},n},n.layout.partition=function(){function r(n,t,i,u){var f=n.children,o,s,h,e;if(n.x=t,n.y=n.depth*u,n.dx=i,n.dy=u,f&&(o=f.length))for(e=-1,i=n.value?i/n.value:0;++e<o;)r(s=f[e],t,h=s.value*i,u),t+=h}function u(n){var t=n.children,i=0,f,r;if(t&&(f=t.length))for(r=-1;++r<f;)i=Math.max(i,u(t[r]));return 1+i}function i(n,i){var e=f.call(this,n,i);return r(e[0],0,t[0],t[1]/u(e[0])),e}var f=n.layout.hierarchy(),t=[1,1];return i.size=function(n){return arguments.length?(t=n,i):t},fr(i,f)},n.layout.pie=function(){function i(t){var o=t.map(function(n,t){return+e.call(i,n,t)}),s=+("function"==typeof u?u.apply(this,arguments):u),l=(("function"==typeof f?f.apply(this,arguments):f)-s)/n.sum(o),c=n.range(t.length),h;return null!=r&&c.sort(r===wh?function(n,t){return o[t]-o[n]}:function(n,i){return r(t[n],t[i])}),h=[],c.forEach(function(n){var i;h[n]={data:t[n],value:i=o[n],startAngle:s,endAngle:s+=i*l}}),h}var e=Number,r=wh,u=0,f=2*t;return i.value=function(n){return arguments.length?(e=n,i):e},i.sort=function(n){return arguments.length?(r=n,i):r},i.startAngle=function(n){return arguments.length?(u=n,i):u},i.endAngle=function(n){return arguments.length?(f=n,i):f},i},wh={},n.layout.stack=function(){function t(s,h){var l=s.map(function(n,i){return r.call(t,n,i)}),a=l.map(function(n){return n.map(function(n,i){return[e.call(t,n,i),o.call(t,n,i)]})}),y=u.call(t,a,h);l=n.permute(l,y),a=n.permute(a,y);for(var v,p,w=f.call(t,a,h),b=l.length,k=l[0].length,c=0;k>c;++c)for(i.call(t,l[0][c],p=w[c],a[0][c][1]),v=1;b>v;++v)i.call(t,l[v][c],p+=a[v-1][c][1],a[v][c][1]);return s}var r=a,u=ns,f=ts,i=ug,e=ig,o=rg;return t.values=function(n){return arguments.length?(r=n,t):r},t.order=function(n){return arguments.length?(u="function"==typeof n?n:pp.get(n)||ns,t):u},t.offset=function(n){return arguments.length?(f="function"==typeof n?n:wp.get(n)||ts,t):f},t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(o=n,t):o},t.out=function(n){return arguments.length?(i=n,t):i},t},pp=n.map({"inside-out":function(t){for(var i,u=t.length,f=t.map(fg),e=t.map(eg),l=n.range(u).sort(function(n,t){return f[n]-f[t]}),o=0,s=0,h=[],c=[],r=0;u>r;++r)i=l[r],s>o?(o+=e[i],h.push(i)):(s+=e[i],c.push(i));return c.reverse().concat(h)},reverse:function(t){return n.range(t.length).reverse()},"default":ns}),wp=n.map({silhouette:function(n){for(var r,i,s=n.length,f=n[0].length,e=[],u=0,o=[],t=0;f>t;++t){for(r=0,i=0;s>r;r++)i+=n[r][t][1];i>u&&(u=i),e.push(i)}for(t=0;f>t;++t)o[t]=(u-e[t])/2;return o},wiggle:function(n){var i,t,r,u,h,c,f,e,o,a=n.length,l=n[0],v=l.length,s=[];for(s[0]=e=o=0,t=1;v>t;++t){for(i=0,u=0;a>i;++i)u+=n[i][t][1];for(i=0,h=0,f=l[t][0]-l[t-1][0];a>i;++i){for(r=0,c=(n[i][t][1]-n[i][t-1][1])/(2*f);i>r;++r)c+=(n[r][t][1]-n[r][t-1][1])/f;h+=c*n[i][t][1]}s[t]=e-=u?h/u*f:0,o>e&&(o=e)}for(t=0;v>t;++t)s[t]-=o;return s},expand:function(n){for(var t,r,u=n.length,f=n[0].length,o=1/u,e=[],i=0;f>i;++i){for(t=0,r=0;u>t;t++)r+=n[t][i][1];if(r)for(t=0;u>t;t++)n[t][i][1]/=r;else for(t=0;u>t;t++)n[t][i][1]=o}for(i=0;f>i;++i)e[i]=0;return e},zero:ts}),n.layout.histogram=function(){function t(t,f){for(var o,s,l=[],h=t.map(r,this),a=u.call(this,h,f),c=e.call(this,a,h,f),f=-1,y=h.length,v=c.length-1,p=i?1:1/y;++f<v;)o=l[f]=[],o.dx=c[f+1]-(o.x=c[f]),o.y=0;if(v>0)for(f=-1;++f<y;)s=h[f],s>=a[0]&&s<=a[1]&&(o=l[n.bisect(c,s,1,v)-1],o.y+=p,o.push(t[f]));return l}var i=!0,r=Number,u=hg,e=sg;return t.value=function(n){return arguments.length?(r=n,t):r},t.range=function(n){return arguments.length?(u=f(n),t):u},t.bins=function(n){return arguments.length?(e="number"==typeof n?function(t){return lv(t,n)}:f(n),t):e},t.frequency=function(n){return arguments.length?(i=!!n,t):i},t},n.layout.tree=function(){function i(n,i){function h(n,t){var f=n.children,i=n._tree,o;if(f&&(s=f.length)){for(var s,e,u,c=f[0],l=c,a=-1;++a<s;)u=f[a],h(u,e),l=v(u,e,l),e=u;vg(n),o=.5*(c._tree.prelim+u._tree.prelim),t?(i.prelim=t._tree.prelim+r(n,t),i.mod=i.prelim-o):i.prelim=o}else t&&(i.prelim=t._tree.prelim+r(n,t))}function c(n,t){var i,u,r;if(n.x=n._tree.prelim+t,i=n.children,i&&(u=i.length))for(r=-1,t+=n._tree.mod;++r<u;)c(i[r],t)}function v(n,t,i){if(t){for(var s,f=n,e=n,u=t,o=n.parent.children[0],h=f._tree.mod,c=e._tree.mod,l=u._tree.mod,a=o._tree.mod;u=rs(u),f=is(f),u&&f;)o=is(o),e=rs(e),e._tree.ancestor=n,s=u._tree.prelim+l-f._tree.prelim-h+r(u,f),s>0&&(yg(pg(u,n,i),n,s),h+=s,c+=s),l+=u._tree.mod,h+=f._tree.mod,a+=o._tree.mod,c+=e._tree.mod;u&&!rs(e)&&(e._tree.thread=u,e._tree.mod+=l-c),f&&!is(o)&&(o._tree.thread=f,o._tree.mod+=h-a,i=n)}return i}var l=f.call(this,n,i),e=l[0];ot(e,function(n,t){n._tree={ancestor:n,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),h(e),c(e,-e._tree.prelim);var o=eu(e,lg),s=eu(e,cg),y=eu(e,ag),a=o.x-r(o,s)/2,p=s.x+r(s,o)/2,w=y.depth||1;return ot(e,u?function(n){n.x*=t[0],n.y=n.depth*t[1],delete n._tree}:function(n){n.x=(n.x-a)/(p-a)*t[0],n.y=n.depth/w*t[1],delete n._tree}),l}var f=n.layout.hierarchy().sort(null).value(null),r=av,t=[1,1],u=!1;return i.separation=function(n){return arguments.length?(r=n,i):r},i.size=function(n){return arguments.length?(u=null==(t=n),i):u?null:t},i.nodeSize=function(n){return arguments.length?(u=null!=(t=n),i):u?t:null},fr(i,f)},n.layout.pack=function(){function i(n,i){var c=f.call(this,n,i),e=c[0],o=u[0],s=u[1],l=null==t?Math.sqrt:"function"==typeof t?t:function(){return t},h;return(e.x=e.y=0,ot(e,function(n){n.r=+l(n.value)}),ot(e,pv),r)&&(h=r*(t?1:Math.max(2*e.r/o,2*e.r/s))/2,ot(e,function(n){n.r+=h}),ot(e,pv),ot(e,function(n){n.r-=h})),wv(e,o/2,s/2,t?1:1/Math.max(2*e.r/o,2*e.r/s)),c}var t,f=n.layout.hierarchy().sort(wg),r=0,u=[1,1];return i.size=function(n){return arguments.length?(u=n,i):u},i.radius=function(n){return arguments.length?(t=null==n||"function"==typeof n?n:+n,i):t},i.padding=function(n){return arguments.length?(r=+n,i):r},fr(i,f)},n.layout.cluster=function(){function i(n,i){var o,c=f.call(this,n,i),e=c[0],a=0;ot(e,function(n){var t=n.children;t&&t.length?(n.x=gg(t),n.y=dg(t)):(n.x=o?a+=r(n,o):0,n.y=0,o=n)});var s=kv(e),h=dv(e),l=s.x-r(s,h)/2,v=h.x+r(h,s)/2;return ot(e,u?function(n){n.x=(n.x-e.x)*t[0],n.y=(e.y-n.y)*t[1]}:function(n){n.x=(n.x-l)/(v-l)*t[0],n.y=(1-(e.y?n.y/e.y:1))*t[1]}),c}var f=n.layout.hierarchy().sort(null).value(null),r=av,t=[1,1],u=!1;return i.separation=function(n){return arguments.length?(r=n,i):r},i.size=function(n){return arguments.length?(u=null==(t=n),i):u?null:t},i.nodeSize=function(n){return arguments.length?(u=null!=(t=n),i):u?t:null},fr(i,f)},n.layout.treemap=function(){function o(n,t){for(var r,i,u=-1,f=n.length;++u<f;)i=(r=n[u]).value*(0>t?0:t),r.area=isNaN(i)||0>=i?0:i}function a(n){var u=n.children;if(u&&u.length){var l,v,y,r=c(n),t=[],f=u.slice(),h=1/0,e="slice"===i?r.dx:"dice"===i?r.dy:"slice-dice"===i?1&n.depth?r.dy:r.dx:Math.min(r.dx,r.dy);for(o(f,r.dx*r.dy/n.value),t.area=0;(y=f.length)>0;)t.push(l=f[y-1]),t.area+=l.area,"squarify"!==i||(v=p(t,e))<=h?(f.pop(),h=v):(t.area-=t.pop().area,s(t,e,r,!1),e=Math.min(r.dx,r.dy),t.length=t.area=0,h=1/0);t.length&&(s(t,e,r,!0),t.length=t.area=0),u.forEach(a)}}function v(n){var u=n.children;if(u&&u.length){var i,r=c(n),f=u.slice(),t=[];for(o(f,r.dx*r.dy/n.value),t.area=0;i=f.pop();)t.push(i),t.area+=i.area,null!=i.z&&(s(t,i.z?r.dx:r.dy,r,!f.length),t.length=t.area=0);u.forEach(v)}}function p(n,t){for(var i,r=n.area,u=0,f=1/0,o=-1,s=n.length;++o<s;)(i=n[o].area)&&(f>i&&(f=i),i>u&&(u=i));return r*=r,t*=t,r?Math.max(t*u*e/r,r/(t*f*e)):1/0}function s(n,t,i,r){var f,h=-1,c=n.length,o=i.x,s=i.y,e=t?u(n.area/t):0;if(t==i.dx){for((r||e>i.dy)&&(e=i.dy);++h<c;)f=n[h],f.x=o,f.y=s,f.dy=e,o+=f.dx=Math.min(i.x+i.dx-o,e?u(f.area/e):0);f.z=!0,f.dx+=i.x+i.dx-o,i.y+=e,i.dy-=e}else{for((r||e>i.dx)&&(e=i.dx);++h<c;)f=n[h],f.x=o,f.y=s,f.dx=e,s+=f.dy=Math.min(i.y+i.dy-s,e?u(f.area/e):0);f.z=!1,f.dy+=i.y+i.dy-s,i.x+=e,i.dx-=e}}function t(n){var i=r||h(n),t=i[0];return t.x=0,t.y=0,t.dx=f[0],t.dy=f[1],r&&h.revalue(t),o([t],t.dx*t.dy/t.value),(r?v:a)(t),l&&(r=i),i}var r,h=n.layout.hierarchy(),u=Math.round,f=[1,1],y=null,c=fs,l=!1,i="squarify",e=.5*(1+Math.sqrt(5));return t.size=function(n){return arguments.length?(f=n,t):f},t.padding=function(n){function u(i){var r=n.call(t,i,i.depth);return null==r?fs(i):gv(i,"number"==typeof r?[r,r,r,r]:r)}function i(t){return gv(t,n)}if(!arguments.length)return y;var r;return c=null==(y=n)?fs:"function"==(r=typeof n)?u:"number"===r?(n=[n,n,n,n],i):i,t},t.round=function(n){return arguments.length?(u=n?Math.round:Number,t):u!=Number},t.sticky=function(n){return arguments.length?(l=n,r=null,t):l},t.ratio=function(n){return arguments.length?(e=n,t):e},t.mode=function(n){return arguments.length?(i=n+"",t):i},fr(t,h)},n.random={normal:function(n,t){var i=arguments.length;return 2>i&&(t=1),1>i&&(n=0),function(){var r,u,i;do r=2*Math.random()-1,u=2*Math.random()-1,i=r*r+u*u;while(!i||i>1);return n+t*r*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var t=n.random.normal.apply(n,arguments);return function(){return Math.exp(t())}},irwinHall:function(n){return function(){for(var t=0,i=0;n>i;i++)t+=Math.random();return t/n}}},n.scale={},bp={floor:a,ceil:a},n.scale.linear=function(){return ny([0,1],[0,1],ei,!1)},n.scale.log=function(){return iy(n.scale.linear().domain([0,1]),10,!0,[1,10])},bh=n.format(".0e"),kp={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}},n.scale.pow=function(){return ry(n.scale.linear(),1,[0,1])},n.scale.sqrt=function(){return n.scale.pow().exponent(.5)},n.scale.ordinal=function(){return uy([],{t:"range",a:[[]]})},n.scale.category10=function(){return n.scale.ordinal().range(oit)},n.scale.category20=function(){return n.scale.ordinal().range(sit)},n.scale.category20b=function(){return n.scale.ordinal().range(hit)},n.scale.category20c=function(){return n.scale.ordinal().range(cit)};var oit=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(br),sit=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(br),hit=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(br),cit=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(br);n.scale.quantile=function(){return fy([],[])},n.scale.quantize=function(){return ey(0,1,[0,1])},n.scale.threshold=function(){return oy([.5],[0,1])},n.scale.identity=function(){return sy([0,1])},n.svg.arc=function(){function n(){var f=i.apply(this,arguments),n=r.apply(this,arguments),o=u.apply(this,arguments)+ii,s=e.apply(this,arguments)+ii,h=(o>s&&(h=o,o=s,s=h),s-o),c=t>h?"0":"1",l=Math.cos(o),a=Math.sin(o),v=Math.cos(s),y=Math.sin(s);return h>=dp?f?"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+-n+"A"+n+","+n+" 0 1,1 0,"+n+"M0,"+f+"A"+f+","+f+" 0 1,0 0,"+-f+"A"+f+","+f+" 0 1,0 0,"+f+"Z":"M0,"+n+"A"+n+","+n+" 0 1,1 0,"+-n+"A"+n+","+n+" 0 1,1 0,"+n+"Z":f?"M"+n*l+","+n*a+"A"+n+","+n+" 0 "+c+",1 "+n*v+","+n*y+"L"+f*v+","+f*y+"A"+f+","+f+" 0 "+c+",0 "+f*l+","+f*a+"Z":"M"+n*l+","+n*a+"A"+n+","+n+" 0 "+c+",1 "+n*v+","+n*y+"L0,0Z"}var i=fn,r=en,u=hy,e=cy;return n.innerRadius=function(t){return arguments.length?(i=f(t),n):i},n.outerRadius=function(t){return arguments.length?(r=f(t),n):r},n.startAngle=function(t){return arguments.length?(u=f(t),n):u},n.endAngle=function(t){return arguments.length?(e=f(t),n):e},n.centroid=function(){var n=(i.apply(this,arguments)+r.apply(this,arguments))/2,t=(u.apply(this,arguments)+e.apply(this,arguments))/2+ii;return[Math.cos(t)*n,Math.sin(t)*n]},n},ii=-t/2,dp=2*t-1e-6,n.svg.line.radial=function(){var n=pa(ly);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},ao.reverse=vo,vo.reverse=ao,n.svg.area=function(){return ay(a)},n.svg.area.radial=function(){var n=ay(ly);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},n.svg.chord=function(){function n(n,t){var f=h(this,r,n,t),e=h(this,u,n,t);return"M"+f.p0+c(f.r,f.p1,f.a1-f.a0)+(l(f,e)?i(f.r,f.p1,f.r,f.p0):i(f.r,f.p1,e.r,e.p0)+c(e.r,e.p1,e.a1-e.a0)+i(e.r,e.p1,f.r,f.p0))+"Z"}function h(n,t,i,r){var f=t.call(n,i,r),u=e.call(n,f,r),h=o.call(n,f,r)+ii,c=s.call(n,f,r)+ii;return{r:u,a0:h,a1:c,p0:[u*Math.cos(h),u*Math.sin(h)],p1:[u*Math.cos(c),u*Math.sin(c)]}}function l(n,t){return n.a0==t.a0&&n.a1==t.a1}function c(n,i,r){return"A"+n+","+n+" 0 "+ +(r>t)+",1 "+i}function i(n,t,i,r){return"Q 0,0 "+r}var r=ho,u=co,e=on,o=hy,s=cy;return n.radius=function(t){return arguments.length?(e=f(t),n):e},n.source=function(t){return arguments.length?(r=f(t),n):r},n.target=function(t){return arguments.length?(u=f(t),n):u},n.startAngle=function(t){return arguments.length?(o=f(t),n):o},n.endAngle=function(t){return arguments.length?(s=f(t),n):s},n},n.svg.diagonal=function(){function n(n,u){var e=t.call(this,n,u),o=i.call(this,n,u),s=(e.y+o.y)/2,f=[e,{x:e.x,y:s},{x:o.x,y:s},o];return f=f.map(r),"M"+f[0]+"C"+f[1]+" "+f[2]+" "+f[3]}var t=ho,i=co,r=vy;return n.source=function(i){return arguments.length?(t=f(i),n):t},n.target=function(t){return arguments.length?(i=f(t),n):i},n.projection=function(t){return arguments.length?(r=t,n):r},n},n.svg.diagonal.radial=function(){var t=n.svg.diagonal(),i=vy,r=t.projection;return t.projection=function(n){return arguments.length?r(sn(i=n)):i},t},n.svg.symbol=function(){function n(n,r){return(kh.get(t.call(this,n,r))||yy)(i.call(this,n,r))}var t=cn,i=hn;return n.type=function(i){return arguments.length?(t=f(i),n):t},n.size=function(t){return arguments.length?(i=f(t),n):i},n},kh=n.map({circle:yy,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*gp)),i=t*gp;return"M0,"+-t+"L"+i+",0 0,"+t+" "+-i+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/kf),i=t*kf/2;return"M0,"+i+"L"+t+","+-i+" "+-t+","+-i+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/kf),i=t*kf/2;return"M0,"+-i+"L"+t+","+i+" "+-t+","+i+"Z"}}),n.svg.symbolTypes=kh.keys();var vr,bf,kf=Math.sqrt(3),gp=Math.tan(30*r),h=[],nw=0;h.call=u.call,h.empty=u.empty,h.node=u.node,h.size=u.size,n.transition=function(n){return arguments.length?vr?n.transition():n:th.transition()},n.transition.prototype=h,h.select=function(n){var f,i,t,e=this.id,o=[],r,s;for(n=oe(n),r=-1,s=this.length;++r<s;){o.push(f=[]);for(var h=this[r],u=-1,c=h.length;++u<c;)(t=h[u])&&(i=n.call(t,t.__data__,u,r))?("__data__"in t&&(i.__data__=t.__data__),hu(i,u,e,t.__transition__[e]),f.push(i)):f.push(null)}return er(o,e)},h.selectAll=function(n){var s,u,t,f,h,e=this.id,c=[],i,l,r,v;for(n=sc(n),i=-1,l=this.length;++i<l;)for(var a=this[i],o=-1,y=a.length;++o<y;)if(t=a[o])for(h=t.__transition__[e],u=n.call(t,t.__data__,o,i),c.push(s=[]),r=-1,v=u.length;++r<v;)(f=u[r])&&hu(f,r,e,h),s.push(f);return er(c,e)},h.filter=function(n){var u,o,t,f=[],i,e;for("function"!=typeof n&&(n=wc(n)),i=0,e=this.length;e>i;i++){f.push(u=[]);for(var o=this[i],r=0,s=o.length;s>r;r++)(t=o[r])&&n.call(t,t.__data__,r)&&u.push(t)}return er(f,this.id)},h.tween=function(n,t){var i=this.id;return arguments.length<2?this.node().__transition__[i].tween.get(n):yt(this,null==t?function(t){t.__transition__[i].tween.remove(n)}:function(r){r.__transition__[i].tween.set(n,t)})},h.attr=function(t,i){function f(){this.removeAttribute(r)}function e(){this.removeAttributeNS(r.space,r.local)}function o(n){return null==n?f:(n+="",function(){var t,i=this.getAttribute(r);return i!==n&&(t=u(i,n),function(n){this.setAttribute(r,t(n))})})}function s(n){return null==n?e:(n+="",function(){var t,i=this.getAttributeNS(r.space,r.local);return i!==n&&(t=u(i,n),function(n){this.setAttributeNS(r.space,r.local,t(n))})})}if(arguments.length<2){for(i in t)this.attr(i,t[i]);return this}var u="transform"==t?sv:ei,r=n.ns.qualify(t);return ls(this,"attr."+t,i,r.local?s:o)},h.attrTween=function(t,i){function u(n,t){var u=i.call(this,n,t,this.getAttribute(r));return u&&function(n){this.setAttribute(r,u(n))}}function f(n,t){var u=i.call(this,n,t,this.getAttributeNS(r.space,r.local));return u&&function(n){this.setAttributeNS(r.space,r.local,u(n))}}var r=n.ns.qualify(t);return this.tween("attr."+t,r.local?f:u)},h.style=function(n,t,i){function u(){this.style.removeProperty(n)}function f(t){return null==t?u:(t+="",function(){var r,u=c.getComputedStyle(this,null).getPropertyValue(n);return u!==t&&(r=ei(u,t),function(t){this.style.setProperty(n,r(t),i)})})}var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t="");for(i in n)this.style(i,n[i],t);return this}i=""}return ls(this,"style."+n,t,f)},h.styleTween=function(n,t,i){function r(r,u){var f=t.call(this,r,u,c.getComputedStyle(this,null).getPropertyValue(n));return f&&function(t){this.style.setProperty(n,f(t),i)}}return arguments.length<3&&(i=""),this.tween("style."+n,r)},h.text=function(n){return ls(this,"text",n,ln)},h.remove=function(){return this.each("end.transition",function(){var n;!this.__transition__&&(n=this.parentNode)&&n.removeChild(this)})},h.ease=function(t){var i=this.id;return arguments.length<1?this.node().__transition__[i].ease:("function"!=typeof t&&(t=n.ease.apply(n,arguments)),yt(this,function(n){n.__transition__[i].ease=t}))},h.delay=function(n){var t=this.id;return yt(this,"function"==typeof n?function(i,r,u){i.__transition__[t].delay=0|n.call(i,i.__data__,r,u)}:(n|=0,function(i){i.__transition__[t].delay=n}))},h.duration=function(n){var t=this.id;return yt(this,"function"==typeof n?function(i,r,u){i.__transition__[t].duration=Math.max(1,0|n.call(i,i.__data__,r,u))}:(n=Math.max(1,0|n),function(i){i.__transition__[t].duration=n}))},h.each=function(t,i){var r=this.id,u,f;return arguments.length<2?(u=bf,f=vr,vr=r,yt(this,function(n,i,u){bf=n.__transition__[r],t.call(n,n.__data__,i,u)}),bf=u,vr=f):yt(this,function(u){var f=u.__transition__[r];(f.event||(f.event=n.dispatch("start","end"))).on(t,i)}),this},h.transition=function(){for(var u,o,n,t,s=this.id,f=++nw,e=[],r=0,h=this.length;h>r;r++){e.push(u=[]);for(var o=this[r],i=0,c=o.length;c>i;i++)(n=o[i])&&(t=Object.create(n.__transition__[s]),t.delay+=t.duration,hu(n,i,f,t)),u.push(n)}return er(e,f)},n.svg.axis=function(){function i(i){i.each(function(){var i,ut=n.select(this),ot=null==h?r.ticks?r.ticks.apply(r,s):r.domain():h,lt=null==o?r.tickFormat?r.tickFormat.apply(r,s):String:o,at=an(r,ot,l),ft=ut.selectAll(".tick.minor").data(at,String),p=ft.enter().insert("line",".tick").attr("class","tick minor").style("opacity",1e-6),vt=n.transition(ft.exit()).style("opacity",1e-6).remove(),w=n.transition(ft).style("opacity",1),b=ut.selectAll(".tick.major").data(ot,String),y=b.enter().insert("g",".domain").attr("class","tick major").style("opacity",1e-6),yt=n.transition(b.exit()).style("opacity",1e-6).remove(),k=n.transition(b).style("opacity",1),a=ou(r),st=ut.selectAll(".domain").data([0]),d=(st.enter().append("path").attr("class","domain"),n.transition(st)),v=r.copy(),ht=this.__chart__||v,ct,et;this.__chart__=v,y.append("line"),y.append("text");var g=y.select("line"),nt=k.select("line"),tt=b.select("text").text(lt),it=y.select("text"),rt=k.select("text");switch(c){case"bottom":i=py,p.attr("y2",f),w.attr("x2",0).attr("y2",f),g.attr("y2",t),it.attr("y",Math.max(t,0)+u),nt.attr("x2",0).attr("y2",t),rt.attr("x",0).attr("y",Math.max(t,0)+u),tt.attr("dy",".71em").style("text-anchor","middle"),d.attr("d","M"+a[0]+","+e+"V0H"+a[1]+"V"+e);break;case"top":i=py,p.attr("y2",-f),w.attr("x2",0).attr("y2",-f),g.attr("y2",-t),it.attr("y",-(Math.max(t,0)+u)),nt.attr("x2",0).attr("y2",-t),rt.attr("x",0).attr("y",-(Math.max(t,0)+u)),tt.attr("dy","0em").style("text-anchor","middle"),d.attr("d","M"+a[0]+","+-e+"V0H"+a[1]+"V"+-e);break;case"left":i=wy,p.attr("x2",-f),w.attr("x2",-f).attr("y2",0),g.attr("x2",-t),it.attr("x",-(Math.max(t,0)+u)),nt.attr("x2",-t).attr("y2",0),rt.attr("x",-(Math.max(t,0)+u)).attr("y",0),tt.attr("dy",".32em").style("text-anchor","end"),d.attr("d","M"+-e+","+a[0]+"H0V"+a[1]+"H"+-e);break;case"right":i=wy,p.attr("x2",f),w.attr("x2",f).attr("y2",0),g.attr("x2",t),it.attr("x",Math.max(t,0)+u),nt.attr("x2",t).attr("y2",0),rt.attr("x",Math.max(t,0)+u).attr("y",0),tt.attr("dy",".32em").style("text-anchor","start"),d.attr("d","M"+e+","+a[0]+"H0V"+a[1]+"H"+e)}r.rangeBand?(ct=v.rangeBand()/2,et=function(n){return v(n)+ct},y.call(i,et),k.call(i,et)):(y.call(i,ht),k.call(i,v),yt.call(i,v),p.call(i,ht),w.call(i,v),vt.call(i,v))})}var o,r=n.scale.linear(),c=dh,t=6,f=6,e=6,u=3,s=[10],h=null,l=0;return i.scale=function(n){return arguments.length?(r=n,i):r},i.orient=function(n){return arguments.length?(c=n in tw?n+"":dh,i):c},i.ticks=function(){return arguments.length?(s=arguments,i):s},i.tickValues=function(n){return arguments.length?(h=n,i):h},i.tickFormat=function(n){return arguments.length?(o=n,i):o},i.tickSize=function(n,r){if(!arguments.length)return t;var u=arguments.length-1;return t=+n,f=u>1?+r:t,e=u>0?+arguments[u]:t,i},i.tickPadding=function(n){return arguments.length?(u=+n,i):u},i.tickSubdivide=function(n){return arguments.length?(l=+n,i):l},i},dh="bottom",tw={top:1,right:1,bottom:1,left:1},n.svg.brush=function(){function u(t){t.each(function(){var t,f=n.select(this),e=f.selectAll(".background").data([0]),v=f.selectAll(".extent").data([0]),c=f.selectAll(".resize").data(o,String);f.style("pointer-events","all").on("mousedown.brush",a).on("touchstart.brush",a),e.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),v.enter().append("rect").attr("class","extent").style("cursor","move"),c.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return iw[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),c.style("display",u.empty()?"none":null),c.exit().remove(),i&&(t=ou(i),e.attr("x",t[0]).attr("width",t[1]-t[0]),h(f)),r&&(t=ou(r),e.attr("y",t[0]).attr("height",t[1]-t[0]),l(f)),s(f)})}function s(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+t[+/e$/.test(n)][0]+","+t[+/^s/.test(n)][1]+")"})}function h(n){n.select(".extent").attr("x",t[0][0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",t[1][0]-t[0][0])}function l(n){n.select(".extent").attr("y",t[0][1]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",t[1][1]-t[0][1])}function a(){function ut(){var t=n.event.changedTouches;return t?n.touches(d,t)[0]:n.mouse(d)}function ot(){32==n.event.keyCode&&(y||(a=null,o[0]-=t[1][0],o[1]-=t[1][1],y=2),at())}function st(){32==n.event.keyCode&&2==y&&(o[0]+=t[1][0],o[1]+=t[1][1],y=0,at())}function b(){var u=ut(),f=!1;k&&(u[0]+=k[0],u[1]+=k[1]),y||(n.event.altKey?(a||(a=[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]),o[0]=t[+(u[0]<a[0])][0],o[1]=t[+(u[1]<a[1])][1]):a=null),ht&&ft(u,i,0)&&(h(p),f=!0),ct&&ft(u,r,1)&&(l(p),f=!0),f&&(s(p),nt({type:"brush",mode:y?"move":"resize"}))}function ft(n,i,r){var u,h,v=ou(i),c=v[0],l=v[1],s=o[r],p=t[1][r]-t[0][r];return y&&(c-=s,l-=p+s),u=e[r]?Math.max(c,Math.min(l,n[r])):n[r],y?h=(u+=s)+p:(a&&(s=Math.max(c,Math.min(l,2*a[r]-u))),u>s?(h=u,u=s):h=s),t[0][r]!==u||t[1][r]!==h?(f=null,t[0][r]=u,t[1][r]=h,!0):void 0}function et(){b(),p.style("pointer-events","all").selectAll(".resize").style("display",u.empty()?"none":null),n.select("body").style("cursor",null),tt.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),lt(),nt({type:"brushend"})}var a,k,d=this,g=n.select(n.event.target),nt=v.of(d,arguments),p=n.select(d),w=g.datum(),ht=!/^(n|s)$/.test(w)&&i,ct=!/^(e|w)$/.test(w)&&r,y=g.classed("extent"),lt=yr(),o=ut(),tt=n.select(c).on("keydown.brush",ot).on("keyup.brush",st),it,rt;(n.event.changedTouches?tt.on("touchmove.brush",b).on("touchend.brush",et):tt.on("mousemove.brush",b).on("mouseup.brush",et),y)?(o[0]=t[0][0]-o[0],o[1]=t[0][1]-o[1]):w?(it=+/w$/.test(w),rt=+/^n/.test(w),k=[t[1-it][0]-o[0],t[1-rt][1]-o[1]],o[0]=t[it][0],o[1]=t[rt][1]):n.event.altKey&&(a=o.slice()),p.style("pointer-events","none").selectAll(".resize").style("display",null),n.select("body").style("cursor",g.style("cursor")),nt({type:"brushstart"}),b()}var f,v=ee(u,"brushstart","brush","brushend"),i=null,r=null,o=df[0],t=[[0,0],[0,0]],e=[!0,!0];return u.x=function(n){return arguments.length?(i=n,o=df[!i<<1|!r],u):i},u.y=function(n){return arguments.length?(r=n,o=df[!i<<1|!r],u):r},u.clamp=function(n){return arguments.length?(i&&r?e=[!!n[0],!!n[1]]:(i||r)&&(e[+!i]=!!n),u):i&&r?e:i||r?e[+!i]:null},u.extent=function(n){var e,o,s,h,c;return arguments.length?(f=[[0,0],[0,0]],i&&(e=n[0],o=n[1],r&&(e=e[0],o=o[0]),f[0][0]=e,f[1][0]=o,i.invert&&(e=i(e),o=i(o)),e>o&&(c=e,e=o,o=c),t[0][0]=0|e,t[1][0]=0|o),r&&(s=n[0],h=n[1],i&&(s=s[1],h=h[1]),f[0][1]=s,f[1][1]=h,r.invert&&(s=r(s),h=r(h)),s>h&&(c=s,s=h,h=c),t[0][1]=0|s,t[1][1]=0|h),u):(n=f||t,i&&(e=n[0][0],o=n[1][0],f||(e=t[0][0],o=t[1][0],i.invert&&(e=i.invert(e),o=i.invert(o)),e>o&&(c=e,e=o,o=c))),r&&(s=n[0][1],h=n[1][1],f||(s=t[0][1],h=t[1][1],r.invert&&(s=r.invert(s),h=r.invert(h)),s>h&&(c=s,s=h,h=c))),i&&r?[[e,s],[o,h]]:i?[e,o]:r&&[s,h])},u.clear=function(){return f=null,t[0][0]=t[0][1]=t[1][0]=t[1][1]=0,u},u.empty=function(){return i&&t[0][0]===t[1][0]||r&&t[0][1]===t[1][1]},n.rebind(u,v,"on")},iw={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},df=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],n.time={},l=Date,rw=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],si.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){lt.setUTCDate.apply(this._,arguments)},setDay:function(){lt.setUTCDay.apply(this._,arguments)},setFullYear:function(){lt.setUTCFullYear.apply(this._,arguments)},setHours:function(){lt.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){lt.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){lt.setUTCMinutes.apply(this._,arguments)},setMonth:function(){lt.setUTCMonth.apply(this._,arguments)},setSeconds:function(){lt.setUTCSeconds.apply(this._,arguments)},setTime:function(){lt.setTime.apply(this._,arguments)}};var lt=Date.prototype,lit="%a %b %e %X %Y",ait="%m/%d/%Y",vit="%H:%M:%S",gh=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],nc=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],tc=["January","February","March","April","May","June","July","August","September","October","November","December"],ic=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.time.year=hi(function(t){return t=n.time.day(t),t.setMonth(0,1),t},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),n.time.years=n.time.year.range,n.time.years.utc=n.time.year.utc.range,n.time.day=hi(function(n){var t=new l(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),n.time.days=n.time.day.range,n.time.days.utc=n.time.day.utc.range,n.time.dayOfYear=function(t){var i=n.time.year(t);return Math.floor((t-i-6e4*(t.getTimezoneOffset()-i.getTimezoneOffset()))/864e5)},rw.forEach(function(t,i){t=t.toLowerCase(),i=7-i;var r=n.time[t]=hi(function(t){return(t=n.time.day(t)).setDate(t.getDate()-(t.getDay()+i)%7),t},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(t){var r=n.time.year(t).getDay();return Math.floor((n.time.dayOfYear(t)+(r+i)%7)/7)-(r!==i)});n.time[t+"s"]=r.range,n.time[t+"s"].utc=r.utc.range,n.time[t+"OfYear"]=function(t){var r=n.time.year(t).getDay();return Math.floor((n.time.dayOfYear(t)+(r+i)%7)/7)}}),n.time.week=n.time.sunday,n.time.weeks=n.time.sunday.range,n.time.weeks.utc=n.time.sunday.utc.range,n.time.weekOfYear=n.time.sundayOfYear,n.time.format=function(n){function t(t){for(var u,e,s,f=[],r=-1,o=0;++r<i;)37===n.charCodeAt(r)&&(f.push(n.substring(o,r)),null!=(e=kit[u=n.charAt(++r)])&&(u=n.charAt(++r)),(s=gf[u])&&(u=s(t,null==e?"e"===u?" ":"0":e)),f.push(u),o=r+1);return f.push(n.substring(o,r)),f.join("")}var i=n.length;return t.parse=function(t){var i={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},u=lu(i,n,t,0),r;return u!=t.length?null:("p"in i&&(i.H=i.H%12+12*i.p),r=new l,"j"in i?r.setFullYear(i.y,0,i.j):"w"in i&&("W"in i||"U"in i)?(r.setFullYear(i.y,0,1),r.setFullYear(i.y,0,"W"in i?(i.w+6)%7+7*i.W-(r.getDay()+5)%7:i.w+7*i.U-(r.getDay()+6)%7)):r.setFullYear(i.y,i.m,i.d),r.setHours(i.H,i.M,i.S,i.L),r)},t.toString=function(){return n},t};var uw=au(gh),yit=vu(gh),fw=au(nc),pit=vu(nc),ew=au(tc),wit=vu(tc),ow=au(ic),bit=vu(ic),sw=/^%/,kit={"-":"",_:" ",0:"0"},gf={a:function(n){return nc[n.getDay()]},A:function(n){return gh[n.getDay()]},b:function(n){return ic[n.getMonth()]},B:function(n){return tc[n.getMonth()]},c:n.time.format(lit),d:function(n,t){return v(n.getDate(),t,2)},e:function(n,t){return v(n.getDate(),t,2)},H:function(n,t){return v(n.getHours(),t,2)},I:function(n,t){return v(n.getHours()%12||12,t,2)},j:function(t,i){return v(1+n.time.dayOfYear(t),i,3)},L:function(n,t){return v(n.getMilliseconds(),t,3)},m:function(n,t){return v(n.getMonth()+1,t,2)},M:function(n,t){return v(n.getMinutes(),t,2)},p:function(n){return n.getHours()>=12?"PM":"AM"},S:function(n,t){return v(n.getSeconds(),t,2)},U:function(t,i){return v(n.time.sundayOfYear(t),i,2)},w:function(n){return n.getDay()},W:function(t,i){return v(n.time.mondayOfYear(t),i,2)},x:n.time.format(ait),X:n.time.format(vit),y:function(n,t){return v(n.getFullYear()%100,t,2)},Y:function(n,t){return v(n.getFullYear()%1e4,t,4)},Z:ltt,"%":function(){return"%"}},dit={a:vn,A:yn,b:kn,B:dn,c:gn,d:by,e:by,H:ky,I:ky,j:ett,L:htt,m:ftt,M:ott,p:ctt,S:stt,U:wn,w:pn,W:bn,x:ntt,X:ttt,y:rtt,Y:itt,"%":att},o=/^\s*\d+/,git=n.map({am:0,pm:1});n.time.format.utc=function(t){function i(n){try{l=si;var t=new l;return t._=n,r(t)}finally{l=Date}}var r=n.time.format(t);return i.parse=function(n){try{l=si;var t=r.parse(n);return t&&t._}finally{l=Date}},i.toString=r.toString,i},rc=n.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ"),n.time.format.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?as:rc,as.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},as.toString=rc.toString,n.time.second=hi(function(n){return new l(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),n.time.seconds=n.time.second.range,n.time.seconds.utc=n.time.second.utc.range,n.time.minute=hi(function(n){return new l(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),n.time.minutes=n.time.minute.range,n.time.minutes.utc=n.time.minute.utc.range,n.time.hour=hi(function(n){var t=n.getTimezoneOffset()/60;return new l(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),n.time.hours=n.time.hour.range,n.time.hours.utc=n.time.hour.utc.range,n.time.month=hi(function(t){return t=n.time.day(t),t.setDate(1),t},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),n.time.months=n.time.month.range,n.time.months.utc=n.time.month.utc.range;var ne=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],uc=[[n.time.second,1],[n.time.second,5],[n.time.second,15],[n.time.second,30],[n.time.minute,1],[n.time.minute,5],[n.time.minute,15],[n.time.minute,30],[n.time.hour,1],[n.time.hour,3],[n.time.hour,6],[n.time.hour,12],[n.time.day,1],[n.time.day,2],[n.time.week,1],[n.time.month,1],[n.time.month,3],[n.time.year,1]],nrt=[[n.time.format("%Y"),tr],[n.time.format("%B"),function(n){return n.getMonth()}],[n.time.format("%b %d"),function(n){return 1!=n.getDate()}],[n.time.format("%a %d"),function(n){return n.getDay()&&1!=n.getDate()}],[n.time.format("%I %p"),function(n){return n.getHours()}],[n.time.format("%I:%M"),function(n){return n.getMinutes()}],[n.time.format(":%S"),function(n){return n.getSeconds()}],[n.time.format(".%L"),function(n){return n.getMilliseconds()}]],hw=n.scale.linear(),trt=dy(nrt);uc.year=function(n,t){return hw.domain(n.map(vtt)).ticks(t).map(ps)},n.time.scale=function(){return vs(n.scale.linear(),uc,trt)};var cw=uc.map(function(n){return[n[0].utc,n[1]]}),irt=[[n.time.format.utc("%Y"),tr],[n.time.format.utc("%B"),function(n){return n.getUTCMonth()}],[n.time.format.utc("%b %d"),function(n){return 1!=n.getUTCDate()}],[n.time.format.utc("%a %d"),function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],[n.time.format.utc("%I %p"),function(n){return n.getUTCHours()}],[n.time.format.utc("%I:%M"),function(n){return n.getUTCMinutes()}],[n.time.format.utc(":%S"),function(n){return n.getUTCSeconds()}],[n.time.format.utc(".%L"),function(n){return n.getUTCMilliseconds()}]],rrt=dy(irt);return cw.year=function(n,t){return hw.domain(n.map(ytt)).ticks(t).map(ws)},n.time.scale.utc=function(){return vs(n.scale.linear(),cw,rrt)},n.text=ke(function(n){return n.responseText}),n.json=function(n,t){return de(n,"application/json",ptt,t)},n.html=function(n,t){return de(n,"text/html",wtt,t)},n.xml=ke(function(n){return n.responseXML}),n}(),!function(n){function g(n,t){return function(i){return r(n.call(this,i),t)}}function pt(n,t){return function(i){return this.lang().ordinal(n.call(this,i),t)}}function nt(){}function h(n){c(this,n)}function v(n){var t=n.years||n.year||n.y||0,i=n.months||n.month||n.M||0,r=n.weeks||n.week||n.w||0,u=n.days||n.day||n.d||0,f=n.hours||n.hour||n.h||0,e=n.minutes||n.minute||n.m||0,o=n.seconds||n.second||n.s||0,s=n.milliseconds||n.millisecond||n.ms||0;this._input=n,this._milliseconds=s+1e3*o+6e4*e+36e5*f,this._days=u+7*r,this._months=i+12*t,this._data={},this._bubble()}function c(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function f(n){return 0>n?Math.ceil(n):Math.floor(n)}function r(n,t){for(var i=n+"";i.length<t;)i="0"+i;return i}function y(n,i,r,u){var s,h,o=i._milliseconds,f=i._days,e=i._months;o&&n._d.setTime(+n._d+o*r),(f||e)&&(s=n.minute(),h=n.hour()),f&&n.date(n.date()+f*r),e&&n.month(n.month()+e*r),o&&!u&&t.updateOffset(n),(f||e)&&(n.minute(s),n.hour(h))}function tt(n){return"[object Array]"===Object.prototype.toString.call(n)}function it(n,t){for(var u=Math.min(n.length,t.length),f=Math.abs(n.length-t.length),r=0,i=0;u>i;i++)~~n[i]!=~~t[i]&&r++;return r+f}function l(n){return n?gi[n]||n.toLowerCase().replace(/(.)s$/,"$1"):n}function wt(n,t){return t.abbr=n,s[n]||(s[n]=new nt),s[n].set(t),s[n]}function e(n){if(!n)return t.fn._lang;if(!s[n]&&ht)try{require("./lang/"+n)}catch(i){return t.fn._lang}return s[n]}function bt(n){return n.match(/\[.*\]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function kt(n){for(var i=n.match(ct),t=0,r=i.length;r>t;t++)i[t]=u[i[t]]?u[i[t]]:bt(i[t]);return function(u){var f="";for(t=0;r>t;t++)f+=i[t]instanceof Function?i[t].call(u,n):i[t];return f}}function rt(n,t){function i(t){return n.lang().longDateFormat(t)||t}for(var r=5;r--&&lt.test(t);)t=t.replace(lt,i);return d[t]||(d[t]=kt(t)),d[t](n)}function dt(n,t){switch(n){case"DDDD":return li;case"YYYY":return ai;case"YYYYY":return vi;case"S":case"SS":case"SSS":case"DDD":return ci;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return yi;case"a":case"A":return e(t._l)._meridiemParse;case"X":return wi;case"Z":case"ZZ":return w;case"T":return pi;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return hi;default:return new RegExp(n.replace("\\",""))}}function ut(n){var r=(w.exec(n)||[])[0],t=(r+"").match(di)||["-",0,0],i=+(60*t[1])+~~t[2];return"+"===t[0]?-i:i}function gt(n,t,i){var u,r=i._a;switch(n){case"M":case"MM":r[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":u=e(i._l).monthsParse(t),null!=u?r[1]=u:i._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(r[2]=~~t);break;case"YY":r[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":r[0]=~~t;break;case"a":case"A":i._isPm=e(i._l).isPM(t);break;case"H":case"HH":case"h":case"hh":r[3]=~~t;break;case"m":case"mm":r[4]=~~t;break;case"s":case"ss":r[5]=~~t;break;case"S":case"SS":case"SSS":r[6]=~~(1e3*("0."+t));break;case"X":i._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=ut(t)}null==t&&(i._isValid=!1)}function ft(n){var i,r,t=[];if(!n._d){for(i=0;7>i;i++)n._a[i]=t[i]=null==n._a[i]?2===i?1:0:n._a[i];t[3]+=~~((n._tzm||0)/60),t[4]+=~~((n._tzm||0)%60),r=new Date(0),n._useUTC?(r.setUTCFullYear(t[0],t[1],t[2]),r.setUTCHours(t[3],t[4],t[5],t[6])):(r.setFullYear(t[0],t[1],t[2]),r.setHours(t[3],t[4],t[5],t[6])),n._d=r}}function p(n){var t,r,f=n._f.match(ct),i=n._i;for(n._a=[],t=0;t<f.length;t++)r=(dt(f[t],n).exec(i)||[])[0],r&&(i=i.slice(i.indexOf(r)+r.length)),u[f[t]]&&gt(f[t],r,n);i&&(n._il=i),n._isPm&&n._a[3]<12&&(n._a[3]+=12),n._isPm===!1&&12===n._a[3]&&(n._a[3]=0),ft(n)}function ni(n){for(var t,i,f,r,e=99,u=0;u<n._f.length;u++)t=c({},n),t._f=n._f[u],p(t),i=new h(t),r=it(t._a,i.toArray()),i._il&&(r+=i._il.length),e>r&&(e=r,f=i);c(n,f)}function ti(n){var t,i=n._i,r=bi.exec(i);if(r){for(n._f="YYYY-MM-DD"+(r[2]||" "),t=0;4>t;t++)if(at[t][1].exec(i)){n._f+=at[t][0];break}w.exec(i)&&(n._f+=" Z"),p(n)}else n._d=new Date(i)}function ii(t){var i=t._i,r=oi.exec(i);i===n?t._d=new Date:r?t._d=new Date(+r[1]):"string"==typeof i?ti(t):tt(i)?(t._a=i.slice(0),ft(t)):t._d=i instanceof Date?new Date(+i):new Date(i)}function ri(n,t,i,r,u){return u.relativeTime(t||1,!!i,n,r)}function ui(n,t,i){var s=o(Math.abs(n)/1e3),u=o(s/60),f=o(u/60),r=o(f/24),h=o(r/365),e=45>s&&["s",s]||1===u&&["m"]||45>u&&["mm",u]||1===f&&["h"]||22>f&&["hh",f]||1===r&&["d"]||25>=r&&["dd",r]||45>=r&&["M"]||345>r&&["MM",o(r/30)]||1===h&&["y"]||["yy",h];return e[2]=t,e[3]=n>0,e[4]=i,ri.apply({},e)}function a(n,i,r){var f,e=r-i,u=r-n.day();return u>e&&(u-=7),e-7>u&&(u+=7),f=t(n).add("d",u),{week:Math.ceil(f.dayOfYear()/7),year:f.year()}}function et(n){var i=n._i,r=n._f;return null===i||""===i?null:("string"==typeof i&&(n._i=i=e().preparse(i)),t.isMoment(i)?(n=c({},i),n._d=new Date(+i._d)):r?tt(r)?ni(n):p(n):ii(n),new h(n))}function ot(n,i){t.fn[n]=t.fn[n+"s"]=function(n){var r=this._isUTC?"UTC":"";return null!=n?(this._d["set"+r+i](n),t.updateOffset(this),this):this._d["get"+r+i]()}}function fi(n){t.duration.fn[n]=function(){return this._data[n]}}function st(n,i){t.duration.fn["as"+n]=function(){return+this/i}}for(var t,i,ei="2.1.0",o=Math.round,s={},ht="undefined"!=typeof module&&module.exports,oi=/^\/?Date\((\-?\d+)/i,si=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,ct=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,lt=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,hi=/\d\d?/,ci=/\d{1,3}/,li=/\d{3}/,ai=/\d{1,4}/,vi=/[+\-]?\d{1,6}/,yi=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,w=/Z|[\+\-]\d\d:?\d\d/i,pi=/T/i,wi=/[\+\-]?\d+(\.\d{1,3})?/,bi=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,ki="YYYY-MM-DDTHH:mm:ssZ",at=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],di=/([\+\-]|\d\d)/gi,b="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),k={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},gi={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},d={},vt="DDD w W M D d".split(" "),yt="M D H h m s w W".split(" "),u={M:function(){return this.month()+1},MMM:function(n){return this.lang().monthsShort(this,n)},MMMM:function(n){return this.lang().months(this,n)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(n){return this.lang().weekdaysMin(this,n)},ddd:function(n){return this.lang().weekdaysShort(this,n)},dddd:function(n){return this.lang().weekdays(this,n)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return r(this.year()%100,2)},YYYY:function(){return r(this.year(),4)},YYYYY:function(){return r(this.year(),5)},gg:function(){return r(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return r(this.weekYear(),5)},GG:function(){return r(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return r(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return r(~~(this.milliseconds()/10),2)},SSS:function(){return r(this.milliseconds(),3)},Z:function(){var n=-this.zone(),t="+";return 0>n&&(n=-n,t="-"),t+r(~~(n/60),2)+":"+r(~~n%60,2)},ZZ:function(){var n=-this.zone(),t="+";return 0>n&&(n=-n,t="-"),t+r(~~(10*n/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};vt.length;)i=vt.pop(),u[i+"o"]=pt(u[i],i);for(;yt.length;)i=yt.pop(),u[i+i]=g(u[i],2);for(u.DDDD=g(u.DDD,3),nt.prototype={set:function(n){var t,i;for(i in n)t=n[i],"function"==typeof t?this[i]=t:this["_"+i]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(n){return this._months[n.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(n){return this._monthsShort[n.month()]},monthsParse:function(n){var i,r,u;for(this._monthsParse||(this._monthsParse=[]),i=0;12>i;i++)if(this._monthsParse[i]||(r=t([2e3,i]),u="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(u.replace(".",""),"i")),this._monthsParse[i].test(n))return i},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(n){return this._weekdays[n.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(n){return this._weekdaysShort[n.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(n){return this._weekdaysMin[n.day()]},weekdaysParse:function(n){var i,r,u;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;7>i;i++)if(this._weekdaysParse[i]||(r=t([2e3,1]).day(i),u="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(u.replace(".",""),"i")),this._weekdaysParse[i].test(n))return i},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(n){var t=this._longDateFormat[n];return!t&&this._longDateFormat[n.toUpperCase()]&&(t=this._longDateFormat[n.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(n){return n.slice(1)}),this._longDateFormat[n]=t),t},isPM:function(n){return"p"===(n+"").toLowerCase()[0]},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(n,t,i){return n>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(n,t){var i=this._calendar[n];return"function"==typeof i?i.apply(t):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(n,t,i,r){var u=this._relativeTime[i];return"function"==typeof u?u(n,t,i,r):u.replace(/%d/i,n)},pastFuture:function(n,t){var i=this._relativeTime[n>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)},ordinal:function(n){return this._ordinal.replace("%d",n)},_ordinal:"%d",preparse:function(n){return n},postformat:function(n){return n},week:function(n){return a(n,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}},t=function(n,t,i){return et({_i:n,_f:t,_l:i,_isUTC:!1})},t.utc=function(n,t,i){return et({_useUTC:!0,_isUTC:!0,_l:i,_i:n,_f:t})},t.unix=function(n){return t(1e3*n)},t.duration=function(n,i){var u,e,o=t.isDuration(n),s="number"==typeof n,f=o?n._input:s?{}:n,r=si.exec(n);return s?i?f[i]=n:f.milliseconds=n:r&&(u="-"===r[1]?-1:1,f={y:0,d:~~r[2]*u,h:~~r[3]*u,m:~~r[4]*u,s:~~r[5]*u,ms:~~r[6]*u}),e=new v(f),o&&n.hasOwnProperty("_lang")&&(e._lang=n._lang),e},t.version=ei,t.defaultFormat=ki,t.updateOffset=function(){},t.lang=function(n,i){return n?(i?wt(n,i):s[n]||e(n),t.duration.fn._lang=t.fn._lang=e(n),void 0):t.fn._lang._abbr},t.langData=function(n){return n&&n._lang&&n._lang._abbr&&(n=n._lang._abbr),e(n)},t.isMoment=function(n){return n instanceof h},t.isDuration=function(n){return n instanceof v},t.fn=h.prototype={clone:function(){return t(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return rt(t(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var n=this;return[n.year(),n.month(),n.date(),n.hours(),n.minutes(),n.seconds(),n.milliseconds()]},isValid:function(){return null==this._isValid&&(this._isValid=this._a?!it(this._a,(this._isUTC?t.utc(this._a):t(this._a)).toArray()):!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(n){var i=rt(this,n||t.defaultFormat);return this.lang().postformat(i)},add:function(n,i){var r;return r="string"==typeof n?t.duration(+i,n):t.duration(n,i),y(this,r,1),this},subtract:function(n,i){var r;return r="string"==typeof n?t.duration(+i,n):t.duration(n,i),y(this,r,-1),this},diff:function(n,i,r){var u,o,e=this._isUTC?t(n).zone(this._offset||0):t(n).local(),s=6e4*(this.zone()-e.zone());return i=l(i),"year"===i||"month"===i?(u=432e5*(this.daysInMonth()+e.daysInMonth()),o=12*(this.year()-e.year())+(this.month()-e.month()),o+=(this-t(this).startOf("month")-(e-t(e).startOf("month")))/u,o-=6e4*(this.zone()-t(this).startOf("month").zone()-(e.zone()-t(e).startOf("month").zone()))/u,"year"===i&&(o/=12)):(u=this-e,o="second"===i?u/1e3:"minute"===i?u/6e4:"hour"===i?u/36e5:"day"===i?(u-s)/864e5:"week"===i?(u-s)/6048e5:u),r?o:f(o)},from:function(n,i){return t.duration(this.diff(n)).lang(this.lang()._abbr).humanize(!i)},fromNow:function(n){return this.from(t(),n)},calendar:function(){var n=this.diff(t().startOf("day"),"days",!0),i=-6>n?"sameElse":-1>n?"lastWeek":0>n?"lastDay":1>n?"sameDay":2>n?"nextDay":7>n?"nextWeek":"sameElse";return this.format(this.lang().calendar(i,this))},isLeapYear:function(){var n=this.year();return 0==n%4&&0!=n%100||0==n%400},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(n){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=n?"string"==typeof n&&(n=this.lang().weekdaysParse(n),"number"!=typeof n)?this:this.add({d:n-t}):t},month:function(n){var i,r=this._isUTC?"UTC":"";return null!=n?"string"==typeof n&&(n=this.lang().monthsParse(n),"number"!=typeof n)?this:(i=this.date(),this.date(1),this._d["set"+r+"Month"](n),this.date(Math.min(i,this.daysInMonth())),t.updateOffset(this),this):this._d["get"+r+"Month"]()},startOf:function(n){switch(n=l(n)){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===n&&this.weekday(0),this},endOf:function(n){return this.startOf(n).add(n,1).subtract("ms",1)},isAfter:function(n,i){return i="undefined"!=typeof i?i:"millisecond",+this.clone().startOf(i)>+t(n).startOf(i)},isBefore:function(n,i){return i="undefined"!=typeof i?i:"millisecond",+this.clone().startOf(i)<+t(n).startOf(i)},isSame:function(n,i){return i="undefined"!=typeof i?i:"millisecond",+this.clone().startOf(i)==+t(n).startOf(i)},min:function(n){return n=t.apply(null,arguments),this>n?this:n},max:function(n){return n=t.apply(null,arguments),n>this?this:n},zone:function(n){var i=this._offset||0;return null==n?this._isUTC?i:this._d.getTimezoneOffset():("string"==typeof n&&(n=ut(n)),Math.abs(n)<16&&(n=60*n),this._offset=n,this._isUTC=!0,i!==n&&y(this,t.duration(i-n,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return t.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(n){var i=o((t(this).startOf("day")-t(this).startOf("year"))/864e5)+1;return null==n?i:this.add("d",n-i)},weekYear:function(n){var t=a(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==n?t:this.add("y",n-t)},isoWeekYear:function(n){var t=a(this,1,4).year;return null==n?t:this.add("y",n-t)},week:function(n){var t=this.lang().week(this);return null==n?t:this.add("d",7*(n-t))},isoWeek:function(n){var t=a(this,1,4).week;return null==n?t:this.add("d",7*(n-t))},weekday:function(n){var t=(this._d.getDay()+7-this.lang()._week.dow)%7;return null==n?t:this.add("d",n-t)},isoWeekday:function(n){return null==n?this.day()||7:this.day(this.day()%7?n:n-7)},lang:function(t){return t===n?this._lang:(this._lang=e(t),this)}},i=0;i<b.length;i++)ot(b[i].toLowerCase().replace(/s$/,""),b[i]);ot("year","FullYear"),t.fn.days=t.fn.day,t.fn.months=t.fn.month,t.fn.weeks=t.fn.week,t.fn.isoWeeks=t.fn.isoWeek,t.fn.toJSON=t.fn.toISOString,t.duration.fn=v.prototype={_bubble:function(){var t,i,r,o,s=this._milliseconds,u=this._days,e=this._months,n=this._data;n.milliseconds=s%1e3,t=f(s/1e3),n.seconds=t%60,i=f(t/60),n.minutes=i%60,r=f(i/60),n.hours=r%24,u+=f(r/24),n.days=u%30,e+=f(u/30),n.months=e%12,o=f(e/12),n.years=o},weeks:function(){return f(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*~~(this._months/12)},humanize:function(n){var i=+this,t=ui(i,!n,this.lang());return n&&(t=this.lang().pastFuture(i,t)),this.lang().postformat(t)},add:function(n,i){var r=t.duration(n,i);return this._milliseconds+=r._milliseconds,this._days+=r._days,this._months+=r._months,this._bubble(),this},subtract:function(n,i){var r=t.duration(n,i);return this._milliseconds-=r._milliseconds,this._days-=r._days,this._months-=r._months,this._bubble(),this},get:function(n){return n=l(n),this[n.toLowerCase()+"s"]()},as:function(n){return n=l(n),this["as"+n.charAt(0).toUpperCase()+n.slice(1)+"s"]()},lang:t.fn.lang};for(i in k)k.hasOwnProperty(i)&&(st(i,k[i]),fi(i.toLowerCase()));st("Weeks",6048e5),t.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},t.lang("en",{ordinal:function(n){var t=n%10,i=1==~~(n%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return n+i}}),ht&&(module.exports=t),"undefined"==typeof ender&&(this.moment=t),"function"==typeof define&&define.amd&&define("moment",[],function(){return t})}.call(this),!function(){var v=this,lt=v._,e={},r=Array.prototype,nt=Object.prototype,at=Function.prototype,y=r.push,t=r.slice,o=r.concat,f=nt.toString,vt=nt.hasOwnProperty,tt=r.forEach,it=r.map,rt=r.reduce,ut=r.reduceRight,ft=r.filter,et=r.every,ot=r.some,s=r.indexOf,st=r.lastIndexOf,yt=Array.isArray,pt=Object.keys,p=at.bind,n=function(t){return t instanceof n?t:this instanceof n?(this._wrapped=t,void 0):new n(t)},i,w,b,h,k,d,c,l,u,ht,ct,a;"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=n),exports._=n):v._=n,n.VERSION="1.5.1",i=n.each=n.forEach=function(t,i,r){var u,o,f;if(null!=t)if(tt&&t.forEach===tt)t.forEach(i,r);else if(t.length===+t.length){for(u=0,o=t.length;o>u;u++)if(i.call(r,t[u],u,t)===e)return}else for(f in t)if(n.has(t,f)&&i.call(r,t[f],f,t)===e)return},n.map=n.collect=function(n,t,r){var u=[];return null==n?u:it&&n.map===it?n.map(t,r):(i(n,function(n,i,f){u.push(t.call(r,n,i,f))}),u)},w="Reduce of empty array with no initial value",n.reduce=n.foldl=n.inject=function(t,r,u,f){var e=arguments.length>2;if(null==t&&(t=[]),rt&&t.reduce===rt)return f&&(r=n.bind(r,f)),e?t.reduce(r,u):t.reduce(r);if(i(t,function(n,t,i){e?u=r.call(f,u,n,t,i):(u=n,e=!0)}),!e)throw new TypeError(w);return u},n.reduceRight=n.foldr=function(t,r,u,f){var o=arguments.length>2,e,s;if(null==t&&(t=[]),ut&&t.reduceRight===ut)return f&&(r=n.bind(r,f)),o?t.reduceRight(r,u):t.reduceRight(r);if(e=t.length,e!==+e&&(s=n.keys(t),e=s.length),i(t,function(n,i,h){i=s?s[--e]:--e,o?u=r.call(f,u,t[i],i,h):(u=t[i],o=!0)}),!o)throw new TypeError(w);return u},n.find=n.detect=function(n,t,i){var r;return b(n,function(n,u,f){if(t.call(i,n,u,f))return r=n,!0}),r},n.filter=n.select=function(n,t,r){var u=[];return null==n?u:ft&&n.filter===ft?n.filter(t,r):(i(n,function(n,i,f){t.call(r,n,i,f)&&u.push(n)}),u)},n.reject=function(t,i,r){return n.filter(t,function(n,t,u){return!i.call(r,n,t,u)},r)},n.every=n.all=function(t,r,u){r||(r=n.identity);var f=!0;return null==t?f:et&&t.every===et?t.every(r,u):(i(t,function(n,t,i){if(!(f=f&&r.call(u,n,t,i)))return e}),!!f)},b=n.some=n.any=function(t,r,u){r||(r=n.identity);var f=!1;return null==t?f:ot&&t.some===ot?t.some(r,u):(i(t,function(n,t,i){if(f||(f=r.call(u,n,t,i)))return e}),!!f)},n.contains=n.include=function(n,t){return null==n?!1:s&&n.indexOf===s?n.indexOf(t)!=-1:b(n,function(n){return n===t})},n.invoke=function(i,r){var u=t.call(arguments,2),f=n.isFunction(r);return n.map(i,function(n){return(f?r:n[r]).apply(n,u)})},n.pluck=function(t,i){return n.map(t,function(n){return n[i]})},n.where=function(t,i,r){return n.isEmpty(i)?r?void 0:[]:n[r?"find":"filter"](t,function(n){for(var t in i)if(i[t]!==n[t])return!1;return!0})},n.findWhere=function(t,i){return n.where(t,i,!0)},n.max=function(t,r,u){if(!r&&n.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!r&&n.isEmpty(t))return-1/0;var f={computed:-1/0,value:-1/0};return i(t,function(n,t,i){var e=r?r.call(u,n,t,i):n;e>f.computed&&(f={value:n,computed:e})}),f.value},n.min=function(t,r,u){if(!r&&n.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!r&&n.isEmpty(t))return 1/0;var f={computed:1/0,value:1/0};return i(t,function(n,t,i){var e=r?r.call(u,n,t,i):n;e<f.computed&&(f={value:n,computed:e})}),f.value},n.shuffle=function(t){var u,f=0,r=[];return i(t,function(t){u=n.random(f++),r[f-1]=r[u],r[u]=t}),r},h=function(t){return n.isFunction(t)?t:function(n){return n[t]}},n.sortBy=function(t,i,r){var u=h(i);return n.pluck(n.map(t,function(n,t,i){return{value:n,index:t,criteria:u.call(r,n,t,i)}}).sort(function(n,t){var i=n.criteria,r=t.criteria;if(i!==r){if(i>r||i===void 0)return 1;if(r>i||r===void 0)return-1}return n.index<t.index?-1:1}),"value")},k=function(t,r,u,f){var e={},o=h(null==r?n.identity:r);return i(t,function(n,i){var r=o.call(u,n,i,t);f(e,r,n)}),e},n.groupBy=function(t,i,r){return k(t,i,r,function(t,i,r){(n.has(t,i)?t[i]:t[i]=[]).push(r)})},n.countBy=function(t,i,r){return k(t,i,r,function(t,i){n.has(t,i)||(t[i]=0),t[i]++})},n.sortedIndex=function(t,i,r,u){var e;r=null==r?n.identity:h(r);for(var s=r.call(u,i),f=0,o=t.length;o>f;)e=f+o>>>1,r.call(u,t[e])<s?f=e+1:o=e;return f},n.toArray=function(i){return i?n.isArray(i)?t.call(i):i.length===+i.length?n.map(i,n.identity):n.values(i):[]},n.size=function(t){return null==t?0:t.length===+t.length?t.length:n.keys(t).length},n.first=n.head=n.take=function(n,i,r){if(null!=n)return null==i||r?n[0]:t.call(n,0,i)},n.initial=function(n,i,r){return t.call(n,0,n.length-(null==i||r?1:i))},n.last=function(n,i,r){if(null!=n)return null==i||r?n[n.length-1]:t.call(n,Math.max(n.length-i,0))},n.rest=n.tail=n.drop=function(n,i,r){return t.call(n,null==i||r?1:i)},n.compact=function(t){return n.filter(t,n.identity)},d=function(t,r,u){return r&&n.every(t,n.isArray)?o.apply(u,t):(i(t,function(t){n.isArray(t)||n.isArguments(t)?r?y.apply(u,t):d(t,r,u):u.push(t)}),u)},n.flatten=function(n,t){return d(n,t,[])},n.without=function(i){return n.difference(i,t.call(arguments,1))},n.uniq=n.unique=function(t,r,u,f){n.isFunction(r)&&(f=u,u=r,r=!1);var s=u?n.map(t,u,f):t,o=[],e=[];return i(s,function(i,u){(r?u&&e[e.length-1]===i:n.contains(e,i))||(e.push(i),o.push(t[u]))}),o},n.union=function(){return n.uniq(n.flatten(arguments,!0))},n.intersection=function(i){var r=t.call(arguments,1);return n.filter(n.uniq(i),function(t){return n.every(r,function(i){return n.indexOf(i,t)>=0})})},n.difference=function(i){var u=o.apply(r,t.call(arguments,1));return n.filter(i,function(t){return!n.contains(u,t)})},n.zip=function(){for(var i=n.max(n.pluck(arguments,"length").concat(0)),r=new Array(i),t=0;i>t;t++)r[t]=n.pluck(arguments,""+t);return r},n.object=function(n,t){if(null==n)return{};for(var r={},i=0,u=n.length;u>i;i++)t?r[n[i]]=t[i]:r[n[i][0]]=n[i][1];return r},n.indexOf=function(t,i,r){if(null==t)return-1;var u=0,f=t.length;if(r){if("number"!=typeof r)return u=n.sortedIndex(t,i),t[u]===i?u:-1;u=0>r?Math.max(0,f+r):r}if(s&&t.indexOf===s)return t.indexOf(i,r);for(;f>u;u++)if(t[u]===i)return u;return-1},n.lastIndexOf=function(n,t,i){var u,r;if(null==n)return-1;if(u=null!=i,st&&n.lastIndexOf===st)return u?n.lastIndexOf(t,i):n.lastIndexOf(t);for(r=u?i:n.length;r--;)if(n[r]===t)return r;return-1},n.range=function(n,t,i){arguments.length<=1&&(t=n||0,n=0),i=arguments[2]||1;for(var r=Math.max(Math.ceil((t-n)/i),0),u=0,f=new Array(r);r>u;)f[u++]=n,n+=i;return f},c=function(){},n.bind=function(i,r){var u,f;if(p&&i.bind===p)return p.apply(i,t.call(arguments,1));if(!n.isFunction(i))throw new TypeError;return u=t.call(arguments,2),f=function(){var e,n;return this instanceof f?(c.prototype=i.prototype,e=new c,c.prototype=null,n=i.apply(e,u.concat(t.call(arguments))),Object(n)===n?n:e):i.apply(r,u.concat(t.call(arguments)))}},n.partial=function(n){var i=t.call(arguments,1);return function(){return n.apply(this,i.concat(t.call(arguments)))}},n.bindAll=function(r){var u=t.call(arguments,1);if(0===u.length)throw new Error("bindAll must be passed function names");return i(u,function(t){r[t]=n.bind(r[t],r)}),r},n.memoize=function(t,i){var r={};return i||(i=n.identity),function(){var u=i.apply(this,arguments);return n.has(r,u)?r[u]:r[u]=t.apply(this,arguments)}},n.delay=function(n,i){var r=t.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},i)},n.defer=function(i){return n.delay.apply(n,[i,1].concat(t.call(arguments,1)))},n.throttle=function(n,t,i){var f,e,o,r=null,u=0,s;return i||(i={}),s=function(){u=i.leading===!1?0:new Date,r=null,o=n.apply(f,e)},function(){var h=new Date,c;return u||i.leading!==!1||(u=h),c=t-(h-u),f=this,e=arguments,0>=c?(clearTimeout(r),r=null,u=h,o=n.apply(f,e)):r||i.trailing===!1||(r=setTimeout(s,c)),o}},n.debounce=function(n,t,i){var u,r=null;return function(){var f=this,e=arguments,o=function(){r=null,i||(u=n.apply(f,e))},s=i&&!r;return clearTimeout(r),r=setTimeout(o,t),s&&(u=n.apply(f,e)),u}},n.once=function(n){var t,i=!1;return function(){return i?t:(i=!0,t=n.apply(this,arguments),n=null,t)}},n.wrap=function(n,t){return function(){var i=[n];return y.apply(i,arguments),t.apply(this,i)}},n.compose=function(){var n=arguments;return function(){for(var t=arguments,i=n.length-1;i>=0;i--)t=[n[i].apply(this,t)];return t[0]}},n.after=function(n,t){return function(){if(--n<1)return t.apply(this,arguments)}},n.keys=pt||function(t){var i,r;if(t!==Object(t))throw new TypeError("Invalid object");i=[];for(r in t)n.has(t,r)&&i.push(r);return i},n.values=function(t){var r=[],i;for(i in t)n.has(t,i)&&r.push(t[i]);return r},n.pairs=function(t){var r=[],i;for(i in t)n.has(t,i)&&r.push([i,t[i]]);return r},n.invert=function(t){var r={},i;for(i in t)n.has(t,i)&&(r[t[i]]=i);return r},n.functions=n.methods=function(t){var r=[],i;for(i in t)n.isFunction(t[i])&&r.push(i);return r.sort()},n.extend=function(n){return i(t.call(arguments,1),function(t){if(t)for(var i in t)n[i]=t[i]}),n},n.pick=function(n){var u={},f=o.apply(r,t.call(arguments,1));return i(f,function(t){t in n&&(u[t]=n[t])}),u},n.omit=function(i){var f={},e=o.apply(r,t.call(arguments,1)),u;for(u in i)n.contains(e,u)||(f[u]=i[u]);return f},n.defaults=function(n){return i(t.call(arguments,1),function(t){if(t)for(var i in t)n[i]===void 0&&(n[i]=t[i])}),n},n.clone=function(t){return n.isObject(t)?n.isArray(t)?t.slice():n.extend({},t):t},n.tap=function(n,t){return t(n),n},l=function(t,i,r,u){var a,v,h,c,e,o,s;if(t===i)return 0!==t||1/t==1/i;if(null==t||null==i)return t===i;if(t instanceof n&&(t=t._wrapped),i instanceof n&&(i=i._wrapped),a=f.call(t),a!=f.call(i))return!1;switch(a){case"[object String]":return t==String(i);case"[object Number]":return t!=+t?i!=+i:0==t?1/t==1/i:t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object RegExp]":return t.source==i.source&&t.global==i.global&&t.multiline==i.multiline&&t.ignoreCase==i.ignoreCase}if("object"!=typeof t||"object"!=typeof i)return!1;for(v=r.length;v--;)if(r[v]==t)return u[v]==i;if(h=t.constructor,c=i.constructor,h!==c&&!(n.isFunction(h)&&h instanceof h&&n.isFunction(c)&&c instanceof c))return!1;if(r.push(t),u.push(i),e=0,o=!0,"[object Array]"==a){if(e=t.length,o=e==i.length)for(;e--&&(o=l(t[e],i[e],r,u)););}else{for(s in t)if(n.has(t,s)&&(e++,!(o=n.has(i,s)&&l(t[s],i[s],r,u))))break;if(o){for(s in i)if(n.has(i,s)&&!e--)break;o=!e}}return r.pop(),u.pop(),o},n.isEqual=function(n,t){return l(n,t,[],[])},n.isEmpty=function(t){if(null==t)return!0;if(n.isArray(t)||n.isString(t))return 0===t.length;for(var i in t)if(n.has(t,i))return!1;return!0},n.isElement=function(n){return!(!n||1!==n.nodeType)},n.isArray=yt||function(n){return"[object Array]"==f.call(n)},n.isObject=function(n){return n===Object(n)},i(["Arguments","Function","String","Number","Date","RegExp"],function(t){n["is"+t]=function(n){return f.call(n)=="[object "+t+"]"}}),n.isArguments(arguments)||(n.isArguments=function(t){return!(!t||!n.has(t,"callee"))}),"function"!=typeof/./&&(n.isFunction=function(n){return"function"==typeof n}),n.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},n.isNaN=function(t){return n.isNumber(t)&&t!=+t},n.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==f.call(n)},n.isNull=function(n){return null===n},n.isUndefined=function(n){return n===void 0},n.has=function(n,t){return vt.call(n,t)},n.noConflict=function(){return v._=lt,this},n.identity=function(n){return n},n.times=function(n,t,i){for(var u=Array(Math.max(0,n)),r=0;n>r;r++)u[r]=t.call(i,r);return u},n.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},u={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}},u.unescape=n.invert(u.escape),ht={escape:new RegExp("["+n.keys(u.escape).join("")+"]","g"),unescape:new RegExp("("+n.keys(u.unescape).join("|")+")","g")},n.each(["escape","unescape"],function(t){n[t]=function(n){return null==n?"":(""+n).replace(ht[t],function(n){return u[t][n]})}}),n.result=function(t,i){if(null==t)return void 0;var r=t[i];return n.isFunction(r)?r.call(t):r},n.mixin=function(t){i(n.functions(t),function(i){var r=n[i]=t[i];n.prototype[i]=function(){var t=[this._wrapped];return y.apply(t,arguments),a.call(this,r.apply(n,t))}})},ct=0,n.uniqueId=function(n){var t=++ct+"";return n?n+t:t},n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var g=/(.)^/,wt={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},bt=/\\|'|\r|\n|\t|\u2028|\u2029/g;n.template=function(t,i,r){var f,e;r=n.defaults({},r,n.templateSettings);var s=new RegExp([(r.escape||g).source,(r.interpolate||g).source,(r.evaluate||g).source].join("|")+"|$","g"),o=0,u="__p+='";t.replace(s,function(n,i,r,f,e){return u+=t.slice(o,e).replace(bt,function(n){return"\\"+wt[n]}),i&&(u+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),r&&(u+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),f&&(u+="';\n"+f+"\n__p+='"),o=e+n.length,n}),u+="';\n",r.variable||(u="with(obj||{}){\n"+u+"}\n"),u="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+u+"return __p;\n";try{f=new Function(r.variable||"obj","_",u)}catch(h){throw h.source=u,h;}return i?f(i,n):(e=function(t){return f.call(this,t,n)},e.source="function("+(r.variable||"obj")+"){\n"+u+"}",e)},n.chain=function(t){return n(t).chain()},a=function(t){return this._chain?n(t).chain():t},n.mixin(n),i(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=r[t];n.prototype[t]=function(){var n=this._wrapped;return i.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],a.call(this,n)}}),i(["concat","join","slice"],function(t){var i=r[t];n.prototype[t]=function(){return a.call(this,i.apply(this._wrapped,arguments))}}),n.extend(n.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this)